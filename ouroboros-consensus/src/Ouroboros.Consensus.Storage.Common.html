<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DeriveAnyClass             #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DeriveFunctor              #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE DeriveGeneric              #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE DerivingStrategies         #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE GADTs                      #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE GeneralizedNewtypeDeriving #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase                 #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE NamedFieldPuns             #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies               #-}</span><span>
</span><span id="line-10"></span><span>
</span><span id="line-11"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Ouroboros.Consensus.Storage.Common</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-12"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Indexing</span></span><span>
</span><span id="line-13"></span><span>    </span><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#tipIsGenesis"><span class="hs-identifier">tipIsGenesis</span></a></span><span>
</span><span id="line-14"></span><span>    </span><span class="annot"><span class="hs-comment">-- * PrefixLen</span></span><span>
</span><span id="line-15"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#PrefixLen"><span class="hs-identifier">PrefixLen</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#addPrefixLen"><span class="hs-identifier">addPrefixLen</span></a></span><span>
</span><span id="line-17"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#takePrefix"><span class="hs-identifier">takePrefix</span></a></span><span>
</span><span id="line-18"></span><span>    </span><span class="annot"><span class="hs-comment">-- * BinaryBlockInfo</span></span><span>
</span><span id="line-19"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#BinaryBlockInfo"><span class="hs-identifier">BinaryBlockInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#extractHeader"><span class="hs-identifier">extractHeader</span></a></span><span>
</span><span id="line-21"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Iterator bounds</span></span><span>
</span><span id="line-22"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#StreamFrom"><span class="hs-identifier">StreamFrom</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#StreamTo"><span class="hs-identifier">StreamTo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#validBounds"><span class="hs-identifier">validBounds</span></a></span><span>
</span><span id="line-25"></span><span>    </span><span class="annot"><span class="hs-comment">-- * BlockComponent</span></span><span>
</span><span id="line-26"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#BlockComponent"><span class="hs-identifier">BlockComponent</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Re-exports</span></span><span>
</span><span id="line-28"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.7/ouroboros-network-api-0.1.0.0/noopt/doc/html/ouroboros-network-api/src"><span class="hs-identifier">SizeInBytes</span></a></span><span>
</span><span id="line-29"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/bytestring-0.10.12.0/src"><span class="hs-identifier">Data.ByteString.Lazy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/bytestring-0.10.12.0/src"><span class="hs-identifier">ByteString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/bytestring-0.10.12.0/src"><span class="hs-identifier">Data.ByteString.Lazy</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BL</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/bytestring-0.10.12.0/src"><span class="hs-identifier">Data.ByteString.Short</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/bytestring-0.10.12.0/src"><span class="hs-identifier">ShortByteString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/bytestring-0.10.12.0/src"><span class="hs-identifier">Data.ByteString.Short</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Short</span></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Word</span></a></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">GHC.Generics</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">NoThunks.Class</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NoThunks</span></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.7/ouroboros-network-api-0.1.0.0/noopt/doc/html/ouroboros-network-api/src"><span class="hs-identifier">Ouroboros.Network.SizeInBytes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.7/ouroboros-network-api-0.1.0.0/noopt/doc/html/ouroboros-network-api/src"><span class="hs-identifier">SizeInBytes</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.Block.html"><span class="hs-identifier">Ouroboros.Consensus.Block</span></a></span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Indexing
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span id="local-6989586621680016438"><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#tipIsGenesis"><span class="hs-identifier hs-type">tipIsGenesis</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WithOrigin</span></span><span> </span><span class="annot"><a href="#local-6989586621680016438"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span></span><span>
</span><span id="line-48"></span><span id="tipIsGenesis"><span class="annot"><span class="annottext">tipIsGenesis :: WithOrigin r -&gt; Bool
</span><a href="Ouroboros.Consensus.Storage.Common.html#tipIsGenesis"><span class="hs-identifier hs-var hs-var">tipIsGenesis</span></a></span></span><span> </span><span class="annot"><span class="annottext">WithOrigin r
</span><span class="hs-identifier hs-var">Origin</span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-49"></span><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#tipIsGenesis"><span class="hs-identifier hs-var">tipIsGenesis</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Block.Abstract.html#NotOrigin"><span class="hs-identifier hs-type">NotOrigin</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  PrefixLen
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="hs-comment">-- | Number of bytes from the start of a block needed to reconstruct the</span><span>
</span><span id="line-56"></span><span class="hs-comment">-- nested context.</span><span>
</span><span id="line-57"></span><span class="hs-comment">--</span><span>
</span><span id="line-58"></span><span class="hs-comment">-- See 'reconstructPrefixLen'.</span><span>
</span><span id="line-59"></span><span id="local-6989586621680016434"><span id="local-6989586621680016435"></span></span><span class="hs-keyword">newtype</span><span> </span><span id="PrefixLen"><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#PrefixLen"><span class="hs-identifier hs-var">PrefixLen</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PrefixLen"><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#PrefixLen"><span class="hs-identifier hs-var">PrefixLen</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-60"></span><span>      </span><span id="getPrefixLen"><span class="annot"><span class="annottext">PrefixLen -&gt; Word8
</span><a href="Ouroboros.Consensus.Storage.Common.html#getPrefixLen"><span class="hs-identifier hs-var hs-var">getPrefixLen</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Word8</span></a></span><span>
</span><span id="line-61"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-62"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span>   </span><span class="hs-special">(</span><span id="local-6989586621680016428"><span id="local-6989586621680016430"><span class="annot"><span class="annottext">PrefixLen -&gt; PrefixLen -&gt; Bool
(PrefixLen -&gt; PrefixLen -&gt; Bool)
-&gt; (PrefixLen -&gt; PrefixLen -&gt; Bool) -&gt; Eq PrefixLen
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: PrefixLen -&gt; PrefixLen -&gt; Bool
$c/= :: PrefixLen -&gt; PrefixLen -&gt; Bool
== :: PrefixLen -&gt; PrefixLen -&gt; Bool
$c== :: PrefixLen -&gt; PrefixLen -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680016412"><span id="local-6989586621680016414"><span id="local-6989586621680016416"><span id="local-6989586621680016418"><span id="local-6989586621680016420"><span id="local-6989586621680016422"><span id="local-6989586621680016424"><span class="annot"><span class="annottext">Eq PrefixLen
Eq PrefixLen
-&gt; (PrefixLen -&gt; PrefixLen -&gt; Ordering)
-&gt; (PrefixLen -&gt; PrefixLen -&gt; Bool)
-&gt; (PrefixLen -&gt; PrefixLen -&gt; Bool)
-&gt; (PrefixLen -&gt; PrefixLen -&gt; Bool)
-&gt; (PrefixLen -&gt; PrefixLen -&gt; Bool)
-&gt; (PrefixLen -&gt; PrefixLen -&gt; PrefixLen)
-&gt; (PrefixLen -&gt; PrefixLen -&gt; PrefixLen)
-&gt; Ord PrefixLen
PrefixLen -&gt; PrefixLen -&gt; Bool
PrefixLen -&gt; PrefixLen -&gt; Ordering
PrefixLen -&gt; PrefixLen -&gt; PrefixLen
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: PrefixLen -&gt; PrefixLen -&gt; PrefixLen
$cmin :: PrefixLen -&gt; PrefixLen -&gt; PrefixLen
max :: PrefixLen -&gt; PrefixLen -&gt; PrefixLen
$cmax :: PrefixLen -&gt; PrefixLen -&gt; PrefixLen
&gt;= :: PrefixLen -&gt; PrefixLen -&gt; Bool
$c&gt;= :: PrefixLen -&gt; PrefixLen -&gt; Bool
&gt; :: PrefixLen -&gt; PrefixLen -&gt; Bool
$c&gt; :: PrefixLen -&gt; PrefixLen -&gt; Bool
&lt;= :: PrefixLen -&gt; PrefixLen -&gt; Bool
$c&lt;= :: PrefixLen -&gt; PrefixLen -&gt; Bool
&lt; :: PrefixLen -&gt; PrefixLen -&gt; Bool
$c&lt; :: PrefixLen -&gt; PrefixLen -&gt; Bool
compare :: PrefixLen -&gt; PrefixLen -&gt; Ordering
$ccompare :: PrefixLen -&gt; PrefixLen -&gt; Ordering
$cp1Ord :: Eq PrefixLen
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680016405"><span id="local-6989586621680016407"><span id="local-6989586621680016409"><span class="annot"><span class="annottext">Int -&gt; PrefixLen -&gt; ShowS
[PrefixLen] -&gt; ShowS
PrefixLen -&gt; String
(Int -&gt; PrefixLen -&gt; ShowS)
-&gt; (PrefixLen -&gt; String)
-&gt; ([PrefixLen] -&gt; ShowS)
-&gt; Show PrefixLen
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [PrefixLen] -&gt; ShowS
$cshowList :: [PrefixLen] -&gt; ShowS
show :: PrefixLen -&gt; String
$cshow :: PrefixLen -&gt; String
showsPrec :: Int -&gt; PrefixLen -&gt; ShowS
$cshowsPrec :: Int -&gt; PrefixLen -&gt; ShowS
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. PrefixLen -&gt; Rep PrefixLen x)
-&gt; (forall x. Rep PrefixLen x -&gt; PrefixLen) -&gt; Generic PrefixLen
forall x. Rep PrefixLen x -&gt; PrefixLen
forall x. PrefixLen -&gt; Rep PrefixLen x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep PrefixLen x -&gt; PrefixLen
$cfrom :: forall x. PrefixLen -&gt; Rep PrefixLen x
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">newtype</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680016395"><span id="local-6989586621680016397"><span id="local-6989586621680016399"><span class="annot"><span class="annottext">Context -&gt; PrefixLen -&gt; IO (Maybe ThunkInfo)
Proxy PrefixLen -&gt; String
(Context -&gt; PrefixLen -&gt; IO (Maybe ThunkInfo))
-&gt; (Context -&gt; PrefixLen -&gt; IO (Maybe ThunkInfo))
-&gt; (Proxy PrefixLen -&gt; String)
-&gt; NoThunks PrefixLen
forall a.
(Context -&gt; a -&gt; IO (Maybe ThunkInfo))
-&gt; (Context -&gt; a -&gt; IO (Maybe ThunkInfo))
-&gt; (Proxy a -&gt; String)
-&gt; NoThunks a
showTypeOf :: Proxy PrefixLen -&gt; String
$cshowTypeOf :: Proxy PrefixLen -&gt; String
wNoThunks :: Context -&gt; PrefixLen -&gt; IO (Maybe ThunkInfo)
$cwNoThunks :: Context -&gt; PrefixLen -&gt; IO (Maybe ThunkInfo)
noThunks :: Context -&gt; PrefixLen -&gt; IO (Maybe ThunkInfo)
$cnoThunks :: Context -&gt; PrefixLen -&gt; IO (Maybe ThunkInfo)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">NoThunks</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#addPrefixLen"><span class="hs-identifier hs-type">addPrefixLen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Word8</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#PrefixLen"><span class="hs-identifier hs-type">PrefixLen</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#PrefixLen"><span class="hs-identifier hs-type">PrefixLen</span></a></span><span>
</span><span id="line-66"></span><span id="addPrefixLen"><span class="annot"><span class="annottext">addPrefixLen :: Word8 -&gt; PrefixLen -&gt; PrefixLen
</span><a href="Ouroboros.Consensus.Storage.Common.html#addPrefixLen"><span class="hs-identifier hs-var hs-var">addPrefixLen</span></a></span></span><span> </span><span id="local-6989586621680016393"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621680016393"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#PrefixLen"><span class="hs-identifier hs-type">PrefixLen</span></a></span><span> </span><span id="local-6989586621680016392"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621680016392"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; PrefixLen
</span><a href="Ouroboros.Consensus.Storage.Common.html#PrefixLen"><span class="hs-identifier hs-var">PrefixLen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621680016393"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621680016392"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#takePrefix"><span class="hs-identifier hs-type">takePrefix</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#PrefixLen"><span class="hs-identifier hs-type">PrefixLen</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/bytestring-0.10.12.0/src"><span class="hs-identifier hs-type">BL.ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/bytestring-0.10.12.0/src"><span class="hs-identifier hs-type">ShortByteString</span></a></span><span>
</span><span id="line-69"></span><span id="takePrefix"><span class="annot"><span class="annottext">takePrefix :: PrefixLen -&gt; ByteString -&gt; ShortByteString
</span><a href="Ouroboros.Consensus.Storage.Common.html#takePrefix"><span class="hs-identifier hs-var hs-var">takePrefix</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#PrefixLen"><span class="hs-identifier hs-type">PrefixLen</span></a></span><span> </span><span id="local-6989586621680016390"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621680016390"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-70"></span><span>    </span><span class="annot"><span class="annottext">ByteString -&gt; ShortByteString
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/bytestring-0.10.12.0/src"><span class="hs-identifier hs-var">Short.toShort</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ShortByteString)
-&gt; (ByteString -&gt; ByteString) -&gt; ByteString -&gt; ShortByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/bytestring-0.10.12.0/src"><span class="hs-identifier hs-var">BL.toStrict</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString)
-&gt; (ByteString -&gt; ByteString) -&gt; ByteString -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; ByteString -&gt; ByteString
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/bytestring-0.10.12.0/src"><span class="hs-identifier hs-var">BL.take</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8 -&gt; Int64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621680016390"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  BinaryBlockInfo
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="hs-comment">-- | Information about the serialised block.</span><span>
</span><span id="line-77"></span><span id="local-6989586621680016384"><span id="local-6989586621680016385"></span></span><span class="hs-keyword">data</span><span> </span><span id="BinaryBlockInfo"><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#BinaryBlockInfo"><span class="hs-identifier hs-var">BinaryBlockInfo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="BinaryBlockInfo"><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#BinaryBlockInfo"><span class="hs-identifier hs-var">BinaryBlockInfo</span></a></span></span><span>
</span><span id="line-78"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="headerOffset"><span class="annot"><span class="annottext">BinaryBlockInfo -&gt; Word16
</span><a href="Ouroboros.Consensus.Storage.Common.html#headerOffset"><span class="hs-identifier hs-var hs-var">headerOffset</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Word16</span></a></span><span>
</span><span id="line-79"></span><span>    </span><span class="hs-comment">-- ^ The offset within the serialised block at which the header starts.</span><span>
</span><span id="line-80"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="headerSize"><span class="annot"><span class="annottext">BinaryBlockInfo -&gt; Word16
</span><a href="Ouroboros.Consensus.Storage.Common.html#headerSize"><span class="hs-identifier hs-var hs-var">headerSize</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Word16</span></a></span><span>
</span><span id="line-81"></span><span>    </span><span class="hs-comment">-- ^ How many bytes the header is long. Extracting the 'headerSize' bytes</span><span>
</span><span id="line-82"></span><span>    </span><span class="hs-comment">-- from serialised block starting from 'headerOffset' should yield the</span><span>
</span><span id="line-83"></span><span>    </span><span class="hs-comment">-- header. Before passing the extracted bytes to the decoder for headers,</span><span>
</span><span id="line-84"></span><span>    </span><span class="hs-comment">-- an envelope can be around using 'nodeAddHeaderEnvelope'.</span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span>    </span><span class="hs-comment">-- In the future, i.e. Shelley, we might want to extend this to include a</span><span>
</span><span id="line-87"></span><span>    </span><span class="hs-comment">-- field to tell where the transaction body ends and where the transaction</span><span>
</span><span id="line-88"></span><span>    </span><span class="hs-comment">-- witnesses begin so we can only extract the transaction body.</span><span>
</span><span id="line-89"></span><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680016377"><span id="local-6989586621680016379"><span class="annot"><span class="annottext">BinaryBlockInfo -&gt; BinaryBlockInfo -&gt; Bool
(BinaryBlockInfo -&gt; BinaryBlockInfo -&gt; Bool)
-&gt; (BinaryBlockInfo -&gt; BinaryBlockInfo -&gt; Bool)
-&gt; Eq BinaryBlockInfo
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: BinaryBlockInfo -&gt; BinaryBlockInfo -&gt; Bool
$c/= :: BinaryBlockInfo -&gt; BinaryBlockInfo -&gt; Bool
== :: BinaryBlockInfo -&gt; BinaryBlockInfo -&gt; Bool
$c== :: BinaryBlockInfo -&gt; BinaryBlockInfo -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680016371"><span id="local-6989586621680016373"><span id="local-6989586621680016375"><span class="annot"><span class="annottext">Int -&gt; BinaryBlockInfo -&gt; ShowS
[BinaryBlockInfo] -&gt; ShowS
BinaryBlockInfo -&gt; String
(Int -&gt; BinaryBlockInfo -&gt; ShowS)
-&gt; (BinaryBlockInfo -&gt; String)
-&gt; ([BinaryBlockInfo] -&gt; ShowS)
-&gt; Show BinaryBlockInfo
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [BinaryBlockInfo] -&gt; ShowS
$cshowList :: [BinaryBlockInfo] -&gt; ShowS
show :: BinaryBlockInfo -&gt; String
$cshow :: BinaryBlockInfo -&gt; String
showsPrec :: Int -&gt; BinaryBlockInfo -&gt; ShowS
$cshowsPrec :: Int -&gt; BinaryBlockInfo -&gt; ShowS
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. BinaryBlockInfo -&gt; Rep BinaryBlockInfo x)
-&gt; (forall x. Rep BinaryBlockInfo x -&gt; BinaryBlockInfo)
-&gt; Generic BinaryBlockInfo
forall x. Rep BinaryBlockInfo x -&gt; BinaryBlockInfo
forall x. BinaryBlockInfo -&gt; Rep BinaryBlockInfo x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep BinaryBlockInfo x -&gt; BinaryBlockInfo
$cfrom :: forall x. BinaryBlockInfo -&gt; Rep BinaryBlockInfo x
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span class="hs-comment">-- | Extract the header from the given 'ByteString' using the</span><span>
</span><span id="line-93"></span><span class="hs-comment">-- 'BinaryBlockInfo'.</span><span>
</span><span id="line-94"></span><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#extractHeader"><span class="hs-identifier hs-type">extractHeader</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#BinaryBlockInfo"><span class="hs-identifier hs-type">BinaryBlockInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/bytestring-0.10.12.0/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/bytestring-0.10.12.0/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-95"></span><span id="extractHeader"><span class="annot"><span class="annottext">extractHeader :: BinaryBlockInfo -&gt; ByteString -&gt; ByteString
</span><a href="Ouroboros.Consensus.Storage.Common.html#extractHeader"><span class="hs-identifier hs-var hs-var">extractHeader</span></a></span></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#BinaryBlockInfo"><span class="hs-identifier hs-type">BinaryBlockInfo</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621680016368"><span class="annot"><span class="annottext">Word16
headerOffset :: Word16
headerOffset :: BinaryBlockInfo -&gt; Word16
</span><a href="#local-6989586621680016368"><span class="hs-identifier hs-var hs-var">headerOffset</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680016367"><span class="annot"><span class="annottext">Word16
headerSize :: Word16
headerSize :: BinaryBlockInfo -&gt; Word16
</span><a href="#local-6989586621680016367"><span class="hs-identifier hs-var hs-var">headerSize</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-96"></span><span>      </span><span class="annot"><span class="annottext">Int64 -&gt; ByteString -&gt; ByteString
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/bytestring-0.10.12.0/src"><span class="hs-identifier hs-var">BL.take</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word16 -&gt; Int64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621680016367"><span class="hs-identifier hs-var">headerSize</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span>    </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString)
-&gt; (ByteString -&gt; ByteString) -&gt; ByteString -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; ByteString -&gt; ByteString
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/bytestring-0.10.12.0/src"><span class="hs-identifier hs-var">BL.drop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word16 -&gt; Int64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621680016368"><span class="hs-identifier hs-var">headerOffset</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Iterator bounds
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span class="hs-comment">-- | The lower bound for an iterator</span><span>
</span><span id="line-104"></span><span class="hs-comment">--</span><span>
</span><span id="line-105"></span><span class="hs-comment">-- Hint: use @'StreamFromExclusive' 'genesisPoint'@ to start streaming from</span><span>
</span><span id="line-106"></span><span class="hs-comment">-- Genesis.</span><span>
</span><span id="line-107"></span><span id="local-6989586621680016364"><span id="local-6989586621680016365"></span></span><span class="hs-keyword">data</span><span> </span><span id="StreamFrom"><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#StreamFrom"><span class="hs-identifier hs-var">StreamFrom</span></a></span></span><span> </span><span id="local-6989586621680016363"><span class="annot"><a href="#local-6989586621680016363"><span class="hs-identifier hs-type">blk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-108"></span><span>    </span><span id="StreamFromInclusive"><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#StreamFromInclusive"><span class="hs-identifier hs-var">StreamFromInclusive</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Block.RealPoint.html#RealPoint"><span class="hs-identifier hs-type">RealPoint</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680016363"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="StreamFromExclusive"><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#StreamFromExclusive"><span class="hs-identifier hs-var">StreamFromExclusive</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.7/ouroboros-network-api-0.1.0.0/noopt/doc/html/ouroboros-network-api/src"><span class="hs-identifier hs-type">Point</span></a></span><span>     </span><span class="annot"><a href="#local-6989586621680016363"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621680016355"><span id="local-6989586621680016357"><span id="local-6989586621680016359"><span class="annot"><span class="annottext">Int -&gt; StreamFrom blk -&gt; ShowS
[StreamFrom blk] -&gt; ShowS
StreamFrom blk -&gt; String
(Int -&gt; StreamFrom blk -&gt; ShowS)
-&gt; (StreamFrom blk -&gt; String)
-&gt; ([StreamFrom blk] -&gt; ShowS)
-&gt; Show (StreamFrom blk)
forall blk. StandardHash blk =&gt; Int -&gt; StreamFrom blk -&gt; ShowS
forall blk. StandardHash blk =&gt; [StreamFrom blk] -&gt; ShowS
forall blk. StandardHash blk =&gt; StreamFrom blk -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [StreamFrom blk] -&gt; ShowS
$cshowList :: forall blk. StandardHash blk =&gt; [StreamFrom blk] -&gt; ShowS
show :: StreamFrom blk -&gt; String
$cshow :: forall blk. StandardHash blk =&gt; StreamFrom blk -&gt; String
showsPrec :: Int -&gt; StreamFrom blk -&gt; ShowS
$cshowsPrec :: forall blk. StandardHash blk =&gt; Int -&gt; StreamFrom blk -&gt; ShowS
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680016351"><span id="local-6989586621680016353"><span class="annot"><span class="annottext">StreamFrom blk -&gt; StreamFrom blk -&gt; Bool
(StreamFrom blk -&gt; StreamFrom blk -&gt; Bool)
-&gt; (StreamFrom blk -&gt; StreamFrom blk -&gt; Bool)
-&gt; Eq (StreamFrom blk)
forall blk.
StandardHash blk =&gt;
StreamFrom blk -&gt; StreamFrom blk -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: StreamFrom blk -&gt; StreamFrom blk -&gt; Bool
$c/= :: forall blk.
StandardHash blk =&gt;
StreamFrom blk -&gt; StreamFrom blk -&gt; Bool
== :: StreamFrom blk -&gt; StreamFrom blk -&gt; Bool
$c== :: forall blk.
StandardHash blk =&gt;
StreamFrom blk -&gt; StreamFrom blk -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. StreamFrom blk -&gt; Rep (StreamFrom blk) x)
-&gt; (forall x. Rep (StreamFrom blk) x -&gt; StreamFrom blk)
-&gt; Generic (StreamFrom blk)
forall x. Rep (StreamFrom blk) x -&gt; StreamFrom blk
forall x. StreamFrom blk -&gt; Rep (StreamFrom blk) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall blk x. Rep (StreamFrom blk) x -&gt; StreamFrom blk
forall blk x. StreamFrom blk -&gt; Rep (StreamFrom blk) x
$cto :: forall blk x. Rep (StreamFrom blk) x -&gt; StreamFrom blk
$cfrom :: forall blk x. StreamFrom blk -&gt; Rep (StreamFrom blk) x
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">anyclass</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680016343"><span id="local-6989586621680016345"><span id="local-6989586621680016347"><span class="annot"><span class="annottext">Context -&gt; StreamFrom blk -&gt; IO (Maybe ThunkInfo)
Proxy (StreamFrom blk) -&gt; String
(Context -&gt; StreamFrom blk -&gt; IO (Maybe ThunkInfo))
-&gt; (Context -&gt; StreamFrom blk -&gt; IO (Maybe ThunkInfo))
-&gt; (Proxy (StreamFrom blk) -&gt; String)
-&gt; NoThunks (StreamFrom blk)
forall blk.
(StandardHash blk, Typeable blk) =&gt;
Context -&gt; StreamFrom blk -&gt; IO (Maybe ThunkInfo)
forall blk.
(StandardHash blk, Typeable blk) =&gt;
Proxy (StreamFrom blk) -&gt; String
forall a.
(Context -&gt; a -&gt; IO (Maybe ThunkInfo))
-&gt; (Context -&gt; a -&gt; IO (Maybe ThunkInfo))
-&gt; (Proxy a -&gt; String)
-&gt; NoThunks a
showTypeOf :: Proxy (StreamFrom blk) -&gt; String
$cshowTypeOf :: forall blk.
(StandardHash blk, Typeable blk) =&gt;
Proxy (StreamFrom blk) -&gt; String
wNoThunks :: Context -&gt; StreamFrom blk -&gt; IO (Maybe ThunkInfo)
$cwNoThunks :: forall blk.
(StandardHash blk, Typeable blk) =&gt;
Context -&gt; StreamFrom blk -&gt; IO (Maybe ThunkInfo)
noThunks :: Context -&gt; StreamFrom blk -&gt; IO (Maybe ThunkInfo)
$cnoThunks :: forall blk.
(StandardHash blk, Typeable blk) =&gt;
Context -&gt; StreamFrom blk -&gt; IO (Maybe ThunkInfo)
</span><a href="#local-6989586621680016343"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">NoThunks</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span id="local-6989586621680016341"><span id="local-6989586621680016342"></span></span><span class="hs-keyword">newtype</span><span> </span><span id="StreamTo"><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#StreamTo"><span class="hs-identifier hs-var">StreamTo</span></a></span></span><span> </span><span id="local-6989586621680016340"><span class="annot"><a href="#local-6989586621680016340"><span class="hs-identifier hs-type">blk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-114"></span><span>    </span><span id="StreamToInclusive"><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#StreamToInclusive"><span class="hs-identifier hs-var">StreamToInclusive</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Block.RealPoint.html#RealPoint"><span class="hs-identifier hs-type">RealPoint</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680016340"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621680016333"><span id="local-6989586621680016335"><span id="local-6989586621680016337"><span class="annot"><span class="annottext">Int -&gt; StreamTo blk -&gt; ShowS
[StreamTo blk] -&gt; ShowS
StreamTo blk -&gt; String
(Int -&gt; StreamTo blk -&gt; ShowS)
-&gt; (StreamTo blk -&gt; String)
-&gt; ([StreamTo blk] -&gt; ShowS)
-&gt; Show (StreamTo blk)
forall blk. StandardHash blk =&gt; Int -&gt; StreamTo blk -&gt; ShowS
forall blk. StandardHash blk =&gt; [StreamTo blk] -&gt; ShowS
forall blk. StandardHash blk =&gt; StreamTo blk -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [StreamTo blk] -&gt; ShowS
$cshowList :: forall blk. StandardHash blk =&gt; [StreamTo blk] -&gt; ShowS
show :: StreamTo blk -&gt; String
$cshow :: forall blk. StandardHash blk =&gt; StreamTo blk -&gt; String
showsPrec :: Int -&gt; StreamTo blk -&gt; ShowS
$cshowsPrec :: forall blk. StandardHash blk =&gt; Int -&gt; StreamTo blk -&gt; ShowS
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680016329"><span id="local-6989586621680016331"><span class="annot"><span class="annottext">StreamTo blk -&gt; StreamTo blk -&gt; Bool
(StreamTo blk -&gt; StreamTo blk -&gt; Bool)
-&gt; (StreamTo blk -&gt; StreamTo blk -&gt; Bool) -&gt; Eq (StreamTo blk)
forall blk.
StandardHash blk =&gt;
StreamTo blk -&gt; StreamTo blk -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: StreamTo blk -&gt; StreamTo blk -&gt; Bool
$c/= :: forall blk.
StandardHash blk =&gt;
StreamTo blk -&gt; StreamTo blk -&gt; Bool
== :: StreamTo blk -&gt; StreamTo blk -&gt; Bool
$c== :: forall blk.
StandardHash blk =&gt;
StreamTo blk -&gt; StreamTo blk -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. StreamTo blk -&gt; Rep (StreamTo blk) x)
-&gt; (forall x. Rep (StreamTo blk) x -&gt; StreamTo blk)
-&gt; Generic (StreamTo blk)
forall x. Rep (StreamTo blk) x -&gt; StreamTo blk
forall x. StreamTo blk -&gt; Rep (StreamTo blk) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall blk x. Rep (StreamTo blk) x -&gt; StreamTo blk
forall blk x. StreamTo blk -&gt; Rep (StreamTo blk) x
$cto :: forall blk x. Rep (StreamTo blk) x -&gt; StreamTo blk
$cfrom :: forall blk x. StreamTo blk -&gt; Rep (StreamTo blk) x
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">anyclass</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680016321"><span id="local-6989586621680016323"><span id="local-6989586621680016325"><span class="annot"><span class="annottext">Context -&gt; StreamTo blk -&gt; IO (Maybe ThunkInfo)
Proxy (StreamTo blk) -&gt; String
(Context -&gt; StreamTo blk -&gt; IO (Maybe ThunkInfo))
-&gt; (Context -&gt; StreamTo blk -&gt; IO (Maybe ThunkInfo))
-&gt; (Proxy (StreamTo blk) -&gt; String)
-&gt; NoThunks (StreamTo blk)
forall blk.
(StandardHash blk, Typeable blk) =&gt;
Context -&gt; StreamTo blk -&gt; IO (Maybe ThunkInfo)
forall blk.
(StandardHash blk, Typeable blk) =&gt;
Proxy (StreamTo blk) -&gt; String
forall a.
(Context -&gt; a -&gt; IO (Maybe ThunkInfo))
-&gt; (Context -&gt; a -&gt; IO (Maybe ThunkInfo))
-&gt; (Proxy a -&gt; String)
-&gt; NoThunks a
showTypeOf :: Proxy (StreamTo blk) -&gt; String
$cshowTypeOf :: forall blk.
(StandardHash blk, Typeable blk) =&gt;
Proxy (StreamTo blk) -&gt; String
wNoThunks :: Context -&gt; StreamTo blk -&gt; IO (Maybe ThunkInfo)
$cwNoThunks :: forall blk.
(StandardHash blk, Typeable blk) =&gt;
Context -&gt; StreamTo blk -&gt; IO (Maybe ThunkInfo)
noThunks :: Context -&gt; StreamTo blk -&gt; IO (Maybe ThunkInfo)
$cnoThunks :: forall blk.
(StandardHash blk, Typeable blk) =&gt;
Context -&gt; StreamTo blk -&gt; IO (Maybe ThunkInfo)
</span><a href="#local-6989586621680016321"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">NoThunks</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span>
</span><span id="line-118"></span><span class="hs-comment">-- | Check whether the bounds make sense</span><span>
</span><span id="line-119"></span><span class="hs-comment">--</span><span>
</span><span id="line-120"></span><span class="hs-comment">-- An example of bounds that don't make sense:</span><span>
</span><span id="line-121"></span><span class="hs-comment">--</span><span>
</span><span id="line-122"></span><span class="hs-comment">-- &gt; StreamFromExclusive (BlockPoint 3 ..)</span><span>
</span><span id="line-123"></span><span class="hs-comment">-- &gt; StreamToInclusive   (RealPoint  3 ..)</span><span>
</span><span id="line-124"></span><span class="hs-comment">--</span><span>
</span><span id="line-125"></span><span class="hs-comment">-- This function does not check whether the bounds correspond to existing</span><span>
</span><span id="line-126"></span><span class="hs-comment">-- blocks.</span><span>
</span><span id="line-127"></span><span id="local-6989586621680016320"><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#validBounds"><span class="hs-identifier hs-type">validBounds</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.7/ouroboros-network-api-0.1.0.0/noopt/doc/html/ouroboros-network-api/src"><span class="hs-identifier hs-type">StandardHash</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680016320"><span class="hs-identifier hs-type">blk</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#StreamFrom"><span class="hs-identifier hs-type">StreamFrom</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680016320"><span class="hs-identifier hs-type">blk</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#StreamTo"><span class="hs-identifier hs-type">StreamTo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680016320"><span class="hs-identifier hs-type">blk</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span></span><span>
</span><span id="line-128"></span><span id="validBounds"><span class="annot"><span class="annottext">validBounds :: StreamFrom blk -&gt; StreamTo blk -&gt; Bool
</span><a href="Ouroboros.Consensus.Storage.Common.html#validBounds"><span class="hs-identifier hs-var hs-var">validBounds</span></a></span></span><span> </span><span id="local-6989586621680016319"><span class="annot"><span class="annottext">StreamFrom blk
</span><a href="#local-6989586621680016319"><span class="hs-identifier hs-var">from</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#StreamToInclusive"><span class="hs-identifier hs-type">StreamToInclusive</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Block.RealPoint.html#RealPoint"><span class="hs-identifier hs-type">RealPoint</span></a></span><span> </span><span id="local-6989586621680016317"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621680016317"><span class="hs-identifier hs-var">sto</span></a></span></span><span> </span><span id="local-6989586621680016316"><span class="annot"><span class="annottext">HeaderHash blk
</span><a href="#local-6989586621680016316"><span class="hs-identifier hs-var">hto</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-129"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">StreamFrom blk
</span><a href="#local-6989586621680016319"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-130"></span><span>      </span><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#StreamFromExclusive"><span class="hs-identifier hs-type">StreamFromExclusive</span></a></span><span> </span><span class="annot"><span class="annottext">Point blk
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.7/ouroboros-network-api-0.1.0.0/noopt/doc/html/ouroboros-network-api/src"><span class="hs-identifier hs-var">GenesisPoint</span></a></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-131"></span><span>      </span><span class="hs-comment">-- EBBs spoil the fun again: when 'StreamFromExclusive' refers to an EBB</span><span>
</span><span id="line-132"></span><span>      </span><span class="hs-comment">-- in slot X and 'StreamToInclusive' to the regular block in the same slot</span><span>
</span><span id="line-133"></span><span>      </span><span class="hs-comment">-- X, the bound is still valid. Without EBBs, we would have @sfrom &lt; sto@.</span><span>
</span><span id="line-134"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-135"></span><span>      </span><span class="hs-comment">-- We /can/ rule out streaming exclusively from the block to the same</span><span>
</span><span id="line-136"></span><span>      </span><span class="hs-comment">-- block.</span><span>
</span><span id="line-137"></span><span>      </span><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#StreamFromExclusive"><span class="hs-identifier hs-type">StreamFromExclusive</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.7/ouroboros-network-api-0.1.0.0/noopt/doc/html/ouroboros-network-api/src"><span class="hs-identifier hs-type">BlockPoint</span></a></span><span> </span><span id="local-6989586621680016313"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621680016313"><span class="hs-identifier hs-var">sfrom</span></a></span></span><span> </span><span id="local-6989586621680016312"><span class="annot"><span class="annottext">HeaderHash blk
</span><a href="#local-6989586621680016312"><span class="hs-identifier hs-var">hfrom</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HeaderHash blk
</span><a href="#local-6989586621680016312"><span class="hs-identifier hs-var">hfrom</span></a></span><span> </span><span class="annot"><span class="annottext">HeaderHash blk -&gt; HeaderHash blk -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">/=</span></a></span><span> </span><span class="annot"><span class="annottext">HeaderHash blk
</span><a href="#local-6989586621680016316"><span class="hs-identifier hs-var">hto</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621680016313"><span class="hs-identifier hs-var">sfrom</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo -&gt; SlotNo -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621680016317"><span class="hs-identifier hs-var">sto</span></a></span><span>
</span><span id="line-138"></span><span>      </span><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#StreamFromInclusive"><span class="hs-identifier hs-type">StreamFromInclusive</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Block.RealPoint.html#RealPoint"><span class="hs-identifier hs-type">RealPoint</span></a></span><span>  </span><span id="local-6989586621680016308"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621680016308"><span class="hs-identifier hs-var">sfrom</span></a></span></span><span> </span><span class="annot"><span class="annottext">HeaderHash blk
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621680016308"><span class="hs-identifier hs-var">sfrom</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo -&gt; SlotNo -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621680016317"><span class="hs-identifier hs-var">sto</span></a></span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  BlockComponent
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span class="hs-comment">-- | Which component of the block to read from a database: the whole block,</span><span>
</span><span id="line-145"></span><span class="hs-comment">-- its header, its hash, the block size, ..., or combinations thereof.</span><span>
</span><span id="line-146"></span><span class="hs-comment">--</span><span>
</span><span id="line-147"></span><span class="hs-comment">-- NOTE: when requesting multiple components, we will not optimise/cache them.</span><span>
</span><span id="line-148"></span><span class="hs-keyword">data</span><span> </span><span id="BlockComponent"><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#BlockComponent"><span class="hs-identifier hs-var">BlockComponent</span></a></span></span><span> </span><span id="local-6989586621680016307"><span class="annot"><a href="#local-6989586621680016307"><span class="hs-identifier hs-type">blk</span></a></span></span><span> </span><span id="local-6989586621680016306"><span class="annot"><a href="#local-6989586621680016306"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-149"></span><span>  </span><span class="hs-comment">-- | Verify the integrity of the block by checking its signature and/or</span><span>
</span><span id="line-150"></span><span>  </span><span class="hs-comment">-- hashes. The interpreter should throw an exception when the block does not</span><span>
</span><span id="line-151"></span><span>  </span><span class="hs-comment">-- pass the check.</span><span>
</span><span id="line-152"></span><span>  </span><span id="local-6989586621680016305"><span id="GetVerifiedBlock"><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#GetVerifiedBlock"><span class="hs-identifier hs-var">GetVerifiedBlock</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#BlockComponent"><span class="hs-identifier hs-type">BlockComponent</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680016305"><span class="hs-identifier hs-type">blk</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680016305"><span class="hs-identifier hs-type">blk</span></a></span></span><span>
</span><span id="line-153"></span><span>  </span><span id="local-6989586621680016303"><span id="GetBlock"><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#GetBlock"><span class="hs-identifier hs-var">GetBlock</span></a></span></span><span>         </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#BlockComponent"><span class="hs-identifier hs-type">BlockComponent</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680016303"><span class="hs-identifier hs-type">blk</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680016303"><span class="hs-identifier hs-type">blk</span></a></span></span><span>
</span><span id="line-154"></span><span>  </span><span id="local-6989586621680016301"><span id="GetRawBlock"><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#GetRawBlock"><span class="hs-identifier hs-var">GetRawBlock</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#BlockComponent"><span class="hs-identifier hs-type">BlockComponent</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680016301"><span class="hs-identifier hs-type">blk</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/bytestring-0.10.12.0/src"><span class="hs-identifier hs-type">ByteString</span></a></span></span><span>
</span><span id="line-155"></span><span>  </span><span id="local-6989586621680016299"><span id="GetHeader"><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#GetHeader"><span class="hs-identifier hs-var">GetHeader</span></a></span></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#BlockComponent"><span class="hs-identifier hs-type">BlockComponent</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680016299"><span class="hs-identifier hs-type">blk</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Block.Abstract.html#Header"><span class="hs-identifier hs-type">Header</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680016299"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-156"></span><span>  </span><span id="local-6989586621680016296"><span id="GetRawHeader"><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#GetRawHeader"><span class="hs-identifier hs-var">GetRawHeader</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#BlockComponent"><span class="hs-identifier hs-type">BlockComponent</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680016296"><span class="hs-identifier hs-type">blk</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/bytestring-0.10.12.0/src"><span class="hs-identifier hs-type">ByteString</span></a></span></span><span>
</span><span id="line-157"></span><span>  </span><span id="local-6989586621680016294"><span id="GetHash"><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#GetHash"><span class="hs-identifier hs-var">GetHash</span></a></span></span><span>          </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#BlockComponent"><span class="hs-identifier hs-type">BlockComponent</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680016294"><span class="hs-identifier hs-type">blk</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.7/ouroboros-network-api-0.1.0.0/noopt/doc/html/ouroboros-network-api/src"><span class="hs-identifier hs-type">HeaderHash</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680016294"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-158"></span><span>  </span><span id="local-6989586621680016292"><span id="GetSlot"><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#GetSlot"><span class="hs-identifier hs-var">GetSlot</span></a></span></span><span>          </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#BlockComponent"><span class="hs-identifier hs-type">BlockComponent</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680016292"><span class="hs-identifier hs-type">blk</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">SlotNo</span></span></span><span>
</span><span id="line-159"></span><span>  </span><span id="local-6989586621680016290"><span id="GetIsEBB"><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#GetIsEBB"><span class="hs-identifier hs-var">GetIsEBB</span></a></span></span><span>         </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#BlockComponent"><span class="hs-identifier hs-type">BlockComponent</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680016290"><span class="hs-identifier hs-type">blk</span></a></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Block.EBB.html#IsEBB"><span class="hs-identifier hs-type">IsEBB</span></a></span></span><span>
</span><span id="line-160"></span><span>  </span><span class="hs-comment">-- TODO: use `SizeInBytes` rather than Word32</span><span>
</span><span id="line-161"></span><span>  </span><span id="local-6989586621680016287"><span id="GetBlockSize"><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#GetBlockSize"><span class="hs-identifier hs-var">GetBlockSize</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#BlockComponent"><span class="hs-identifier hs-type">BlockComponent</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680016287"><span class="hs-identifier hs-type">blk</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Word32</span></a></span></span><span>
</span><span id="line-162"></span><span>  </span><span id="local-6989586621680016285"><span id="GetHeaderSize"><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#GetHeaderSize"><span class="hs-identifier hs-var">GetHeaderSize</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#BlockComponent"><span class="hs-identifier hs-type">BlockComponent</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680016285"><span class="hs-identifier hs-type">blk</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Word16</span></a></span></span><span>
</span><span id="line-163"></span><span>  </span><span id="local-6989586621680016283"><span id="GetNestedCtxt"><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#GetNestedCtxt"><span class="hs-identifier hs-var">GetNestedCtxt</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#BlockComponent"><span class="hs-identifier hs-type">BlockComponent</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680016283"><span class="hs-identifier hs-type">blk</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Util.html#SomeSecond"><span class="hs-identifier hs-type">SomeSecond</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Block.NestedContent.html#NestedCtxt"><span class="hs-identifier hs-type">NestedCtxt</span></a></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Block.Abstract.html#Header"><span class="hs-identifier hs-type">Header</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680016283"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-164"></span><span>  </span><span id="local-6989586621680016467"><span id="local-6989586621680016468"><span id="GetPure"><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#GetPure"><span class="hs-identifier hs-var">GetPure</span></a></span></span><span>          </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621680016468"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-165"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#BlockComponent"><span class="hs-identifier hs-type">BlockComponent</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680016467"><span class="hs-identifier hs-type">blk</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680016468"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-166"></span><span>  </span><span id="local-6989586621680016276"><span id="local-6989586621680016277"><span id="local-6989586621680016278"><span id="GetApply"><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#GetApply"><span class="hs-identifier hs-var">GetApply</span></a></span></span><span>         </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#BlockComponent"><span class="hs-identifier hs-type">BlockComponent</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680016278"><span class="hs-identifier hs-type">blk</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680016277"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680016276"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-167"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#BlockComponent"><span class="hs-identifier hs-type">BlockComponent</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680016278"><span class="hs-identifier hs-type">blk</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680016277"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-168"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#BlockComponent"><span class="hs-identifier hs-type">BlockComponent</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680016278"><span class="hs-identifier hs-type">blk</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680016276"><span class="hs-identifier hs-type">b</span></a></span></span></span></span><span>
</span><span id="line-169"></span><span>
</span><span id="line-170"></span><span id="local-6989586621680016274"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680016271"><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Functor</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#BlockComponent"><span class="hs-identifier hs-type">BlockComponent</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680016274"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-171"></span><span>  </span><span id="local-6989586621680016269"><span class="annot"><span class="annottext">fmap :: (a -&gt; b) -&gt; BlockComponent blk a -&gt; BlockComponent blk b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">fmap</span></a></span></span><span> </span><span id="local-6989586621680016268"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621680016268"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; BlockComponent blk (a -&gt; b)
forall a blk. a -&gt; BlockComponent blk a
</span><a href="Ouroboros.Consensus.Storage.Common.html#GetPure"><span class="hs-identifier hs-var">GetPure</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621680016268"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">BlockComponent blk (a -&gt; b)
-&gt; BlockComponent blk a -&gt; BlockComponent blk b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span id="local-6989586621680016267"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680016258"><span id="local-6989586621680016260"><span id="local-6989586621680016262"><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Applicative</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#BlockComponent"><span class="hs-identifier hs-type">BlockComponent</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680016267"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-174"></span><span>  </span><span id="local-6989586621680016256"><span class="annot"><span class="annottext">pure :: a -&gt; BlockComponent blk a
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">pure</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; BlockComponent blk a
forall a blk. a -&gt; BlockComponent blk a
</span><a href="Ouroboros.Consensus.Storage.Common.html#GetPure"><span class="hs-identifier hs-var">GetPure</span></a></span><span>
</span><span id="line-175"></span><span>  </span><span id="local-6989586621680016255"><span class="annot"><span class="annottext">&lt;*&gt; :: BlockComponent blk (a -&gt; b)
-&gt; BlockComponent blk a -&gt; BlockComponent blk b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var hs-var hs-var hs-var">(&lt;*&gt;)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BlockComponent blk (a -&gt; b)
-&gt; BlockComponent blk a -&gt; BlockComponent blk b
forall blk a b.
BlockComponent blk (a -&gt; b)
-&gt; BlockComponent blk a -&gt; BlockComponent blk b
</span><a href="Ouroboros.Consensus.Storage.Common.html#GetApply"><span class="hs-identifier hs-var">GetApply</span></a></span></span><span>
</span><span id="line-176"></span></pre></body></html>