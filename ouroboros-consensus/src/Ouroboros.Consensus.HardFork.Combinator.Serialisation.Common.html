<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span id="%24maxtag_EjdugvzzqylALQ5rP9mOBZ"><span id="%24tag2con_EjdugvzzqylALQ5rP9mOBZ"><span id="%24con2tag_EjdugvzzqylALQ5rP9mOBZ"><span id="%24maxtag_H5gPR1PZkXX6JdJM2BX50g"><span id="%24tag2con_H5gPR1PZkXX6JdJM2BX50g"><span id="%24con2tag_H5gPR1PZkXX6JdJM2BX50g"></span></span></span></span></span></span><span class="hs-pragma">{-# LANGUAGE DataKinds               #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE EmptyCase               #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts        #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE GADTs                   #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE KindSignatures          #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase              #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings       #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes              #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards         #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables     #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE StandaloneDeriving      #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications        #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies            #-}</span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators           #-}</span><span>
</span><span id="line-15"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances    #-}</span><span>
</span><span id="line-16"></span><span class="hs-pragma">{-# LANGUAGE UndecidableSuperClasses #-}</span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-orphans #-}</span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-21"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Conditions required by the HFC to support serialisation</span></span><span>
</span><span id="line-22"></span><span>    </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#HardForkEncoderException"><span class="hs-identifier">HardForkEncoderException</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#SerialiseConstraintsHFC"><span class="hs-identifier">SerialiseConstraintsHFC</span></a></span><span>
</span><span id="line-24"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#SerialiseHFC"><span class="hs-identifier">SerialiseHFC</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#disabledEraException"><span class="hs-identifier">disabledEraException</span></a></span><span>
</span><span id="line-26"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#futureEraException"><span class="hs-identifier">futureEraException</span></a></span><span>
</span><span id="line-27"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#pSHFC"><span class="hs-identifier">pSHFC</span></a></span><span>
</span><span id="line-28"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Distinguish first era from the rest</span></span><span>
</span><span id="line-29"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#FirstEra"><span class="hs-identifier">FirstEra</span></a></span><span>
</span><span id="line-30"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#LaterEra"><span class="hs-identifier">LaterEra</span></a></span><span>
</span><span id="line-31"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#isFirstEra"><span class="hs-identifier">isFirstEra</span></a></span><span>
</span><span id="line-32"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#notFirstEra"><span class="hs-identifier">notFirstEra</span></a></span><span>
</span><span id="line-33"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Versioning</span></span><span>
</span><span id="line-34"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#EraNodeToClientVersion"><span class="hs-identifier">EraNodeToClientVersion</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#EraNodeToNodeVersion"><span class="hs-identifier">EraNodeToNodeVersion</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#HardForkNodeToClientVersion"><span class="hs-identifier">HardForkNodeToClientVersion</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#HardForkNodeToNodeVersion"><span class="hs-identifier">HardForkNodeToNodeVersion</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#HardForkSpecificNodeToClientVersion"><span class="hs-identifier">HardForkSpecificNodeToClientVersion</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#HardForkSpecificNodeToNodeVersion"><span class="hs-identifier">HardForkSpecificNodeToNodeVersion</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#isHardForkNodeToClientEnabled"><span class="hs-identifier">isHardForkNodeToClientEnabled</span></a></span><span>
</span><span id="line-41"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#isHardForkNodeToNodeEnabled"><span class="hs-identifier">isHardForkNodeToNodeEnabled</span></a></span><span>
</span><span id="line-42"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Dealing with annotations</span></span><span>
</span><span id="line-43"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#AnnDecoder"><span class="hs-identifier">AnnDecoder</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Serialisation of telescopes</span></span><span>
</span><span id="line-45"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#decodeTelescope"><span class="hs-identifier">decodeTelescope</span></a></span><span>
</span><span id="line-46"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#encodeTelescope"><span class="hs-identifier">encodeTelescope</span></a></span><span>
</span><span id="line-47"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Serialisation of sums</span></span><span>
</span><span id="line-48"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#decodeAnnNS"><span class="hs-identifier">decodeAnnNS</span></a></span><span>
</span><span id="line-49"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#decodeNS"><span class="hs-identifier">decodeNS</span></a></span><span>
</span><span id="line-50"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#encodeNS"><span class="hs-identifier">encodeNS</span></a></span><span>
</span><span id="line-51"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Dependent serialisation</span></span><span>
</span><span id="line-52"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#decodeNested"><span class="hs-identifier">decodeNested</span></a></span><span>
</span><span id="line-53"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#decodeNestedCtxt"><span class="hs-identifier">decodeNestedCtxt</span></a></span><span>
</span><span id="line-54"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#encodeNested"><span class="hs-identifier">encodeNested</span></a></span><span>
</span><span id="line-55"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#encodeNestedCtxt"><span class="hs-identifier">encodeNestedCtxt</span></a></span><span>
</span><span id="line-56"></span><span>    </span><span class="annot"><span class="hs-comment">-- * MismatchEraInfo</span></span><span>
</span><span id="line-57"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#decodeEitherMismatch"><span class="hs-identifier">decodeEitherMismatch</span></a></span><span>
</span><span id="line-58"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#encodeEitherMismatch"><span class="hs-identifier">encodeEitherMismatch</span></a></span><span>
</span><span id="line-59"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Distributive properties</span></span><span>
</span><span id="line-60"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Block.html#distribAnnTip"><span class="hs-identifier">distribAnnTip</span></a></span><span>
</span><span id="line-61"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#distribQueryIfCurrent"><span class="hs-identifier">distribQueryIfCurrent</span></a></span><span>
</span><span id="line-62"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#distribSerialisedHeader"><span class="hs-identifier">distribSerialisedHeader</span></a></span><span>
</span><span id="line-63"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Block.html#undistribAnnTip"><span class="hs-identifier">undistribAnnTip</span></a></span><span>
</span><span id="line-64"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#undistribQueryIfCurrent"><span class="hs-identifier">undistribQueryIfCurrent</span></a></span><span>
</span><span id="line-65"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#undistribSerialisedHeader"><span class="hs-identifier">undistribSerialisedHeader</span></a></span><span>
</span><span id="line-66"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Deriving-via support for tests</span></span><span>
</span><span id="line-67"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#SerialiseNS"><span class="hs-identifier">SerialiseNS</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Codec.CBOR.Decoding</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Decoder</span></span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Codec.CBOR.Decoding</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Dec</span></span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Codec.CBOR.Encoding</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Encoding</span></span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Codec.CBOR.Encoding</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Enc</span></span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Codec.Serialise</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Serialise</span></span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Codec.Serialise</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Serialise</span></span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Control.Exception</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Exception</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">throw</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/bytestring-0.10.12.0/src"><span class="hs-identifier">Data.ByteString.Lazy</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Lazy</span></span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/bytestring-0.10.12.0/src"><span class="hs-identifier">Data.ByteString.Short</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/bytestring-0.10.12.0/src"><span class="hs-identifier">ShortByteString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/bytestring-0.10.12.0/src"><span class="hs-identifier">Data.ByteString.Short</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Short</span></span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Kind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Data.SOP.Strict.html"><span class="hs-identifier">Data.SOP.Strict</span></a></span><span>
</span><span id="line-82"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Word</span></a></span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Cardano.Binary</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">enforceSize</span></span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.7/ouroboros-network-api-0.1.0.0/noopt/doc/html/ouroboros-network-api/src"><span class="hs-identifier">Ouroboros.Network.Block</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.7/ouroboros-network-api-0.1.0.0/noopt/doc/html/ouroboros-network-api/src"><span class="hs-identifier">Serialised</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.Block.html"><span class="hs-identifier">Ouroboros.Consensus.Block</span></a></span><span>
</span><span id="line-89"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.Node.NetworkProtocolVersion.html"><span class="hs-identifier">Ouroboros.Consensus.Node.NetworkProtocolVersion</span></a></span><span>
</span><span id="line-90"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.Node.Run.html"><span class="hs-identifier">Ouroboros.Consensus.Node.Run</span></a></span><span>
</span><span id="line-91"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.Node.Serialisation.html"><span class="hs-identifier">Ouroboros.Consensus.Node.Serialisation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.7/ouroboros-network-protocols-0.3.0.0/noopt/doc/html/ouroboros-network-protocols/src"><span class="hs-identifier">Some</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-92"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.Storage.Serialisation.html"><span class="hs-identifier">Ouroboros.Consensus.Storage.Serialisation</span></a></span><span>
</span><span id="line-93"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.Util.SOP.html"><span class="hs-identifier">Ouroboros.Consensus.Util.SOP</span></a></span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Abstract.html"><span class="hs-identifier">Ouroboros.Consensus.HardFork.Combinator.Abstract</span></a></span><span>
</span><span id="line-96"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.AcrossEras.html"><span class="hs-identifier">Ouroboros.Consensus.HardFork.Combinator.AcrossEras</span></a></span><span>
</span><span id="line-97"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Basics.html"><span class="hs-identifier">Ouroboros.Consensus.HardFork.Combinator.Basics</span></a></span><span>
</span><span id="line-98"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Block.html"><span class="hs-identifier">Ouroboros.Consensus.HardFork.Combinator.Block</span></a></span><span>
</span><span id="line-99"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Info.html"><span class="hs-identifier">Ouroboros.Consensus.HardFork.Combinator.Info</span></a></span><span>
</span><span id="line-100"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Ledger.Query.html"><span class="hs-identifier">Ouroboros.Consensus.HardFork.Combinator.Ledger.Query</span></a></span><span>
</span><span id="line-101"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.State.html"><span class="hs-identifier">Ouroboros.Consensus.HardFork.Combinator.State</span></a></span><span>
</span><span id="line-102"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.State.Instances.html"><span class="hs-identifier">Ouroboros.Consensus.HardFork.Combinator.State.Instances</span></a></span><span>
</span><span id="line-103"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Util.Match.html"><span class="hs-identifier">Ouroboros.Consensus.HardFork.Combinator.Util.Match</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Match</span></span><span>
</span><span id="line-104"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Util.Telescope.html"><span class="hs-identifier">Ouroboros.Consensus.HardFork.Combinator.Util.Telescope</span></a></span><span>
</span><span id="line-105"></span><span>                     </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Util.Telescope.html#SimpleTelescope"><span class="hs-identifier">SimpleTelescope</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Util.Telescope.html#Telescope"><span class="hs-identifier">Telescope</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Util.Telescope.html"><span class="hs-identifier">Ouroboros.Consensus.HardFork.Combinator.Util.Telescope</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Telescope</span></span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Distinguish between the first era and all others
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="FirstEra"><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#FirstEra"><span class="hs-identifier hs-var">FirstEra</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680058024"><span class="annot"><a href="#local-6989586621680058024"><span class="hs-identifier hs-type">xs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-113"></span><span>  </span><span id="FirstEra"><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#FirstEra"><span class="hs-identifier hs-var">FirstEra</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680058023"><span class="annot"><a href="#local-6989586621680058023"><span class="hs-identifier hs-type hs-type">x</span></a></span></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span id="local-6989586621680058022"><span class="annot"><a href="#local-6989586621680058022"><span class="hs-identifier hs-type hs-type">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621680058023"><span class="hs-identifier hs-type">x</span></a></span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="LaterEra"><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#LaterEra"><span class="hs-identifier hs-var">LaterEra</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680058021"><span class="annot"><a href="#local-6989586621680058021"><span class="hs-identifier hs-type">xs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-116"></span><span>  </span><span id="LaterEra"><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#LaterEra"><span class="hs-identifier hs-var">LaterEra</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680058020"><span class="annot"><a href="#local-6989586621680058020"><span class="hs-identifier hs-type hs-type">x</span></a></span></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span id="local-6989586621680058019"><span class="annot"><a href="#local-6989586621680058019"><span class="hs-identifier hs-type hs-type">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621680058019"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-117"></span><span>
</span><span id="line-118"></span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#isFirstEra"><span class="hs-identifier hs-type">isFirstEra</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680058018"><span class="annot"><a href="#local-6989586621680058018"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621680058017"><span class="annot"><a href="#local-6989586621680058017"><span class="hs-identifier hs-type">xs</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">All</span></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Abstract.SingleEraBlock.html#SingleEraBlock"><span class="hs-identifier hs-type">SingleEraBlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058017"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-119"></span><span>           </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#NS"><span class="hs-identifier hs-type">NS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058018"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058017"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-120"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Strict.html#NS"><span class="hs-identifier hs-type">NS</span></a></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Info.html#SingleEraInfo"><span class="hs-identifier hs-type">SingleEraInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#LaterEra"><span class="hs-identifier hs-type">LaterEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058017"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680058018"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#FirstEra"><span class="hs-identifier hs-type">FirstEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058017"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span id="isFirstEra"><span class="annot"><span class="annottext">isFirstEra :: NS f xs
-&gt; Either (NS SingleEraInfo (LaterEra xs)) (f (FirstEra xs))
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#isFirstEra"><span class="hs-identifier hs-var hs-var">isFirstEra</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Strict.html#Z"><span class="hs-identifier hs-type">Z</span></a></span><span> </span><span id="local-6989586621680058015"><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621680058015"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f x -&gt; Either (NS SingleEraInfo xs) (f x)
forall a b. b -&gt; Either a b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Right</span></a></span><span> </span><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621680058015"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-122"></span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#isFirstEra"><span class="hs-identifier hs-var">isFirstEra</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Strict.html#S"><span class="hs-identifier hs-type">S</span></a></span><span> </span><span id="local-6989586621680058013"><span class="annot"><span class="annottext">NS f xs
</span><a href="#local-6989586621680058013"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NS SingleEraInfo xs -&gt; Either (NS SingleEraInfo xs) (f x)
forall a b. a -&gt; Either a b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy SingleEraBlock
-&gt; (forall a. SingleEraBlock a =&gt; f a -&gt; SingleEraInfo a)
-&gt; NS f xs
-&gt; NS SingleEraInfo xs
forall k l (h :: (k -&gt; *) -&gt; l -&gt; *) (c :: k -&gt; Constraint)
       (xs :: l) (proxy :: (k -&gt; Constraint) -&gt; *) (f :: k -&gt; *)
       (f' :: k -&gt; *).
(AllN (Prod h) c xs, HAp h) =&gt;
proxy c
-&gt; (forall (a :: k). c a =&gt; f a -&gt; f' a) -&gt; h f xs -&gt; h f' xs
</span><span class="hs-identifier hs-var">hcmap</span></span><span> </span><span class="annot"><span class="annottext">Proxy SingleEraBlock
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Abstract.SingleEraBlock.html#proxySingle"><span class="hs-identifier hs-var">proxySingle</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. SingleEraBlock a =&gt; f a -&gt; SingleEraInfo a
</span><a href="#local-6989586621680058010"><span class="hs-identifier hs-var">aux</span></a></span><span> </span><span class="annot"><span class="annottext">NS f xs
</span><a href="#local-6989586621680058013"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-124"></span><span>    </span><span class="annot"><a href="#local-6989586621680058010"><span class="hs-identifier hs-type">aux</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680058009"><span class="annot"><a href="#local-6989586621680058009"><span class="hs-identifier hs-type">blk</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Abstract.SingleEraBlock.html#SingleEraBlock"><span class="hs-identifier hs-type">SingleEraBlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058009"><span class="hs-identifier hs-type">blk</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680058018"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058009"><span class="hs-identifier hs-type">blk</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Info.html#SingleEraInfo"><span class="hs-identifier hs-type">SingleEraInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058009"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-125"></span><span>    </span><span id="local-6989586621680058010"><span class="annot"><span class="annottext">aux :: f blk -&gt; SingleEraInfo blk
</span><a href="#local-6989586621680058010"><span class="hs-identifier hs-var hs-var">aux</span></a></span></span><span> </span><span class="annot"><span class="annottext">f blk
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy blk -&gt; SingleEraInfo blk
forall blk (proxy :: * -&gt; *).
SingleEraBlock blk =&gt;
proxy blk -&gt; SingleEraInfo blk
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Abstract.SingleEraBlock.html#singleEraInfo"><span class="hs-identifier hs-var">singleEraInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy blk
forall k (t :: k). Proxy t
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680058009"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span class="hs-comment">-- | Used to construct 'FutureEraException'</span><span>
</span><span id="line-128"></span><span id="local-6989586621680058005"><span id="local-6989586621680058006"><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#notFirstEra"><span class="hs-identifier hs-type">notFirstEra</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">All</span></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Abstract.SingleEraBlock.html#SingleEraBlock"><span class="hs-identifier hs-type">SingleEraBlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058006"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-129"></span><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#NS"><span class="hs-identifier hs-type">NS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058005"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058006"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-comment">-- ^ 'NS' intended to be from a future era</span><span>
</span><span id="line-130"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#NS"><span class="hs-identifier hs-type">NS</span></a></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Info.html#SingleEraInfo"><span class="hs-identifier hs-type">SingleEraInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058006"><span class="hs-identifier hs-type">xs</span></a></span></span></span><span>
</span><span id="line-131"></span><span id="notFirstEra"><span class="annot"><span class="annottext">notFirstEra :: NS f xs -&gt; NS SingleEraInfo xs
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#notFirstEra"><span class="hs-identifier hs-var hs-var">notFirstEra</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy SingleEraBlock
-&gt; (forall a. SingleEraBlock a =&gt; f a -&gt; SingleEraInfo a)
-&gt; NS f xs
-&gt; NS SingleEraInfo xs
forall k l (h :: (k -&gt; *) -&gt; l -&gt; *) (c :: k -&gt; Constraint)
       (xs :: l) (proxy :: (k -&gt; Constraint) -&gt; *) (f :: k -&gt; *)
       (f' :: k -&gt; *).
(AllN (Prod h) c xs, HAp h) =&gt;
proxy c
-&gt; (forall (a :: k). c a =&gt; f a -&gt; f' a) -&gt; h f xs -&gt; h f' xs
</span><span class="hs-identifier hs-var">hcmap</span></span><span> </span><span class="annot"><span class="annottext">Proxy SingleEraBlock
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Abstract.SingleEraBlock.html#proxySingle"><span class="hs-identifier hs-var">proxySingle</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. SingleEraBlock a =&gt; f a -&gt; SingleEraInfo a
forall (f :: * -&gt; *) blk.
SingleEraBlock blk =&gt;
f blk -&gt; SingleEraInfo blk
</span><a href="#local-6989586621680058004"><span class="hs-identifier hs-var">aux</span></a></span><span>
</span><span id="line-132"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-133"></span><span>    </span><span class="annot"><a href="#local-6989586621680058004"><span class="hs-identifier hs-type">aux</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680058607"><span class="annot"><a href="#local-6989586621680058607"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621680058608"><span class="annot"><a href="#local-6989586621680058608"><span class="hs-identifier hs-type">blk</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Abstract.SingleEraBlock.html#SingleEraBlock"><span class="hs-identifier hs-type">SingleEraBlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058608"><span class="hs-identifier hs-type">blk</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680058607"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058608"><span class="hs-identifier hs-type">blk</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Info.html#SingleEraInfo"><span class="hs-identifier hs-type">SingleEraInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058608"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-134"></span><span>    </span><span id="local-6989586621680058004"><span class="annot"><span class="annottext">aux :: f blk -&gt; SingleEraInfo blk
</span><a href="#local-6989586621680058004"><span class="hs-identifier hs-var hs-var">aux</span></a></span></span><span> </span><span class="annot"><span class="annottext">f blk
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy blk -&gt; SingleEraInfo blk
forall blk (proxy :: * -&gt; *).
SingleEraBlock blk =&gt;
proxy blk -&gt; SingleEraInfo blk
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Abstract.SingleEraBlock.html#singleEraInfo"><span class="hs-identifier hs-var">singleEraInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy blk
forall k (t :: k). Proxy t
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680058608"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-135"></span><span>
</span><span id="line-136"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Versioning
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span class="hs-comment">-- | Versioning of the specific additions made by the HFC to the @NodeToNode@</span><span>
</span><span id="line-141"></span><span class="hs-comment">-- protocols, e.g., the era tag.</span><span>
</span><span id="line-142"></span><span class="hs-keyword">data</span><span> </span><span id="HardForkSpecificNodeToNodeVersion"><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#HardForkSpecificNodeToNodeVersion"><span class="hs-identifier hs-var">HardForkSpecificNodeToNodeVersion</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-143"></span><span>    </span><span id="HardForkSpecificNodeToNodeVersion1"><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#HardForkSpecificNodeToNodeVersion1"><span class="hs-identifier hs-var">HardForkSpecificNodeToNodeVersion1</span></a></span></span><span>
</span><span id="line-144"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680057999"><span id="local-6989586621680058001"><span class="annot"><span class="annottext">HardForkSpecificNodeToNodeVersion
-&gt; HardForkSpecificNodeToNodeVersion -&gt; Bool
(HardForkSpecificNodeToNodeVersion
 -&gt; HardForkSpecificNodeToNodeVersion -&gt; Bool)
-&gt; (HardForkSpecificNodeToNodeVersion
    -&gt; HardForkSpecificNodeToNodeVersion -&gt; Bool)
-&gt; Eq HardForkSpecificNodeToNodeVersion
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: HardForkSpecificNodeToNodeVersion
-&gt; HardForkSpecificNodeToNodeVersion -&gt; Bool
$c/= :: HardForkSpecificNodeToNodeVersion
-&gt; HardForkSpecificNodeToNodeVersion -&gt; Bool
== :: HardForkSpecificNodeToNodeVersion
-&gt; HardForkSpecificNodeToNodeVersion -&gt; Bool
$c== :: HardForkSpecificNodeToNodeVersion
-&gt; HardForkSpecificNodeToNodeVersion -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680057983"><span id="local-6989586621680057985"><span id="local-6989586621680057987"><span id="local-6989586621680057989"><span id="local-6989586621680057991"><span id="local-6989586621680057993"><span id="local-6989586621680057995"><span class="annot"><span class="annottext">Eq HardForkSpecificNodeToNodeVersion
Eq HardForkSpecificNodeToNodeVersion
-&gt; (HardForkSpecificNodeToNodeVersion
    -&gt; HardForkSpecificNodeToNodeVersion -&gt; Ordering)
-&gt; (HardForkSpecificNodeToNodeVersion
    -&gt; HardForkSpecificNodeToNodeVersion -&gt; Bool)
-&gt; (HardForkSpecificNodeToNodeVersion
    -&gt; HardForkSpecificNodeToNodeVersion -&gt; Bool)
-&gt; (HardForkSpecificNodeToNodeVersion
    -&gt; HardForkSpecificNodeToNodeVersion -&gt; Bool)
-&gt; (HardForkSpecificNodeToNodeVersion
    -&gt; HardForkSpecificNodeToNodeVersion -&gt; Bool)
-&gt; (HardForkSpecificNodeToNodeVersion
    -&gt; HardForkSpecificNodeToNodeVersion
    -&gt; HardForkSpecificNodeToNodeVersion)
-&gt; (HardForkSpecificNodeToNodeVersion
    -&gt; HardForkSpecificNodeToNodeVersion
    -&gt; HardForkSpecificNodeToNodeVersion)
-&gt; Ord HardForkSpecificNodeToNodeVersion
HardForkSpecificNodeToNodeVersion
-&gt; HardForkSpecificNodeToNodeVersion -&gt; Bool
HardForkSpecificNodeToNodeVersion
-&gt; HardForkSpecificNodeToNodeVersion -&gt; Ordering
HardForkSpecificNodeToNodeVersion
-&gt; HardForkSpecificNodeToNodeVersion
-&gt; HardForkSpecificNodeToNodeVersion
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: HardForkSpecificNodeToNodeVersion
-&gt; HardForkSpecificNodeToNodeVersion
-&gt; HardForkSpecificNodeToNodeVersion
$cmin :: HardForkSpecificNodeToNodeVersion
-&gt; HardForkSpecificNodeToNodeVersion
-&gt; HardForkSpecificNodeToNodeVersion
max :: HardForkSpecificNodeToNodeVersion
-&gt; HardForkSpecificNodeToNodeVersion
-&gt; HardForkSpecificNodeToNodeVersion
$cmax :: HardForkSpecificNodeToNodeVersion
-&gt; HardForkSpecificNodeToNodeVersion
-&gt; HardForkSpecificNodeToNodeVersion
&gt;= :: HardForkSpecificNodeToNodeVersion
-&gt; HardForkSpecificNodeToNodeVersion -&gt; Bool
$c&gt;= :: HardForkSpecificNodeToNodeVersion
-&gt; HardForkSpecificNodeToNodeVersion -&gt; Bool
&gt; :: HardForkSpecificNodeToNodeVersion
-&gt; HardForkSpecificNodeToNodeVersion -&gt; Bool
$c&gt; :: HardForkSpecificNodeToNodeVersion
-&gt; HardForkSpecificNodeToNodeVersion -&gt; Bool
&lt;= :: HardForkSpecificNodeToNodeVersion
-&gt; HardForkSpecificNodeToNodeVersion -&gt; Bool
$c&lt;= :: HardForkSpecificNodeToNodeVersion
-&gt; HardForkSpecificNodeToNodeVersion -&gt; Bool
&lt; :: HardForkSpecificNodeToNodeVersion
-&gt; HardForkSpecificNodeToNodeVersion -&gt; Bool
$c&lt; :: HardForkSpecificNodeToNodeVersion
-&gt; HardForkSpecificNodeToNodeVersion -&gt; Bool
compare :: HardForkSpecificNodeToNodeVersion
-&gt; HardForkSpecificNodeToNodeVersion -&gt; Ordering
$ccompare :: HardForkSpecificNodeToNodeVersion
-&gt; HardForkSpecificNodeToNodeVersion -&gt; Ordering
$cp1Ord :: Eq HardForkSpecificNodeToNodeVersion
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680057976"><span id="local-6989586621680057978"><span id="local-6989586621680057980"><span class="annot"><span class="annottext">Int -&gt; HardForkSpecificNodeToNodeVersion -&gt; ShowS
[HardForkSpecificNodeToNodeVersion] -&gt; ShowS
HardForkSpecificNodeToNodeVersion -&gt; String
(Int -&gt; HardForkSpecificNodeToNodeVersion -&gt; ShowS)
-&gt; (HardForkSpecificNodeToNodeVersion -&gt; String)
-&gt; ([HardForkSpecificNodeToNodeVersion] -&gt; ShowS)
-&gt; Show HardForkSpecificNodeToNodeVersion
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [HardForkSpecificNodeToNodeVersion] -&gt; ShowS
$cshowList :: [HardForkSpecificNodeToNodeVersion] -&gt; ShowS
show :: HardForkSpecificNodeToNodeVersion -&gt; String
$cshow :: HardForkSpecificNodeToNodeVersion -&gt; String
showsPrec :: Int -&gt; HardForkSpecificNodeToNodeVersion -&gt; ShowS
$cshowsPrec :: Int -&gt; HardForkSpecificNodeToNodeVersion -&gt; ShowS
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680057959"><span id="local-6989586621680057961"><span id="local-6989586621680057963"><span id="local-6989586621680057965"><span id="local-6989586621680057967"><span id="local-6989586621680057969"><span id="local-6989586621680057971"><span id="local-6989586621680057973"><span class="annot"><span class="annottext">Int -&gt; HardForkSpecificNodeToNodeVersion
HardForkSpecificNodeToNodeVersion -&gt; Int
HardForkSpecificNodeToNodeVersion
-&gt; [HardForkSpecificNodeToNodeVersion]
HardForkSpecificNodeToNodeVersion
-&gt; HardForkSpecificNodeToNodeVersion
HardForkSpecificNodeToNodeVersion
-&gt; HardForkSpecificNodeToNodeVersion
-&gt; [HardForkSpecificNodeToNodeVersion]
HardForkSpecificNodeToNodeVersion
-&gt; HardForkSpecificNodeToNodeVersion
-&gt; HardForkSpecificNodeToNodeVersion
-&gt; [HardForkSpecificNodeToNodeVersion]
(HardForkSpecificNodeToNodeVersion
 -&gt; HardForkSpecificNodeToNodeVersion)
-&gt; (HardForkSpecificNodeToNodeVersion
    -&gt; HardForkSpecificNodeToNodeVersion)
-&gt; (Int -&gt; HardForkSpecificNodeToNodeVersion)
-&gt; (HardForkSpecificNodeToNodeVersion -&gt; Int)
-&gt; (HardForkSpecificNodeToNodeVersion
    -&gt; [HardForkSpecificNodeToNodeVersion])
-&gt; (HardForkSpecificNodeToNodeVersion
    -&gt; HardForkSpecificNodeToNodeVersion
    -&gt; [HardForkSpecificNodeToNodeVersion])
-&gt; (HardForkSpecificNodeToNodeVersion
    -&gt; HardForkSpecificNodeToNodeVersion
    -&gt; [HardForkSpecificNodeToNodeVersion])
-&gt; (HardForkSpecificNodeToNodeVersion
    -&gt; HardForkSpecificNodeToNodeVersion
    -&gt; HardForkSpecificNodeToNodeVersion
    -&gt; [HardForkSpecificNodeToNodeVersion])
-&gt; Enum HardForkSpecificNodeToNodeVersion
forall a.
(a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Int -&gt; a)
-&gt; (a -&gt; Int)
-&gt; (a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; a -&gt; [a])
-&gt; Enum a
enumFromThenTo :: HardForkSpecificNodeToNodeVersion
-&gt; HardForkSpecificNodeToNodeVersion
-&gt; HardForkSpecificNodeToNodeVersion
-&gt; [HardForkSpecificNodeToNodeVersion]
$cenumFromThenTo :: HardForkSpecificNodeToNodeVersion
-&gt; HardForkSpecificNodeToNodeVersion
-&gt; HardForkSpecificNodeToNodeVersion
-&gt; [HardForkSpecificNodeToNodeVersion]
enumFromTo :: HardForkSpecificNodeToNodeVersion
-&gt; HardForkSpecificNodeToNodeVersion
-&gt; [HardForkSpecificNodeToNodeVersion]
$cenumFromTo :: HardForkSpecificNodeToNodeVersion
-&gt; HardForkSpecificNodeToNodeVersion
-&gt; [HardForkSpecificNodeToNodeVersion]
enumFromThen :: HardForkSpecificNodeToNodeVersion
-&gt; HardForkSpecificNodeToNodeVersion
-&gt; [HardForkSpecificNodeToNodeVersion]
$cenumFromThen :: HardForkSpecificNodeToNodeVersion
-&gt; HardForkSpecificNodeToNodeVersion
-&gt; [HardForkSpecificNodeToNodeVersion]
enumFrom :: HardForkSpecificNodeToNodeVersion
-&gt; [HardForkSpecificNodeToNodeVersion]
$cenumFrom :: HardForkSpecificNodeToNodeVersion
-&gt; [HardForkSpecificNodeToNodeVersion]
fromEnum :: HardForkSpecificNodeToNodeVersion -&gt; Int
$cfromEnum :: HardForkSpecificNodeToNodeVersion -&gt; Int
toEnum :: Int -&gt; HardForkSpecificNodeToNodeVersion
$ctoEnum :: Int -&gt; HardForkSpecificNodeToNodeVersion
pred :: HardForkSpecificNodeToNodeVersion
-&gt; HardForkSpecificNodeToNodeVersion
$cpred :: HardForkSpecificNodeToNodeVersion
-&gt; HardForkSpecificNodeToNodeVersion
succ :: HardForkSpecificNodeToNodeVersion
-&gt; HardForkSpecificNodeToNodeVersion
$csucc :: HardForkSpecificNodeToNodeVersion
-&gt; HardForkSpecificNodeToNodeVersion
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Enum</span></a></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680057954"><span id="local-6989586621680057956"><span class="annot"><span class="annottext">HardForkSpecificNodeToNodeVersion
HardForkSpecificNodeToNodeVersion
-&gt; HardForkSpecificNodeToNodeVersion
-&gt; Bounded HardForkSpecificNodeToNodeVersion
forall a. a -&gt; a -&gt; Bounded a
maxBound :: HardForkSpecificNodeToNodeVersion
$cmaxBound :: HardForkSpecificNodeToNodeVersion
minBound :: HardForkSpecificNodeToNodeVersion
$cminBound :: HardForkSpecificNodeToNodeVersion
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Bounded</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span class="hs-comment">-- | Versioning of the specific additions made by the HFC to the @NodeToClient@</span><span>
</span><span id="line-147"></span><span class="hs-comment">-- protocols, e.g., the era tag or the hard-fork specific queries.</span><span>
</span><span id="line-148"></span><span class="hs-keyword">data</span><span> </span><span id="HardForkSpecificNodeToClientVersion"><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#HardForkSpecificNodeToClientVersion"><span class="hs-identifier hs-var">HardForkSpecificNodeToClientVersion</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-149"></span><span>    </span><span id="HardForkSpecificNodeToClientVersion1"><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#HardForkSpecificNodeToClientVersion1"><span class="hs-identifier hs-var">HardForkSpecificNodeToClientVersion1</span></a></span></span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span>    </span><span class="hs-comment">-- | Enable the 'GetCurrentEra' query in 'QueryHardFork'.</span><span>
</span><span id="line-152"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="HardForkSpecificNodeToClientVersion2"><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#HardForkSpecificNodeToClientVersion2"><span class="hs-identifier hs-var">HardForkSpecificNodeToClientVersion2</span></a></span></span><span>
</span><span id="line-153"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680057947"><span id="local-6989586621680057949"><span class="annot"><span class="annottext">HardForkSpecificNodeToClientVersion
-&gt; HardForkSpecificNodeToClientVersion -&gt; Bool
(HardForkSpecificNodeToClientVersion
 -&gt; HardForkSpecificNodeToClientVersion -&gt; Bool)
-&gt; (HardForkSpecificNodeToClientVersion
    -&gt; HardForkSpecificNodeToClientVersion -&gt; Bool)
-&gt; Eq HardForkSpecificNodeToClientVersion
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: HardForkSpecificNodeToClientVersion
-&gt; HardForkSpecificNodeToClientVersion -&gt; Bool
$c/= :: HardForkSpecificNodeToClientVersion
-&gt; HardForkSpecificNodeToClientVersion -&gt; Bool
== :: HardForkSpecificNodeToClientVersion
-&gt; HardForkSpecificNodeToClientVersion -&gt; Bool
$c== :: HardForkSpecificNodeToClientVersion
-&gt; HardForkSpecificNodeToClientVersion -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680057932"><span id="local-6989586621680057934"><span id="local-6989586621680057936"><span id="local-6989586621680057938"><span id="local-6989586621680057940"><span id="local-6989586621680057942"><span id="local-6989586621680057944"><span class="annot"><span class="annottext">Eq HardForkSpecificNodeToClientVersion
Eq HardForkSpecificNodeToClientVersion
-&gt; (HardForkSpecificNodeToClientVersion
    -&gt; HardForkSpecificNodeToClientVersion -&gt; Ordering)
-&gt; (HardForkSpecificNodeToClientVersion
    -&gt; HardForkSpecificNodeToClientVersion -&gt; Bool)
-&gt; (HardForkSpecificNodeToClientVersion
    -&gt; HardForkSpecificNodeToClientVersion -&gt; Bool)
-&gt; (HardForkSpecificNodeToClientVersion
    -&gt; HardForkSpecificNodeToClientVersion -&gt; Bool)
-&gt; (HardForkSpecificNodeToClientVersion
    -&gt; HardForkSpecificNodeToClientVersion -&gt; Bool)
-&gt; (HardForkSpecificNodeToClientVersion
    -&gt; HardForkSpecificNodeToClientVersion
    -&gt; HardForkSpecificNodeToClientVersion)
-&gt; (HardForkSpecificNodeToClientVersion
    -&gt; HardForkSpecificNodeToClientVersion
    -&gt; HardForkSpecificNodeToClientVersion)
-&gt; Ord HardForkSpecificNodeToClientVersion
HardForkSpecificNodeToClientVersion
-&gt; HardForkSpecificNodeToClientVersion -&gt; Bool
HardForkSpecificNodeToClientVersion
-&gt; HardForkSpecificNodeToClientVersion -&gt; Ordering
HardForkSpecificNodeToClientVersion
-&gt; HardForkSpecificNodeToClientVersion
-&gt; HardForkSpecificNodeToClientVersion
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: HardForkSpecificNodeToClientVersion
-&gt; HardForkSpecificNodeToClientVersion
-&gt; HardForkSpecificNodeToClientVersion
$cmin :: HardForkSpecificNodeToClientVersion
-&gt; HardForkSpecificNodeToClientVersion
-&gt; HardForkSpecificNodeToClientVersion
max :: HardForkSpecificNodeToClientVersion
-&gt; HardForkSpecificNodeToClientVersion
-&gt; HardForkSpecificNodeToClientVersion
$cmax :: HardForkSpecificNodeToClientVersion
-&gt; HardForkSpecificNodeToClientVersion
-&gt; HardForkSpecificNodeToClientVersion
&gt;= :: HardForkSpecificNodeToClientVersion
-&gt; HardForkSpecificNodeToClientVersion -&gt; Bool
$c&gt;= :: HardForkSpecificNodeToClientVersion
-&gt; HardForkSpecificNodeToClientVersion -&gt; Bool
&gt; :: HardForkSpecificNodeToClientVersion
-&gt; HardForkSpecificNodeToClientVersion -&gt; Bool
$c&gt; :: HardForkSpecificNodeToClientVersion
-&gt; HardForkSpecificNodeToClientVersion -&gt; Bool
&lt;= :: HardForkSpecificNodeToClientVersion
-&gt; HardForkSpecificNodeToClientVersion -&gt; Bool
$c&lt;= :: HardForkSpecificNodeToClientVersion
-&gt; HardForkSpecificNodeToClientVersion -&gt; Bool
&lt; :: HardForkSpecificNodeToClientVersion
-&gt; HardForkSpecificNodeToClientVersion -&gt; Bool
$c&lt; :: HardForkSpecificNodeToClientVersion
-&gt; HardForkSpecificNodeToClientVersion -&gt; Bool
compare :: HardForkSpecificNodeToClientVersion
-&gt; HardForkSpecificNodeToClientVersion -&gt; Ordering
$ccompare :: HardForkSpecificNodeToClientVersion
-&gt; HardForkSpecificNodeToClientVersion -&gt; Ordering
$cp1Ord :: Eq HardForkSpecificNodeToClientVersion
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680057926"><span id="local-6989586621680057928"><span id="local-6989586621680057930"><span class="annot"><span class="annottext">Int -&gt; HardForkSpecificNodeToClientVersion -&gt; ShowS
[HardForkSpecificNodeToClientVersion] -&gt; ShowS
HardForkSpecificNodeToClientVersion -&gt; String
(Int -&gt; HardForkSpecificNodeToClientVersion -&gt; ShowS)
-&gt; (HardForkSpecificNodeToClientVersion -&gt; String)
-&gt; ([HardForkSpecificNodeToClientVersion] -&gt; ShowS)
-&gt; Show HardForkSpecificNodeToClientVersion
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [HardForkSpecificNodeToClientVersion] -&gt; ShowS
$cshowList :: [HardForkSpecificNodeToClientVersion] -&gt; ShowS
show :: HardForkSpecificNodeToClientVersion -&gt; String
$cshow :: HardForkSpecificNodeToClientVersion -&gt; String
showsPrec :: Int -&gt; HardForkSpecificNodeToClientVersion -&gt; ShowS
$cshowsPrec :: Int -&gt; HardForkSpecificNodeToClientVersion -&gt; ShowS
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680057910"><span id="local-6989586621680057912"><span id="local-6989586621680057914"><span id="local-6989586621680057916"><span id="local-6989586621680057918"><span id="local-6989586621680057920"><span id="local-6989586621680057922"><span id="local-6989586621680057924"><span class="annot"><span class="annottext">Int -&gt; HardForkSpecificNodeToClientVersion
HardForkSpecificNodeToClientVersion -&gt; Int
HardForkSpecificNodeToClientVersion
-&gt; [HardForkSpecificNodeToClientVersion]
HardForkSpecificNodeToClientVersion
-&gt; HardForkSpecificNodeToClientVersion
HardForkSpecificNodeToClientVersion
-&gt; HardForkSpecificNodeToClientVersion
-&gt; [HardForkSpecificNodeToClientVersion]
HardForkSpecificNodeToClientVersion
-&gt; HardForkSpecificNodeToClientVersion
-&gt; HardForkSpecificNodeToClientVersion
-&gt; [HardForkSpecificNodeToClientVersion]
(HardForkSpecificNodeToClientVersion
 -&gt; HardForkSpecificNodeToClientVersion)
-&gt; (HardForkSpecificNodeToClientVersion
    -&gt; HardForkSpecificNodeToClientVersion)
-&gt; (Int -&gt; HardForkSpecificNodeToClientVersion)
-&gt; (HardForkSpecificNodeToClientVersion -&gt; Int)
-&gt; (HardForkSpecificNodeToClientVersion
    -&gt; [HardForkSpecificNodeToClientVersion])
-&gt; (HardForkSpecificNodeToClientVersion
    -&gt; HardForkSpecificNodeToClientVersion
    -&gt; [HardForkSpecificNodeToClientVersion])
-&gt; (HardForkSpecificNodeToClientVersion
    -&gt; HardForkSpecificNodeToClientVersion
    -&gt; [HardForkSpecificNodeToClientVersion])
-&gt; (HardForkSpecificNodeToClientVersion
    -&gt; HardForkSpecificNodeToClientVersion
    -&gt; HardForkSpecificNodeToClientVersion
    -&gt; [HardForkSpecificNodeToClientVersion])
-&gt; Enum HardForkSpecificNodeToClientVersion
forall a.
(a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Int -&gt; a)
-&gt; (a -&gt; Int)
-&gt; (a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; a -&gt; [a])
-&gt; Enum a
enumFromThenTo :: HardForkSpecificNodeToClientVersion
-&gt; HardForkSpecificNodeToClientVersion
-&gt; HardForkSpecificNodeToClientVersion
-&gt; [HardForkSpecificNodeToClientVersion]
$cenumFromThenTo :: HardForkSpecificNodeToClientVersion
-&gt; HardForkSpecificNodeToClientVersion
-&gt; HardForkSpecificNodeToClientVersion
-&gt; [HardForkSpecificNodeToClientVersion]
enumFromTo :: HardForkSpecificNodeToClientVersion
-&gt; HardForkSpecificNodeToClientVersion
-&gt; [HardForkSpecificNodeToClientVersion]
$cenumFromTo :: HardForkSpecificNodeToClientVersion
-&gt; HardForkSpecificNodeToClientVersion
-&gt; [HardForkSpecificNodeToClientVersion]
enumFromThen :: HardForkSpecificNodeToClientVersion
-&gt; HardForkSpecificNodeToClientVersion
-&gt; [HardForkSpecificNodeToClientVersion]
$cenumFromThen :: HardForkSpecificNodeToClientVersion
-&gt; HardForkSpecificNodeToClientVersion
-&gt; [HardForkSpecificNodeToClientVersion]
enumFrom :: HardForkSpecificNodeToClientVersion
-&gt; [HardForkSpecificNodeToClientVersion]
$cenumFrom :: HardForkSpecificNodeToClientVersion
-&gt; [HardForkSpecificNodeToClientVersion]
fromEnum :: HardForkSpecificNodeToClientVersion -&gt; Int
$cfromEnum :: HardForkSpecificNodeToClientVersion -&gt; Int
toEnum :: Int -&gt; HardForkSpecificNodeToClientVersion
$ctoEnum :: Int -&gt; HardForkSpecificNodeToClientVersion
pred :: HardForkSpecificNodeToClientVersion
-&gt; HardForkSpecificNodeToClientVersion
$cpred :: HardForkSpecificNodeToClientVersion
-&gt; HardForkSpecificNodeToClientVersion
succ :: HardForkSpecificNodeToClientVersion
-&gt; HardForkSpecificNodeToClientVersion
$csucc :: HardForkSpecificNodeToClientVersion
-&gt; HardForkSpecificNodeToClientVersion
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Enum</span></a></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680057906"><span id="local-6989586621680057908"><span class="annot"><span class="annottext">HardForkSpecificNodeToClientVersion
HardForkSpecificNodeToClientVersion
-&gt; HardForkSpecificNodeToClientVersion
-&gt; Bounded HardForkSpecificNodeToClientVersion
forall a. a -&gt; a -&gt; Bounded a
maxBound :: HardForkSpecificNodeToClientVersion
$cmaxBound :: HardForkSpecificNodeToClientVersion
minBound :: HardForkSpecificNodeToClientVersion
$cminBound :: HardForkSpecificNodeToClientVersion
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Bounded</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span class="hs-keyword">data</span><span> </span><span id="HardForkNodeToNodeVersion"><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#HardForkNodeToNodeVersion"><span class="hs-identifier hs-var">HardForkNodeToNodeVersion</span></a></span></span><span> </span><span id="local-6989586621680057905"><span class="annot"><a href="#local-6989586621680057905"><span class="hs-identifier hs-type">xs</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-156"></span><span>  </span><span class="hs-comment">-- | Disable the HFC</span><span>
</span><span id="line-157"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-158"></span><span>  </span><span class="hs-comment">-- This means that only the first era (@x@) is supported, and moreover, is</span><span>
</span><span id="line-159"></span><span>  </span><span class="hs-comment">-- compatible with serialisation used if the HFC would not be present at all.</span><span>
</span><span id="line-160"></span><span>  </span><span id="local-6989586621680057903"><span id="local-6989586621680057904"><span id="HardForkNodeToNodeDisabled"><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#HardForkNodeToNodeDisabled"><span class="hs-identifier hs-var">HardForkNodeToNodeDisabled</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-161"></span><span>       </span><span class="annot"><a href="Ouroboros.Consensus.Node.NetworkProtocolVersion.html#BlockNodeToNodeVersion"><span class="hs-identifier hs-type">BlockNodeToNodeVersion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057904"><span class="hs-identifier hs-type">x</span></a></span><span>
</span><span id="line-162"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#HardForkNodeToNodeVersion"><span class="hs-identifier hs-type">HardForkNodeToNodeVersion</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680057904"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621680057903"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span>  </span><span class="hs-comment">-- | Enable the HFC</span><span>
</span><span id="line-165"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-166"></span><span>  </span><span class="hs-comment">-- Each era can be enabled or disabled individually by passing</span><span>
</span><span id="line-167"></span><span>  </span><span class="hs-comment">-- 'EraNodeToNodeDisabled' as its configuration, but serialised values will</span><span>
</span><span id="line-168"></span><span>  </span><span class="hs-comment">-- always include tags inserted by the HFC to distinguish one era from</span><span>
</span><span id="line-169"></span><span>  </span><span class="hs-comment">-- another. We also version the hard-fork specific parts with</span><span>
</span><span id="line-170"></span><span>  </span><span class="hs-comment">-- 'HardForkSpecificNodeToNodeVersion'.</span><span>
</span><span id="line-171"></span><span>  </span><span id="local-6989586621680057901"><span id="HardForkNodeToNodeEnabled"><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#HardForkNodeToNodeEnabled"><span class="hs-identifier hs-var">HardForkNodeToNodeEnabled</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-172"></span><span>       </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#HardForkSpecificNodeToNodeVersion"><span class="hs-identifier hs-type">HardForkSpecificNodeToNodeVersion</span></a></span><span>
</span><span id="line-173"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#NP"><span class="hs-identifier hs-type">NP</span></a></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#EraNodeToNodeVersion"><span class="hs-identifier hs-type">EraNodeToNodeVersion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057901"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-174"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#HardForkNodeToNodeVersion"><span class="hs-identifier hs-type">HardForkNodeToNodeVersion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057901"><span class="hs-identifier hs-type">xs</span></a></span></span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span class="hs-keyword">data</span><span> </span><span id="HardForkNodeToClientVersion"><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#HardForkNodeToClientVersion"><span class="hs-identifier hs-var">HardForkNodeToClientVersion</span></a></span></span><span> </span><span id="local-6989586621680057899"><span class="annot"><a href="#local-6989586621680057899"><span class="hs-identifier hs-type">xs</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-177"></span><span>  </span><span class="hs-comment">-- | Disable the HFC</span><span>
</span><span id="line-178"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-179"></span><span>  </span><span class="hs-comment">-- See 'HardForkNodeToNodeDisabled'</span><span>
</span><span id="line-180"></span><span>  </span><span id="local-6989586621680057897"><span id="local-6989586621680057898"><span id="HardForkNodeToClientDisabled"><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#HardForkNodeToClientDisabled"><span class="hs-identifier hs-var">HardForkNodeToClientDisabled</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-181"></span><span>       </span><span class="annot"><a href="Ouroboros.Consensus.Node.NetworkProtocolVersion.html#BlockNodeToClientVersion"><span class="hs-identifier hs-type">BlockNodeToClientVersion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057898"><span class="hs-identifier hs-type">x</span></a></span><span>
</span><span id="line-182"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#HardForkNodeToClientVersion"><span class="hs-identifier hs-type">HardForkNodeToClientVersion</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680057898"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621680057897"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-183"></span><span>
</span><span id="line-184"></span><span>  </span><span class="hs-comment">-- | Enable the HFC</span><span>
</span><span id="line-185"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-186"></span><span>  </span><span class="hs-comment">-- See 'HardForkNodeToNodeEnabled'</span><span>
</span><span id="line-187"></span><span>  </span><span id="local-6989586621680057895"><span id="HardForkNodeToClientEnabled"><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#HardForkNodeToClientEnabled"><span class="hs-identifier hs-var">HardForkNodeToClientEnabled</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-188"></span><span>       </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#HardForkSpecificNodeToClientVersion"><span class="hs-identifier hs-type">HardForkSpecificNodeToClientVersion</span></a></span><span>
</span><span id="line-189"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#NP"><span class="hs-identifier hs-type">NP</span></a></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#EraNodeToClientVersion"><span class="hs-identifier hs-type">EraNodeToClientVersion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057895"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-190"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#HardForkNodeToClientVersion"><span class="hs-identifier hs-type">HardForkNodeToClientVersion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057895"><span class="hs-identifier hs-type">xs</span></a></span></span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span class="hs-keyword">data</span><span> </span><span id="EraNodeToNodeVersion"><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#EraNodeToNodeVersion"><span class="hs-identifier hs-var">EraNodeToNodeVersion</span></a></span></span><span> </span><span id="local-6989586621680057893"><span class="annot"><a href="#local-6989586621680057893"><span class="hs-identifier hs-type">blk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-193"></span><span>    </span><span id="EraNodeToNodeEnabled"><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#EraNodeToNodeEnabled"><span class="hs-identifier hs-var">EraNodeToNodeEnabled</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Node.NetworkProtocolVersion.html#BlockNodeToNodeVersion"><span class="hs-identifier hs-type">BlockNodeToNodeVersion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057893"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-194"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="EraNodeToNodeDisabled"><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#EraNodeToNodeDisabled"><span class="hs-identifier hs-var">EraNodeToNodeDisabled</span></a></span></span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span class="hs-keyword">data</span><span> </span><span id="EraNodeToClientVersion"><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#EraNodeToClientVersion"><span class="hs-identifier hs-var">EraNodeToClientVersion</span></a></span></span><span> </span><span id="local-6989586621680057890"><span class="annot"><a href="#local-6989586621680057890"><span class="hs-identifier hs-type">blk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-197"></span><span>    </span><span id="EraNodeToClientEnabled"><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#EraNodeToClientEnabled"><span class="hs-identifier hs-var">EraNodeToClientEnabled</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Node.NetworkProtocolVersion.html#BlockNodeToClientVersion"><span class="hs-identifier hs-type">BlockNodeToClientVersion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057890"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-198"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="EraNodeToClientDisabled"><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#EraNodeToClientDisabled"><span class="hs-identifier hs-var">EraNodeToClientDisabled</span></a></span></span><span>
</span><span id="line-199"></span><span>
</span><span id="line-200"></span><span id="local-6989586621680057881"><span id="local-6989586621680057883"><span id="local-6989586621680057885"><span id="local-6989586621680057887"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Node.NetworkProtocolVersion.html#BlockNodeToNodeVersion"><span class="hs-identifier hs-type">BlockNodeToNodeVersion</span></a></span><span>   </span><span class="annot"><a href="#local-6989586621680057887"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#EraNodeToNodeVersion"><span class="hs-identifier hs-type">EraNodeToNodeVersion</span></a></span><span>   </span><span class="annot"><a href="#local-6989586621680057887"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-201"></span><span id="local-6989586621680057874"><span id="local-6989586621680057876"><span id="local-6989586621680057878"><span id="local-6989586621680057880"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Node.NetworkProtocolVersion.html#BlockNodeToClientVersion"><span class="hs-identifier hs-type">BlockNodeToClientVersion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057880"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#EraNodeToClientVersion"><span class="hs-identifier hs-type">EraNodeToClientVersion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057880"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-202"></span><span>
</span><span id="line-203"></span><span id="local-6989586621680057869"><span id="local-6989586621680057871"><span id="local-6989586621680057873"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Node.NetworkProtocolVersion.html#BlockNodeToNodeVersion"><span class="hs-identifier hs-type">BlockNodeToNodeVersion</span></a></span><span>   </span><span class="annot"><a href="#local-6989586621680057873"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#EraNodeToNodeVersion"><span class="hs-identifier hs-type">EraNodeToNodeVersion</span></a></span><span>   </span><span class="annot"><a href="#local-6989586621680057873"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-204"></span><span id="local-6989586621680057864"><span id="local-6989586621680057866"><span id="local-6989586621680057868"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Node.NetworkProtocolVersion.html#BlockNodeToClientVersion"><span class="hs-identifier hs-type">BlockNodeToClientVersion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057868"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#EraNodeToClientVersion"><span class="hs-identifier hs-type">EraNodeToClientVersion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057868"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span id="local-6989586621680057857"><span id="local-6989586621680057859"><span id="local-6989586621680057861"><span id="local-6989586621680057863"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#SerialiseHFC"><span class="hs-identifier hs-type">SerialiseHFC</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057863"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#HardForkNodeToNodeVersion"><span class="hs-identifier hs-type">HardForkNodeToNodeVersion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057863"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-207"></span><span id="local-6989586621680057850"><span id="local-6989586621680057852"><span id="local-6989586621680057854"><span id="local-6989586621680057856"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#SerialiseHFC"><span class="hs-identifier hs-type">SerialiseHFC</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057856"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#HardForkNodeToClientVersion"><span class="hs-identifier hs-type">HardForkNodeToClientVersion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057856"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span id="local-6989586621680057845"><span id="local-6989586621680057847"><span id="local-6989586621680057849"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#SerialiseHFC"><span class="hs-identifier hs-type">SerialiseHFC</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057849"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#HardForkNodeToNodeVersion"><span class="hs-identifier hs-type">HardForkNodeToNodeVersion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057849"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-210"></span><span id="local-6989586621680057840"><span id="local-6989586621680057842"><span id="local-6989586621680057844"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#SerialiseHFC"><span class="hs-identifier hs-type">SerialiseHFC</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057844"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#HardForkNodeToClientVersion"><span class="hs-identifier hs-type">HardForkNodeToClientVersion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057844"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-211"></span><span>
</span><span id="line-212"></span><span id="local-6989586621680057839"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#SerialiseHFC"><span class="hs-identifier hs-type">SerialiseHFC</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057839"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Node.NetworkProtocolVersion.html#HasNetworkProtocolVersion"><span class="hs-identifier hs-type">HasNetworkProtocolVersion</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Basics.html#HardForkBlock"><span class="hs-identifier hs-type">HardForkBlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057839"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-213"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="BlockNodeToNodeVersion"><span class="annot"><a href="Ouroboros.Consensus.Node.NetworkProtocolVersion.html#BlockNodeToNodeVersion"><span class="hs-identifier hs-var">BlockNodeToNodeVersion</span></a></span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Basics.html#HardForkBlock"><span class="hs-identifier hs-type">HardForkBlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057839"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#HardForkNodeToNodeVersion"><span class="hs-identifier hs-type">HardForkNodeToNodeVersion</span></a></span><span>   </span><span class="annot"><a href="#local-6989586621680057839"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-214"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="BlockNodeToClientVersion"><span class="annot"><a href="Ouroboros.Consensus.Node.NetworkProtocolVersion.html#BlockNodeToClientVersion"><span class="hs-identifier hs-var">BlockNodeToClientVersion</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Basics.html#HardForkBlock"><span class="hs-identifier hs-type">HardForkBlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057839"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#HardForkNodeToClientVersion"><span class="hs-identifier hs-type">HardForkNodeToClientVersion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057839"><span class="hs-identifier hs-type">xs</span></a></span></span><span>
</span><span id="line-215"></span><span>
</span><span id="line-216"></span><span id="local-6989586621680057833"><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#isHardForkNodeToNodeEnabled"><span class="hs-identifier hs-type">isHardForkNodeToNodeEnabled</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#HardForkNodeToNodeVersion"><span class="hs-identifier hs-type">HardForkNodeToNodeVersion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057833"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span></span><span>
</span><span id="line-217"></span><span id="isHardForkNodeToNodeEnabled"><span class="annot"><span class="annottext">isHardForkNodeToNodeEnabled :: HardForkNodeToNodeVersion xs -&gt; Bool
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#isHardForkNodeToNodeEnabled"><span class="hs-identifier hs-var hs-var">isHardForkNodeToNodeEnabled</span></a></span></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#HardForkNodeToNodeEnabled"><span class="hs-identifier hs-type">HardForkNodeToNodeEnabled</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-218"></span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#isHardForkNodeToNodeEnabled"><span class="hs-identifier hs-var">isHardForkNodeToNodeEnabled</span></a></span><span> </span><span class="annot"><span class="annottext">HardForkNodeToNodeVersion xs
</span><span class="hs-identifier">_</span></span><span>                            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-219"></span><span>
</span><span id="line-220"></span><span id="local-6989586621680057832"><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#isHardForkNodeToClientEnabled"><span class="hs-identifier hs-type">isHardForkNodeToClientEnabled</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#HardForkNodeToClientVersion"><span class="hs-identifier hs-type">HardForkNodeToClientVersion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057832"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span></span><span>
</span><span id="line-221"></span><span id="isHardForkNodeToClientEnabled"><span class="annot"><span class="annottext">isHardForkNodeToClientEnabled :: HardForkNodeToClientVersion xs -&gt; Bool
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#isHardForkNodeToClientEnabled"><span class="hs-identifier hs-var hs-var">isHardForkNodeToClientEnabled</span></a></span></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#HardForkNodeToClientEnabled"><span class="hs-identifier hs-type">HardForkNodeToClientEnabled</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-222"></span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#isHardForkNodeToClientEnabled"><span class="hs-identifier hs-var">isHardForkNodeToClientEnabled</span></a></span><span> </span><span class="annot"><span class="annottext">HardForkNodeToClientVersion xs
</span><span class="hs-identifier">_</span></span><span>                              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Conditions required by the HFC to support serialisation
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Abstract.SingleEraBlock.html#SingleEraBlock"><span class="hs-identifier hs-type">SingleEraBlock</span></a></span><span>                   </span><span class="annot"><a href="#local-6989586621680057831"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-229"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.ChainDB.Impl.Types.html#SerialiseDiskConstraints"><span class="hs-identifier hs-type">SerialiseDiskConstraints</span></a></span><span>         </span><span class="annot"><a href="#local-6989586621680057831"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-230"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Node.Run.html#SerialiseNodeToNodeConstraints"><span class="hs-identifier hs-type">SerialiseNodeToNodeConstraints</span></a></span><span>   </span><span class="annot"><a href="#local-6989586621680057831"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-231"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Node.Run.html#SerialiseNodeToClientConstraints"><span class="hs-identifier hs-type">SerialiseNodeToClientConstraints</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057831"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-232"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Node.NetworkProtocolVersion.html#HasNetworkProtocolVersion"><span class="hs-identifier hs-type">HasNetworkProtocolVersion</span></a></span><span>        </span><span class="annot"><a href="#local-6989586621680057831"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-233"></span><span>      </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="SerialiseConstraintsHFC"><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#SerialiseConstraintsHFC"><span class="hs-identifier hs-var">SerialiseConstraintsHFC</span></a></span></span><span>       </span><span id="local-6989586621680057831"><span class="annot"><a href="#local-6989586621680057831"><span class="hs-identifier hs-type">blk</span></a></span></span><span>
</span><span id="line-234"></span><span>
</span><span id="line-235"></span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#pSHFC"><span class="hs-identifier hs-type">pSHFC</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Proxy</span></a></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#SerialiseConstraintsHFC"><span class="hs-identifier hs-type">SerialiseConstraintsHFC</span></a></span><span>
</span><span id="line-236"></span><span id="pSHFC"><span class="annot"><span class="annottext">pSHFC :: Proxy SerialiseConstraintsHFC
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#pSHFC"><span class="hs-identifier hs-var hs-var">pSHFC</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy SerialiseConstraintsHFC
forall k (t :: k). Proxy t
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Proxy</span></a></span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span class="hs-comment">-- | Conditions required by the HFC to provide serialisation</span><span>
</span><span id="line-239"></span><span class="hs-comment">--</span><span>
</span><span id="line-240"></span><span class="hs-comment">-- NOTE: Compatibility between HFC enabled and disabled:</span><span>
</span><span id="line-241"></span><span class="hs-comment">--</span><span>
</span><span id="line-242"></span><span class="hs-comment">-- 1. Node-to-node and node-to-client communication is versioned. When the HFC</span><span>
</span><span id="line-243"></span><span class="hs-comment">--    is disabled, we default to the instances for the first era, and so</span><span>
</span><span id="line-244"></span><span class="hs-comment">--    compatibility is preserved by construction.</span><span>
</span><span id="line-245"></span><span class="hs-comment">--</span><span>
</span><span id="line-246"></span><span class="hs-comment">-- 2. On-disk storage is /not/ versioned, and here we make no attempt to be</span><span>
</span><span id="line-247"></span><span class="hs-comment">--    compatible between non-HFC and HFC deployments, /except/ for blocks: we</span><span>
</span><span id="line-248"></span><span class="hs-comment">--    define two methods 'encodeDiskHfcBlock' and 'decodeDiskHfcBlock' which</span><span>
</span><span id="line-249"></span><span class="hs-comment">--    are used for on-disk serialisation of blocks. These methods have</span><span>
</span><span id="line-250"></span><span class="hs-comment">--    defaults which can and probably should be used for deployments that use</span><span>
</span><span id="line-251"></span><span class="hs-comment">--    the HFC from the get-go, but for deployments that only later change to use</span><span>
</span><span id="line-252"></span><span class="hs-comment">--    the HFC these functions can be overriden to provide an on-disk storage</span><span>
</span><span id="line-253"></span><span class="hs-comment">--    format for HFC blocks that is compatible with the on-disk storage of</span><span>
</span><span id="line-254"></span><span class="hs-comment">--    blocks from the first era.</span><span>
</span><span id="line-255"></span><span class="hs-comment">--</span><span>
</span><span id="line-256"></span><span class="hs-comment">-- 3. The converse is NOT supported. Deployments that use the HFC from the start</span><span>
</span><span id="line-257"></span><span class="hs-comment">--    should not use 'HardForkNodeToNodeDisabled' and/or</span><span>
</span><span id="line-258"></span><span class="hs-comment">--    'HardForkNodeToClientDisabled'. Doing so would result in opposite</span><span>
</span><span id="line-259"></span><span class="hs-comment">--    compatibility problems: the on-disk block would include the HFC tag, but</span><span>
</span><span id="line-260"></span><span class="hs-comment">--    sending blocks with the HFC disabled suggests that that tag is unexpected.</span><span>
</span><span id="line-261"></span><span class="hs-comment">--    This would then lead to problems with binary streaming, and we do not</span><span>
</span><span id="line-262"></span><span class="hs-comment">--    currently provide any provisions to resolve these.</span><span>
</span><span id="line-263"></span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Abstract.CanHardFork.html#CanHardFork"><span class="hs-identifier hs-type">CanHardFork</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058575"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-264"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">All</span></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#SerialiseConstraintsHFC"><span class="hs-identifier hs-type">SerialiseConstraintsHFC</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058575"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-265"></span><span>        </span><span class="hs-comment">-- Required for HasNetworkProtocolVersion</span><span>
</span><span id="line-266"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">All</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Compose</span></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#EraNodeToNodeVersion"><span class="hs-identifier hs-type">EraNodeToNodeVersion</span></a></span><span class="hs-special">)</span><span>   </span><span class="annot"><a href="#local-6989586621680058575"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-267"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">All</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Compose</span></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Eq</span></a></span><span>   </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#EraNodeToNodeVersion"><span class="hs-identifier hs-type">EraNodeToNodeVersion</span></a></span><span class="hs-special">)</span><span>   </span><span class="annot"><a href="#local-6989586621680058575"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-268"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">All</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Compose</span></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#EraNodeToClientVersion"><span class="hs-identifier hs-type">EraNodeToClientVersion</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680058575"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-269"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">All</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Compose</span></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Eq</span></a></span><span>   </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#EraNodeToClientVersion"><span class="hs-identifier hs-type">EraNodeToClientVersion</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680058575"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-270"></span><span>        </span><span class="hs-comment">-- Required for 'encodeNestedCtxt'/'decodeNestedCtxt'</span><span>
</span><span id="line-271"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">All</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Storage.Serialisation.html#EncodeDiskDepIx"><span class="hs-identifier hs-type">EncodeDiskDepIx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Block.NestedContent.html#NestedCtxt"><span class="hs-identifier hs-type">NestedCtxt</span></a></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Block.Abstract.html#Header"><span class="hs-identifier hs-type">Header</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680058575"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-272"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">All</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Storage.Serialisation.html#DecodeDiskDepIx"><span class="hs-identifier hs-type">DecodeDiskDepIx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Block.NestedContent.html#NestedCtxt"><span class="hs-identifier hs-type">NestedCtxt</span></a></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Block.Abstract.html#Header"><span class="hs-identifier hs-type">Header</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680058575"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-273"></span><span>        </span><span class="hs-comment">-- Required for 'getHfcBinaryBlockInfo'</span><span>
</span><span id="line-274"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">All</span></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.Serialisation.html#HasBinaryBlockInfo"><span class="hs-identifier hs-type">HasBinaryBlockInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058575"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-275"></span><span>      </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="SerialiseHFC"><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#SerialiseHFC"><span class="hs-identifier hs-var">SerialiseHFC</span></a></span></span><span> </span><span id="local-6989586621680058575"><span class="annot"><a href="#local-6989586621680058575"><span class="hs-identifier hs-type">xs</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-276"></span><span>
</span><span id="line-277"></span><span>  </span><span id="encodeDiskHfcBlock"><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#encodeDiskHfcBlock"><span class="hs-identifier hs-type">encodeDiskHfcBlock</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Block.Abstract.html#CodecConfig"><span class="hs-identifier hs-type">CodecConfig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Basics.html#HardForkBlock"><span class="hs-identifier hs-type">HardForkBlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058575"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-278"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Basics.html#HardForkBlock"><span class="hs-identifier hs-type">HardForkBlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058575"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Encoding</span></span><span>
</span><span id="line-279"></span><span>  </span><span id="local-6989586621680057827"><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#encodeDiskHfcBlock"><span class="hs-identifier hs-var hs-var">encodeDiskHfcBlock</span></a></span><span> </span><span id="local-6989586621680057826"><span class="annot"><span class="annottext">CodecConfig (HardForkBlock xs)
</span><a href="#local-6989586621680057826"><span class="hs-identifier hs-var">cfg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-280"></span><span>        </span><span class="annot"><span class="annottext">NP (I -.-&gt; K Encoding) xs -&gt; NS I xs -&gt; Encoding
forall (xs :: [*]) (f :: * -&gt; *).
SListI xs =&gt;
NP (f -.-&gt; K Encoding) xs -&gt; NS f xs -&gt; Encoding
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#encodeNS"><span class="hs-identifier hs-var">encodeNS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy SerialiseConstraintsHFC
-&gt; (forall a.
    SerialiseConstraintsHFC a =&gt;
    CodecConfig a -&gt; (-.-&gt;) I (K Encoding) a)
-&gt; NP CodecConfig xs
-&gt; NP (I -.-&gt; K Encoding) xs
forall k l (h :: (k -&gt; *) -&gt; l -&gt; *) (c :: k -&gt; Constraint)
       (xs :: l) (proxy :: (k -&gt; Constraint) -&gt; *) (f :: k -&gt; *)
       (f' :: k -&gt; *).
(AllN (Prod h) c xs, HAp h) =&gt;
proxy c
-&gt; (forall (a :: k). c a =&gt; f a -&gt; f' a) -&gt; h f xs -&gt; h f' xs
</span><span class="hs-identifier hs-var">hcmap</span></span><span> </span><span class="annot"><span class="annottext">Proxy SerialiseConstraintsHFC
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#pSHFC"><span class="hs-identifier hs-var">pSHFC</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(I a -&gt; K Encoding a) -&gt; (-.-&gt;) I (K Encoding) a
forall k (f :: k -&gt; *) (a :: k) (f' :: k -&gt; *).
(f a -&gt; f' a) -&gt; (-.-&gt;) f f' a
</span><span class="hs-identifier hs-var">fn</span></span><span> </span><span class="annot"><span class="annottext">((I a -&gt; K Encoding a) -&gt; (-.-&gt;) I (K Encoding) a)
-&gt; (CodecConfig a -&gt; I a -&gt; K Encoding a)
-&gt; CodecConfig a
-&gt; (-.-&gt;) I (K Encoding) a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Encoding) -&gt; I a -&gt; K Encoding a
forall k a b (c :: k). (a -&gt; b) -&gt; I a -&gt; K b c
</span><span class="hs-identifier hs-var">mapIK</span></span><span> </span><span class="annot"><span class="annottext">((a -&gt; Encoding) -&gt; I a -&gt; K Encoding a)
-&gt; (CodecConfig a -&gt; a -&gt; Encoding)
-&gt; CodecConfig a
-&gt; I a
-&gt; K Encoding a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">CodecConfig a -&gt; a -&gt; Encoding
forall blk a. EncodeDisk blk a =&gt; CodecConfig blk -&gt; a -&gt; Encoding
</span><a href="Ouroboros.Consensus.Storage.Serialisation.html#encodeDisk"><span class="hs-identifier hs-var">encodeDisk</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NP CodecConfig xs
</span><a href="#local-6989586621680057821"><span class="hs-identifier hs-var">cfgs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-281"></span><span>      </span><span class="annot"><span class="annottext">(NS I xs -&gt; Encoding)
-&gt; (HardForkBlock xs -&gt; NS I xs) -&gt; HardForkBlock xs -&gt; Encoding
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OneEraBlock xs -&gt; NS I xs
forall (xs :: [*]). OneEraBlock xs -&gt; NS I xs
</span><a href="Ouroboros.Consensus.HardFork.Combinator.AcrossEras.html#getOneEraBlock"><span class="hs-identifier hs-var hs-var">getOneEraBlock</span></a></span><span> </span><span class="annot"><span class="annottext">(OneEraBlock xs -&gt; NS I xs)
-&gt; (HardForkBlock xs -&gt; OneEraBlock xs)
-&gt; HardForkBlock xs
-&gt; NS I xs
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">HardForkBlock xs -&gt; OneEraBlock xs
forall (xs :: [*]). HardForkBlock xs -&gt; OneEraBlock xs
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Basics.html#getHardForkBlock"><span class="hs-identifier hs-var hs-var">getHardForkBlock</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-282"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-283"></span><span>      </span><span id="local-6989586621680057821"><span class="annot"><span class="annottext">cfgs :: NP CodecConfig xs
</span><a href="#local-6989586621680057821"><span class="hs-identifier hs-var hs-var">cfgs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PerEraCodecConfig xs -&gt; NP CodecConfig xs
forall (xs :: [*]). PerEraCodecConfig xs -&gt; NP CodecConfig xs
</span><a href="Ouroboros.Consensus.HardFork.Combinator.AcrossEras.html#getPerEraCodecConfig"><span class="hs-identifier hs-var hs-var">getPerEraCodecConfig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodecConfig (HardForkBlock xs) -&gt; PerEraCodecConfig xs
forall (xs :: [*]).
CodecConfig (HardForkBlock xs) -&gt; PerEraCodecConfig xs
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Basics.html#hardForkCodecConfigPerEra"><span class="hs-identifier hs-var hs-var">hardForkCodecConfigPerEra</span></a></span><span> </span><span class="annot"><span class="annottext">CodecConfig (HardForkBlock xs)
</span><a href="#local-6989586621680057826"><span class="hs-identifier hs-var">cfg</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-284"></span><span>
</span><span id="line-285"></span><span>  </span><span id="decodeDiskHfcBlock"><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#decodeDiskHfcBlock"><span class="hs-identifier hs-type">decodeDiskHfcBlock</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Block.Abstract.html#CodecConfig"><span class="hs-identifier hs-type">CodecConfig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Basics.html#HardForkBlock"><span class="hs-identifier hs-type">HardForkBlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058575"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-286"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680058544"><span class="annot"><a href="#local-6989586621680058544"><span class="hs-identifier hs-type">s</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Decoder</span></span><span> </span><span class="annot"><a href="#local-6989586621680058544"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/bytestring-0.10.12.0/src"><span class="hs-identifier hs-type">Lazy.ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Basics.html#HardForkBlock"><span class="hs-identifier hs-type">HardForkBlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058575"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-287"></span><span>  </span><span id="local-6989586621680057815"><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#decodeDiskHfcBlock"><span class="hs-identifier hs-var hs-var">decodeDiskHfcBlock</span></a></span><span> </span><span id="local-6989586621680057814"><span class="annot"><span class="annottext">CodecConfig (HardForkBlock xs)
</span><a href="#local-6989586621680057814"><span class="hs-identifier hs-var">cfg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-288"></span><span>        </span><span class="annot"><span class="annottext">((ByteString -&gt; NS I xs) -&gt; ByteString -&gt; HardForkBlock xs)
-&gt; Decoder s (ByteString -&gt; NS I xs)
-&gt; Decoder s (ByteString -&gt; HardForkBlock xs)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680057813"><span class="annot"><span class="annottext">ByteString -&gt; NS I xs
</span><a href="#local-6989586621680057813"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">OneEraBlock xs -&gt; HardForkBlock xs
forall (xs :: [*]). OneEraBlock xs -&gt; HardForkBlock xs
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Basics.html#HardForkBlock"><span class="hs-identifier hs-var">HardForkBlock</span></a></span><span> </span><span class="annot"><span class="annottext">(OneEraBlock xs -&gt; HardForkBlock xs)
-&gt; (ByteString -&gt; OneEraBlock xs) -&gt; ByteString -&gt; HardForkBlock xs
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">NS I xs -&gt; OneEraBlock xs
forall (xs :: [*]). NS I xs -&gt; OneEraBlock xs
</span><a href="Ouroboros.Consensus.HardFork.Combinator.AcrossEras.html#OneEraBlock"><span class="hs-identifier hs-var">OneEraBlock</span></a></span><span> </span><span class="annot"><span class="annottext">(NS I xs -&gt; OneEraBlock xs)
-&gt; (ByteString -&gt; NS I xs) -&gt; ByteString -&gt; OneEraBlock xs
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; NS I xs
</span><a href="#local-6989586621680057813"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-289"></span><span>      </span><span class="annot"><span class="annottext">(Decoder s (ByteString -&gt; NS I xs)
 -&gt; Decoder s (ByteString -&gt; HardForkBlock xs))
-&gt; Decoder s (ByteString -&gt; NS I xs)
-&gt; Decoder s (ByteString -&gt; HardForkBlock xs)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">NP (AnnDecoder I) xs -&gt; forall s. Decoder s (ByteString -&gt; NS I xs)
forall (xs :: [*]) (f :: * -&gt; *).
SListI xs =&gt;
NP (AnnDecoder f) xs -&gt; forall s. Decoder s (ByteString -&gt; NS f xs)
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#decodeAnnNS"><span class="hs-identifier hs-var">decodeAnnNS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy SerialiseConstraintsHFC
-&gt; (forall a.
    SerialiseConstraintsHFC a =&gt;
    CodecConfig a -&gt; AnnDecoder I a)
-&gt; NP CodecConfig xs
-&gt; NP (AnnDecoder I) xs
forall k l (h :: (k -&gt; *) -&gt; l -&gt; *) (c :: k -&gt; Constraint)
       (xs :: l) (proxy :: (k -&gt; Constraint) -&gt; *) (f :: k -&gt; *)
       (f' :: k -&gt; *).
(AllN (Prod h) c xs, HAp h) =&gt;
proxy c
-&gt; (forall (a :: k). c a =&gt; f a -&gt; f' a) -&gt; h f xs -&gt; h f' xs
</span><span class="hs-identifier hs-var">hcmap</span></span><span> </span><span class="annot"><span class="annottext">Proxy SerialiseConstraintsHFC
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#pSHFC"><span class="hs-identifier hs-var">pSHFC</span></a></span><span> </span><span class="annot"><span class="annottext">forall blk.
SerialiseDiskConstraints blk =&gt;
CodecConfig blk -&gt; AnnDecoder I blk
forall a.
SerialiseConstraintsHFC a =&gt;
CodecConfig a -&gt; AnnDecoder I a
</span><a href="#local-6989586621680057810"><span class="hs-identifier hs-var">aux</span></a></span><span> </span><span class="annot"><span class="annottext">NP CodecConfig xs
</span><a href="#local-6989586621680057809"><span class="hs-identifier hs-var">cfgs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-290"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-291"></span><span>      </span><span id="local-6989586621680057809"><span class="annot"><span class="annottext">cfgs :: NP CodecConfig xs
</span><a href="#local-6989586621680057809"><span class="hs-identifier hs-var hs-var">cfgs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PerEraCodecConfig xs -&gt; NP CodecConfig xs
forall (xs :: [*]). PerEraCodecConfig xs -&gt; NP CodecConfig xs
</span><a href="Ouroboros.Consensus.HardFork.Combinator.AcrossEras.html#getPerEraCodecConfig"><span class="hs-identifier hs-var hs-var">getPerEraCodecConfig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodecConfig (HardForkBlock xs) -&gt; PerEraCodecConfig xs
forall (xs :: [*]).
CodecConfig (HardForkBlock xs) -&gt; PerEraCodecConfig xs
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Basics.html#hardForkCodecConfigPerEra"><span class="hs-identifier hs-var hs-var">hardForkCodecConfigPerEra</span></a></span><span> </span><span class="annot"><span class="annottext">CodecConfig (HardForkBlock xs)
</span><a href="#local-6989586621680057814"><span class="hs-identifier hs-var">cfg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-292"></span><span>
</span><span id="line-293"></span><span>      </span><span id="local-6989586621680058530"><span class="annot"><a href="#local-6989586621680057810"><span class="hs-identifier hs-type">aux</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.ChainDB.Impl.Types.html#SerialiseDiskConstraints"><span class="hs-identifier hs-type">SerialiseDiskConstraints</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058530"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-294"></span><span>          </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Block.Abstract.html#CodecConfig"><span class="hs-identifier hs-type">CodecConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058530"><span class="hs-identifier hs-type">blk</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#AnnDecoder"><span class="hs-identifier hs-type">AnnDecoder</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">I</span></span><span> </span><span class="annot"><a href="#local-6989586621680058530"><span class="hs-identifier hs-type">blk</span></a></span></span><span>
</span><span id="line-295"></span><span>      </span><span id="local-6989586621680057810"><span class="annot"><span class="annottext">aux :: CodecConfig blk -&gt; AnnDecoder I blk
</span><a href="#local-6989586621680057810"><span class="hs-identifier hs-var hs-var">aux</span></a></span></span><span> </span><span id="local-6989586621680057808"><span class="annot"><span class="annottext">CodecConfig blk
</span><a href="#local-6989586621680057808"><span class="hs-identifier hs-var">cfg'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. Decoder s (ByteString -&gt; I blk)) -&gt; AnnDecoder I blk
forall (f :: * -&gt; *) blk.
(forall s. Decoder s (ByteString -&gt; f blk)) -&gt; AnnDecoder f blk
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#AnnDecoder"><span class="hs-identifier hs-var">AnnDecoder</span></a></span><span> </span><span class="annot"><span class="annottext">((forall s. Decoder s (ByteString -&gt; I blk)) -&gt; AnnDecoder I blk)
-&gt; (forall s. Decoder s (ByteString -&gt; I blk)) -&gt; AnnDecoder I blk
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680057806"><span class="annot"><span class="annottext">ByteString -&gt; blk
</span><a href="#local-6989586621680057806"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">blk -&gt; I blk
forall a. a -&gt; I a
</span><span class="hs-identifier hs-var">I</span></span><span> </span><span class="annot"><span class="annottext">(blk -&gt; I blk) -&gt; (ByteString -&gt; blk) -&gt; ByteString -&gt; I blk
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; blk
</span><a href="#local-6989586621680057806"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((ByteString -&gt; blk) -&gt; ByteString -&gt; I blk)
-&gt; Decoder s (ByteString -&gt; blk) -&gt; Decoder s (ByteString -&gt; I blk)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">CodecConfig blk -&gt; forall s. Decoder s (ByteString -&gt; blk)
forall blk a.
DecodeDisk blk a =&gt;
CodecConfig blk -&gt; forall s. Decoder s a
</span><a href="Ouroboros.Consensus.Storage.Serialisation.html#decodeDisk"><span class="hs-identifier hs-var">decodeDisk</span></a></span><span> </span><span class="annot"><span class="annottext">CodecConfig blk
</span><a href="#local-6989586621680057808"><span class="hs-identifier hs-var">cfg'</span></a></span><span>
</span><span id="line-296"></span><span>
</span><span id="line-297"></span><span>  </span><span class="hs-comment">-- | Used as the implementation of 'reconstructPrefixLen' for</span><span>
</span><span id="line-298"></span><span>  </span><span class="hs-comment">-- 'HardForkBlock'.</span></span><span>
</span><span id="line-299"></span><span>  </span><span id="local-6989586621680057802"><span id="reconstructHfcPrefixLen"><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#reconstructHfcPrefixLen"><span class="hs-identifier hs-type">reconstructHfcPrefixLen</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621680057802"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Block.Abstract.html#Header"><span class="hs-identifier hs-type">Header</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Basics.html#HardForkBlock"><span class="hs-identifier hs-type">HardForkBlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058575"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#PrefixLen"><span class="hs-identifier hs-type">PrefixLen</span></a></span></span><span>
</span><span id="line-300"></span><span>  </span><span id="local-6989586621680057800"><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#reconstructHfcPrefixLen"><span class="hs-identifier hs-var hs-var">reconstructHfcPrefixLen</span></a></span><span> </span><span class="annot"><span class="annottext">proxy (Header (HardForkBlock xs))
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-301"></span><span>      </span><span class="hs-comment">-- We insert two bytes at the front</span><span>
</span><span id="line-302"></span><span>      </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; PrefixLen -&gt; PrefixLen
</span><a href="Ouroboros.Consensus.Storage.Common.html#addPrefixLen"><span class="hs-operator hs-var">`addPrefixLen`</span></a></span><span> </span><span class="annot"><span class="annottext">[PrefixLen] -&gt; PrefixLen
forall (t :: * -&gt; *) a. (Foldable t, Ord a) =&gt; t a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">maximum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NP (K PrefixLen) xs -&gt; CollapseTo NP PrefixLen
forall k l (h :: (k -&gt; *) -&gt; l -&gt; *) (xs :: l) a.
(HCollapse h, SListIN h xs) =&gt;
h (K a) xs -&gt; CollapseTo h a
</span><span class="hs-identifier hs-var">hcollapse</span></span><span> </span><span class="annot"><span class="annottext">NP (K PrefixLen) xs
</span><a href="#local-6989586621680057796"><span class="hs-identifier hs-var">perEra</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-303"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-304"></span><span>      </span><span class="annot"><a href="#local-6989586621680057796"><span class="hs-identifier hs-type">perEra</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#NP"><span class="hs-identifier hs-type">NP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">K</span></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#PrefixLen"><span class="hs-identifier hs-type">PrefixLen</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680058575"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-305"></span><span>      </span><span id="local-6989586621680057796"><span class="annot"><span class="annottext">perEra :: NP (K PrefixLen) xs
</span><a href="#local-6989586621680057796"><span class="hs-identifier hs-var hs-var">perEra</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy SingleEraBlock
-&gt; (forall a. SingleEraBlock a =&gt; K PrefixLen a)
-&gt; NP (K PrefixLen) xs
forall k l (h :: (k -&gt; *) -&gt; l -&gt; *) (c :: k -&gt; Constraint)
       (xs :: l) (proxy :: (k -&gt; Constraint) -&gt; *) (f :: k -&gt; *).
(HPure h, AllN h c xs) =&gt;
proxy c -&gt; (forall (a :: k). c a =&gt; f a) -&gt; h f xs
</span><span class="hs-identifier hs-var">hcpure</span></span><span> </span><span class="annot"><span class="annottext">Proxy SingleEraBlock
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Abstract.SingleEraBlock.html#proxySingle"><span class="hs-identifier hs-var">proxySingle</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. SingleEraBlock a =&gt; K PrefixLen a
</span><a href="#local-6989586621680057794"><span class="hs-identifier hs-var">reconstructOne</span></a></span><span>
</span><span id="line-306"></span><span>
</span><span id="line-307"></span><span>      </span><span class="annot"><a href="#local-6989586621680057794"><span class="hs-identifier hs-type">reconstructOne</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680057793"><span class="annot"><a href="#local-6989586621680057793"><span class="hs-identifier hs-type">blk</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Abstract.SingleEraBlock.html#SingleEraBlock"><span class="hs-identifier hs-type">SingleEraBlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057793"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-308"></span><span>                     </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">K</span></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#PrefixLen"><span class="hs-identifier hs-type">PrefixLen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057793"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-309"></span><span>      </span><span id="local-6989586621680057794"><span class="annot"><span class="annottext">reconstructOne :: K PrefixLen blk
</span><a href="#local-6989586621680057794"><span class="hs-identifier hs-var hs-var">reconstructOne</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrefixLen -&gt; K PrefixLen blk
forall k a (b :: k). a -&gt; K a b
</span><span class="hs-identifier hs-var">K</span></span><span> </span><span class="annot"><span class="annottext">(PrefixLen -&gt; K PrefixLen blk) -&gt; PrefixLen -&gt; K PrefixLen blk
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy (Header blk) -&gt; PrefixLen
forall (f :: * -&gt; *) blk (proxy :: * -&gt; *).
ReconstructNestedCtxt f blk =&gt;
proxy (f blk) -&gt; PrefixLen
</span><a href="Ouroboros.Consensus.Storage.Serialisation.html#reconstructPrefixLen"><span class="hs-identifier hs-var">reconstructPrefixLen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy (Header blk)
forall k (t :: k). Proxy t
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Block.Abstract.html#Header"><span class="hs-identifier hs-type">Header</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057793"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-310"></span><span>
</span><span id="line-311"></span><span>  </span><span class="hs-comment">-- | Used as the implementation of 'reconstructNestedCtxt' for</span><span>
</span><span id="line-312"></span><span>  </span><span class="hs-comment">-- 'HardForkBlock'.</span></span><span>
</span><span id="line-313"></span><span>  </span><span id="local-6989586621680057790"><span id="reconstructHfcNestedCtxt"><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#reconstructHfcNestedCtxt"><span class="hs-identifier hs-type">reconstructHfcNestedCtxt</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-314"></span><span>       </span><span class="annot"><a href="#local-6989586621680057790"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Block.Abstract.html#Header"><span class="hs-identifier hs-type">Header</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Basics.html#HardForkBlock"><span class="hs-identifier hs-type">HardForkBlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058575"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-315"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/bytestring-0.10.12.0/src"><span class="hs-identifier hs-type">ShortByteString</span></a></span><span>  </span><span class="hs-comment">-- ^ First bytes ('reconstructPrefixLen') of the block</span><span>
</span><span id="line-316"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.7/ouroboros-network-api-0.1.0.0/noopt/doc/html/ouroboros-network-api/src"><span class="hs-identifier hs-type">SizeInBytes</span></a></span><span>      </span><span class="hs-comment">-- ^ Block size</span><span>
</span><span id="line-317"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Util.html#SomeSecond"><span class="hs-identifier hs-type">SomeSecond</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Block.NestedContent.html#NestedCtxt"><span class="hs-identifier hs-type">NestedCtxt</span></a></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Block.Abstract.html#Header"><span class="hs-identifier hs-type">Header</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Basics.html#HardForkBlock"><span class="hs-identifier hs-type">HardForkBlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058575"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-318"></span><span>  </span><span id="local-6989586621680057788"><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#reconstructHfcNestedCtxt"><span class="hs-identifier hs-var hs-var">reconstructHfcNestedCtxt</span></a></span><span> </span><span class="annot"><span class="annottext">proxy (Header (HardForkBlock xs))
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680057787"><span class="annot"><span class="annottext">ShortByteString
</span><a href="#local-6989586621680057787"><span class="hs-identifier hs-var">prefix</span></a></span></span><span> </span><span id="local-6989586621680057786"><span class="annot"><span class="annottext">SizeInBytes
</span><a href="#local-6989586621680057786"><span class="hs-identifier hs-var">blockSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-319"></span><span>     </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Maybe (NS (K ()) xs)
forall k (xs :: [k]). SListI xs =&gt; Word8 -&gt; Maybe (NS (K ()) xs)
</span><a href="Ouroboros.Consensus.Util.SOP.html#nsFromIndex"><span class="hs-identifier hs-var">nsFromIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621680057784"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-320"></span><span>       </span><span class="annot"><span class="annottext">Maybe (NS (K ()) xs)
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SomeSecond (NestedCtxt Header) (HardForkBlock xs)
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; SomeSecond (NestedCtxt Header) (HardForkBlock xs))
-&gt; String -&gt; SomeSecond (NestedCtxt Header) (HardForkBlock xs)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;invalid HardForkBlock with tag: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621680057784"><span class="hs-identifier hs-var">tag</span></a></span><span>
</span><span id="line-321"></span><span>       </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680057781"><span class="annot"><span class="annottext">NS (K ()) xs
</span><a href="#local-6989586621680057781"><span class="hs-identifier hs-var">ns</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NS (SomeSecond (NestedCtxt Header)) xs
-&gt; SomeSecond (NestedCtxt Header) (HardForkBlock xs)
forall (xs' :: [*]).
NS (SomeSecond (NestedCtxt Header)) xs'
-&gt; SomeSecond (NestedCtxt Header) (HardForkBlock xs')
</span><a href="#local-6989586621680057780"><span class="hs-identifier hs-var">injSomeSecond</span></a></span><span> </span><span class="annot"><span class="annottext">(NS (SomeSecond (NestedCtxt Header)) xs
 -&gt; SomeSecond (NestedCtxt Header) (HardForkBlock xs))
-&gt; NS (SomeSecond (NestedCtxt Header)) xs
-&gt; SomeSecond (NestedCtxt Header) (HardForkBlock xs)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy SingleEraBlock
-&gt; (forall a.
    SingleEraBlock a =&gt;
    K () a -&gt; SomeSecond (NestedCtxt Header) a)
-&gt; NS (K ()) xs
-&gt; NS (SomeSecond (NestedCtxt Header)) xs
forall k l (h :: (k -&gt; *) -&gt; l -&gt; *) (c :: k -&gt; Constraint)
       (xs :: l) (proxy :: (k -&gt; Constraint) -&gt; *) (f :: k -&gt; *)
       (f' :: k -&gt; *).
(AllN (Prod h) c xs, HAp h) =&gt;
proxy c
-&gt; (forall (a :: k). c a =&gt; f a -&gt; f' a) -&gt; h f xs -&gt; h f' xs
</span><span class="hs-identifier hs-var">hcmap</span></span><span> </span><span class="annot"><span class="annottext">Proxy SingleEraBlock
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Abstract.SingleEraBlock.html#proxySingle"><span class="hs-identifier hs-var">proxySingle</span></a></span><span> </span><span class="annot"><span class="annottext">forall a.
SingleEraBlock a =&gt;
K () a -&gt; SomeSecond (NestedCtxt Header) a
</span><a href="#local-6989586621680057779"><span class="hs-identifier hs-var">reconstructOne</span></a></span><span> </span><span class="annot"><span class="annottext">NS (K ()) xs
</span><a href="#local-6989586621680057781"><span class="hs-identifier hs-var">ns</span></a></span><span>
</span><span id="line-322"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-323"></span><span>      </span><span class="annot"><a href="#local-6989586621680057784"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Word8</span></a></span><span>
</span><span id="line-324"></span><span>      </span><span id="local-6989586621680057784"><span class="annot"><span class="annottext">tag :: Word8
</span><a href="#local-6989586621680057784"><span class="hs-identifier hs-var hs-var">tag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShortByteString -&gt; Int -&gt; Word8
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/bytestring-0.10.12.0/src"><span class="hs-identifier hs-var">Short.index</span></a></span><span> </span><span class="annot"><span class="annottext">ShortByteString
</span><a href="#local-6989586621680057787"><span class="hs-identifier hs-var">prefix</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-325"></span><span>
</span><span id="line-326"></span><span>      </span><span class="annot"><a href="#local-6989586621680057777"><span class="hs-identifier hs-type">prefixOne</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/bytestring-0.10.12.0/src"><span class="hs-identifier hs-type">ShortByteString</span></a></span><span>
</span><span id="line-327"></span><span>      </span><span id="local-6989586621680057777"><span class="annot"><span class="annottext">prefixOne :: ShortByteString
</span><a href="#local-6989586621680057777"><span class="hs-identifier hs-var hs-var">prefixOne</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Word8] -&gt; ShortByteString
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/bytestring-0.10.12.0/src"><span class="hs-identifier hs-var">Short.pack</span></a></span><span> </span><span class="annot"><span class="annottext">([Word8] -&gt; ShortByteString)
-&gt; (ShortByteString -&gt; [Word8])
-&gt; ShortByteString
-&gt; ShortByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Word8] -&gt; [Word8]
forall a. Int -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">drop</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">([Word8] -&gt; [Word8])
-&gt; (ShortByteString -&gt; [Word8]) -&gt; ShortByteString -&gt; [Word8]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ShortByteString -&gt; [Word8]
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/bytestring-0.10.12.0/src"><span class="hs-identifier hs-var">Short.unpack</span></a></span><span> </span><span class="annot"><span class="annottext">(ShortByteString -&gt; ShortByteString)
-&gt; ShortByteString -&gt; ShortByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ShortByteString
</span><a href="#local-6989586621680057787"><span class="hs-identifier hs-var">prefix</span></a></span><span>
</span><span id="line-328"></span><span>
</span><span id="line-329"></span><span>      </span><span class="annot"><a href="#local-6989586621680057779"><span class="hs-identifier hs-type">reconstructOne</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680057773"><span class="annot"><a href="#local-6989586621680057773"><span class="hs-identifier hs-type">blk</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Abstract.SingleEraBlock.html#SingleEraBlock"><span class="hs-identifier hs-type">SingleEraBlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057773"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-330"></span><span>                     </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">K</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680057773"><span class="hs-identifier hs-type">blk</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Util.html#SomeSecond"><span class="hs-identifier hs-type">SomeSecond</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Block.NestedContent.html#NestedCtxt"><span class="hs-identifier hs-type">NestedCtxt</span></a></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Block.Abstract.html#Header"><span class="hs-identifier hs-type">Header</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680057773"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-331"></span><span>      </span><span id="local-6989586621680057779"><span class="annot"><span class="annottext">reconstructOne :: K () blk -&gt; SomeSecond (NestedCtxt Header) blk
</span><a href="#local-6989586621680057779"><span class="hs-identifier hs-var hs-var">reconstructOne</span></a></span></span><span> </span><span class="annot"><span class="annottext">K () blk
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-332"></span><span>          </span><span class="annot"><span class="annottext">Proxy (Header blk)
-&gt; ShortByteString
-&gt; SizeInBytes
-&gt; SomeSecond (NestedCtxt Header) blk
forall (f :: * -&gt; *) blk (proxy :: * -&gt; *).
ReconstructNestedCtxt f blk =&gt;
proxy (f blk)
-&gt; ShortByteString -&gt; SizeInBytes -&gt; SomeSecond (NestedCtxt f) blk
</span><a href="Ouroboros.Consensus.Storage.Serialisation.html#reconstructNestedCtxt"><span class="hs-identifier hs-var">reconstructNestedCtxt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy (Header blk)
forall k (t :: k). Proxy t
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Block.Abstract.html#Header"><span class="hs-identifier hs-type">Header</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057773"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ShortByteString
</span><a href="#local-6989586621680057777"><span class="hs-identifier hs-var">prefixOne</span></a></span><span> </span><span class="annot"><span class="annottext">SizeInBytes
</span><a href="#local-6989586621680057786"><span class="hs-identifier hs-var">blockSize</span></a></span><span>
</span><span id="line-333"></span><span>
</span><span id="line-334"></span><span>      </span><span id="local-6989586621680058474"><span class="annot"><a href="#local-6989586621680057780"><span class="hs-identifier hs-type">injSomeSecond</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#NS"><span class="hs-identifier hs-type">NS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Util.html#SomeSecond"><span class="hs-identifier hs-type">SomeSecond</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Block.NestedContent.html#NestedCtxt"><span class="hs-identifier hs-type">NestedCtxt</span></a></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Block.Abstract.html#Header"><span class="hs-identifier hs-type">Header</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680058474"><span class="hs-identifier hs-type">xs'</span></a></span><span>
</span><span id="line-335"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Util.html#SomeSecond"><span class="hs-identifier hs-type">SomeSecond</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Block.NestedContent.html#NestedCtxt"><span class="hs-identifier hs-type">NestedCtxt</span></a></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Block.Abstract.html#Header"><span class="hs-identifier hs-type">Header</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Basics.html#HardForkBlock"><span class="hs-identifier hs-type">HardForkBlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058474"><span class="hs-identifier hs-type">xs'</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-336"></span><span>      </span><span id="local-6989586621680057780"><span class="annot"><span class="annottext">injSomeSecond :: NS (SomeSecond (NestedCtxt Header)) xs'
-&gt; SomeSecond (NestedCtxt Header) (HardForkBlock xs')
</span><a href="#local-6989586621680057780"><span class="hs-identifier hs-var hs-var">injSomeSecond</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Strict.html#Z"><span class="hs-identifier hs-type">Z</span></a></span><span> </span><span id="local-6989586621680057771"><span class="annot"><span class="annottext">SomeSecond (NestedCtxt Header) x
</span><a href="#local-6989586621680057771"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SomeSecond (NestedCtxt Header) x
</span><a href="#local-6989586621680057771"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-337"></span><span>          </span><span class="annot"><a href="Ouroboros.Consensus.Util.html#SomeSecond"><span class="hs-identifier hs-type">SomeSecond</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Block.NestedContent.html#NestedCtxt"><span class="hs-identifier hs-type">NestedCtxt</span></a></span><span> </span><span id="local-6989586621680057768"><span class="annot"><span class="annottext">NestedCtxt_ x Header b
</span><a href="#local-6989586621680057768"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NestedCtxt Header (HardForkBlock (x : xs)) b
-&gt; SomeSecond (NestedCtxt Header) (HardForkBlock (x : xs))
forall (f :: * -&gt; * -&gt; *) a b. f a b -&gt; SomeSecond f a
</span><a href="Ouroboros.Consensus.Util.html#SomeSecond"><span class="hs-identifier hs-var">SomeSecond</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NestedCtxt_ (HardForkBlock (x : xs)) Header b
-&gt; NestedCtxt Header (HardForkBlock (x : xs)) b
forall (f :: * -&gt; *) blk a.
NestedCtxt_ blk f a -&gt; NestedCtxt f blk a
</span><a href="Ouroboros.Consensus.Block.NestedContent.html#NestedCtxt"><span class="hs-identifier hs-var">NestedCtxt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NestedCtxt_ x Header b
-&gt; NestedCtxt_ (HardForkBlock (x : xs)) Header b
forall x (f :: * -&gt; *) a (xs :: [*]).
NestedCtxt_ x f a -&gt; NestedCtxt_ (HardForkBlock (x : xs)) f a
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Block.html#NCZ"><span class="hs-identifier hs-var">NCZ</span></a></span><span> </span><span class="annot"><span class="annottext">NestedCtxt_ x Header b
</span><a href="#local-6989586621680057768"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-338"></span><span>      </span><span class="annot"><a href="#local-6989586621680057780"><span class="hs-identifier hs-var">injSomeSecond</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Strict.html#S"><span class="hs-identifier hs-type">S</span></a></span><span> </span><span id="local-6989586621680057766"><span class="annot"><span class="annottext">NS (SomeSecond (NestedCtxt Header)) xs
</span><a href="#local-6989586621680057766"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">NS (SomeSecond (NestedCtxt Header)) xs
-&gt; SomeSecond (NestedCtxt Header) (HardForkBlock xs)
forall (xs' :: [*]).
NS (SomeSecond (NestedCtxt Header)) xs'
-&gt; SomeSecond (NestedCtxt Header) (HardForkBlock xs')
</span><a href="#local-6989586621680057780"><span class="hs-identifier hs-var">injSomeSecond</span></a></span><span> </span><span class="annot"><span class="annottext">NS (SomeSecond (NestedCtxt Header)) xs
</span><a href="#local-6989586621680057766"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-339"></span><span>          </span><span class="annot"><a href="Ouroboros.Consensus.Util.html#SomeSecond"><span class="hs-identifier hs-type">SomeSecond</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Block.NestedContent.html#NestedCtxt"><span class="hs-identifier hs-type">NestedCtxt</span></a></span><span> </span><span id="local-6989586621680057765"><span class="annot"><span class="annottext">NestedCtxt_ (HardForkBlock xs) Header b
</span><a href="#local-6989586621680057765"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NestedCtxt Header (HardForkBlock (x : xs)) b
-&gt; SomeSecond (NestedCtxt Header) (HardForkBlock (x : xs))
forall (f :: * -&gt; * -&gt; *) a b. f a b -&gt; SomeSecond f a
</span><a href="Ouroboros.Consensus.Util.html#SomeSecond"><span class="hs-identifier hs-var">SomeSecond</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NestedCtxt_ (HardForkBlock (x : xs)) Header b
-&gt; NestedCtxt Header (HardForkBlock (x : xs)) b
forall (f :: * -&gt; *) blk a.
NestedCtxt_ blk f a -&gt; NestedCtxt f blk a
</span><a href="Ouroboros.Consensus.Block.NestedContent.html#NestedCtxt"><span class="hs-identifier hs-var">NestedCtxt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NestedCtxt_ (HardForkBlock xs) Header b
-&gt; NestedCtxt_ (HardForkBlock (x : xs)) Header b
forall (xs :: [*]) (f :: * -&gt; *) a x.
NestedCtxt_ (HardForkBlock xs) f a
-&gt; NestedCtxt_ (HardForkBlock (x : xs)) f a
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Block.html#NCS"><span class="hs-identifier hs-var">NCS</span></a></span><span> </span><span class="annot"><span class="annottext">NestedCtxt_ (HardForkBlock xs) Header b
</span><a href="#local-6989586621680057765"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-340"></span><span>
</span><span id="line-341"></span><span>  </span><span class="hs-comment">-- | Used as the implementation of 'getBinaryBlockInfo' for</span><span>
</span><span id="line-342"></span><span>  </span><span class="hs-comment">-- 'HardForkBlock'.</span></span><span>
</span><span id="line-343"></span><span>  </span><span id="getHfcBinaryBlockInfo"><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#getHfcBinaryBlockInfo"><span class="hs-identifier hs-type">getHfcBinaryBlockInfo</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Basics.html#HardForkBlock"><span class="hs-identifier hs-type">HardForkBlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058575"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#BinaryBlockInfo"><span class="hs-identifier hs-type">BinaryBlockInfo</span></a></span><span>
</span><span id="line-344"></span><span>  </span><span id="local-6989586621680057762"><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#getHfcBinaryBlockInfo"><span class="hs-identifier hs-var hs-var">getHfcBinaryBlockInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Basics.html#HardForkBlock"><span class="hs-identifier hs-type">HardForkBlock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.AcrossEras.html#OneEraBlock"><span class="hs-identifier hs-type">OneEraBlock</span></a></span><span> </span><span id="local-6989586621680057761"><span class="annot"><span class="annottext">NS I xs
</span><a href="#local-6989586621680057761"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-345"></span><span>      </span><span class="annot"><span class="annottext">NS (K BinaryBlockInfo) xs -&gt; CollapseTo NS BinaryBlockInfo
forall k l (h :: (k -&gt; *) -&gt; l -&gt; *) (xs :: l) a.
(HCollapse h, SListIN h xs) =&gt;
h (K a) xs -&gt; CollapseTo h a
</span><span class="hs-identifier hs-var">hcollapse</span></span><span> </span><span class="annot"><span class="annottext">(NS (K BinaryBlockInfo) xs -&gt; CollapseTo NS BinaryBlockInfo)
-&gt; NS (K BinaryBlockInfo) xs -&gt; CollapseTo NS BinaryBlockInfo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy HasBinaryBlockInfo
-&gt; (forall a. HasBinaryBlockInfo a =&gt; I a -&gt; K BinaryBlockInfo a)
-&gt; NS I xs
-&gt; NS (K BinaryBlockInfo) xs
forall k l (h :: (k -&gt; *) -&gt; l -&gt; *) (c :: k -&gt; Constraint)
       (xs :: l) (proxy :: (k -&gt; Constraint) -&gt; *) (f :: k -&gt; *)
       (f' :: k -&gt; *).
(AllN (Prod h) c xs, HAp h) =&gt;
proxy c
-&gt; (forall (a :: k). c a =&gt; f a -&gt; f' a) -&gt; h f xs -&gt; h f' xs
</span><span class="hs-identifier hs-var">hcmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy HasBinaryBlockInfo
forall k (t :: k). Proxy t
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Ouroboros.Consensus.Storage.Serialisation.html#HasBinaryBlockInfo"><span class="hs-identifier hs-type">HasBinaryBlockInfo</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. HasBinaryBlockInfo a =&gt; I a -&gt; K BinaryBlockInfo a
</span><a href="#local-6989586621680057760"><span class="hs-identifier hs-var">aux</span></a></span><span> </span><span class="annot"><span class="annottext">NS I xs
</span><a href="#local-6989586621680057761"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-346"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-347"></span><span>      </span><span class="hs-comment">-- The header is unchanged, but the whole block is offset by 2 bytes</span><span>
</span><span id="line-348"></span><span>      </span><span class="hs-comment">-- (list length and tag)</span><span>
</span><span id="line-349"></span><span>      </span><span id="local-6989586621680057759"><span class="annot"><a href="#local-6989586621680057760"><span class="hs-identifier hs-type">aux</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.Serialisation.html#HasBinaryBlockInfo"><span class="hs-identifier hs-type">HasBinaryBlockInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057759"><span class="hs-identifier hs-type">blk</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">I</span></span><span> </span><span class="annot"><a href="#local-6989586621680057759"><span class="hs-identifier hs-type">blk</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">K</span></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#BinaryBlockInfo"><span class="hs-identifier hs-type">BinaryBlockInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057759"><span class="hs-identifier hs-type">blk</span></a></span></span><span>
</span><span id="line-350"></span><span>      </span><span id="local-6989586621680057760"><span class="annot"><span class="annottext">aux :: I blk -&gt; K BinaryBlockInfo blk
</span><a href="#local-6989586621680057760"><span class="hs-identifier hs-var hs-var">aux</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I</span></span><span> </span><span id="local-6989586621680057758"><span class="annot"><span class="annottext">blk
</span><a href="#local-6989586621680057758"><span class="hs-identifier hs-var">blk</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BinaryBlockInfo -&gt; K BinaryBlockInfo blk
forall k a (b :: k). a -&gt; K a b
</span><span class="hs-identifier hs-var">K</span></span><span> </span><span class="annot"><span class="annottext">(BinaryBlockInfo -&gt; K BinaryBlockInfo blk)
-&gt; BinaryBlockInfo -&gt; K BinaryBlockInfo blk
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">BinaryBlockInfo :: Word16 -&gt; Word16 -&gt; BinaryBlockInfo
</span><a href="Ouroboros.Consensus.Storage.Common.html#BinaryBlockInfo"><span class="hs-identifier hs-type">BinaryBlockInfo</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-351"></span><span>            </span><span class="annot"><span class="annottext">headerOffset :: Word16
</span><a href="Ouroboros.Consensus.Storage.Common.html#headerOffset"><span class="hs-identifier hs-var">headerOffset</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BinaryBlockInfo -&gt; Word16
</span><a href="Ouroboros.Consensus.Storage.Common.html#headerOffset"><span class="hs-identifier hs-var hs-var">headerOffset</span></a></span><span> </span><span class="annot"><span class="annottext">BinaryBlockInfo
</span><a href="#local-6989586621680057755"><span class="hs-identifier hs-var">underlyingBlockInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; Word16 -&gt; Word16
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-number">2</span></span><span>
</span><span id="line-352"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">headerSize :: Word16
</span><a href="Ouroboros.Consensus.Storage.Common.html#headerSize"><span class="hs-identifier hs-var">headerSize</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BinaryBlockInfo -&gt; Word16
</span><a href="Ouroboros.Consensus.Storage.Common.html#headerSize"><span class="hs-identifier hs-var hs-var">headerSize</span></a></span><span>   </span><span class="annot"><span class="annottext">BinaryBlockInfo
</span><a href="#local-6989586621680057755"><span class="hs-identifier hs-var">underlyingBlockInfo</span></a></span><span>
</span><span id="line-353"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-354"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-355"></span><span>          </span><span class="annot"><a href="#local-6989586621680057755"><span class="hs-identifier hs-type">underlyingBlockInfo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.Common.html#BinaryBlockInfo"><span class="hs-identifier hs-type">BinaryBlockInfo</span></a></span><span>
</span><span id="line-356"></span><span>          </span><span id="local-6989586621680057755"><span class="annot"><span class="annottext">underlyingBlockInfo :: BinaryBlockInfo
</span><a href="#local-6989586621680057755"><span class="hs-identifier hs-var hs-var">underlyingBlockInfo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">blk -&gt; BinaryBlockInfo
forall blk. HasBinaryBlockInfo blk =&gt; blk -&gt; BinaryBlockInfo
</span><a href="Ouroboros.Consensus.Storage.Serialisation.html#getBinaryBlockInfo"><span class="hs-identifier hs-var">getBinaryBlockInfo</span></a></span><span> </span><span class="annot"><span class="annottext">blk
</span><a href="#local-6989586621680057758"><span class="hs-identifier hs-var">blk</span></a></span><span>
</span><span id="line-357"></span><span>
</span><span id="line-358"></span><span>  </span><span class="hs-comment">-- | Used as the implementation of 'estimateBlockSize' for 'HardForkBlock'.</span></span><span>
</span><span id="line-359"></span><span>  </span><span id="estimateHfcBlockSize"><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#estimateHfcBlockSize"><span class="hs-identifier hs-type">estimateHfcBlockSize</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Block.Abstract.html#Header"><span class="hs-identifier hs-type">Header</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Basics.html#HardForkBlock"><span class="hs-identifier hs-type">HardForkBlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058575"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.7/ouroboros-network-api-0.1.0.0/noopt/doc/html/ouroboros-network-api/src"><span class="hs-identifier hs-type">SizeInBytes</span></a></span><span>
</span><span id="line-360"></span><span>  </span><span id="local-6989586621680057750"><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#estimateHfcBlockSize"><span class="hs-identifier hs-var hs-var">estimateHfcBlockSize</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-361"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SizeInBytes -&gt; SizeInBytes -&gt; SizeInBytes
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">SizeInBytes
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Account for the era wrapper</span><span>
</span><span id="line-362"></span><span>      </span><span class="annot"><span class="annottext">(SizeInBytes -&gt; SizeInBytes)
-&gt; (Header (HardForkBlock xs) -&gt; SizeInBytes)
-&gt; Header (HardForkBlock xs)
-&gt; SizeInBytes
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">NS (K SizeInBytes) xs -&gt; SizeInBytes
forall k l (h :: (k -&gt; *) -&gt; l -&gt; *) (xs :: l) a.
(HCollapse h, SListIN h xs) =&gt;
h (K a) xs -&gt; CollapseTo h a
</span><span class="hs-identifier hs-var">hcollapse</span></span><span>
</span><span id="line-363"></span><span>      </span><span class="annot"><span class="annottext">(NS (K SizeInBytes) xs -&gt; SizeInBytes)
-&gt; (Header (HardForkBlock xs) -&gt; NS (K SizeInBytes) xs)
-&gt; Header (HardForkBlock xs)
-&gt; SizeInBytes
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy SerialiseConstraintsHFC
-&gt; (forall a.
    SerialiseConstraintsHFC a =&gt;
    Header a -&gt; K SizeInBytes a)
-&gt; NS Header xs
-&gt; NS (K SizeInBytes) xs
forall k l (h :: (k -&gt; *) -&gt; l -&gt; *) (c :: k -&gt; Constraint)
       (xs :: l) (proxy :: (k -&gt; Constraint) -&gt; *) (f :: k -&gt; *)
       (f' :: k -&gt; *).
(AllN (Prod h) c xs, HAp h) =&gt;
proxy c
-&gt; (forall (a :: k). c a =&gt; f a -&gt; f' a) -&gt; h f xs -&gt; h f' xs
</span><span class="hs-identifier hs-var">hcmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy SerialiseConstraintsHFC
forall k (t :: k). Proxy t
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#SerialiseConstraintsHFC"><span class="hs-identifier hs-type">SerialiseConstraintsHFC</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SizeInBytes -&gt; K SizeInBytes a
forall k a (b :: k). a -&gt; K a b
</span><span class="hs-identifier hs-var">K</span></span><span> </span><span class="annot"><span class="annottext">(SizeInBytes -&gt; K SizeInBytes a)
-&gt; (Header a -&gt; SizeInBytes) -&gt; Header a -&gt; K SizeInBytes a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Header a -&gt; SizeInBytes
forall blk.
SerialiseNodeToNodeConstraints blk =&gt;
Header blk -&gt; SizeInBytes
</span><a href="Ouroboros.Consensus.Node.Run.html#estimateBlockSize"><span class="hs-identifier hs-var">estimateBlockSize</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-364"></span><span>      </span><span class="annot"><span class="annottext">(NS Header xs -&gt; NS (K SizeInBytes) xs)
-&gt; (Header (HardForkBlock xs) -&gt; NS Header xs)
-&gt; Header (HardForkBlock xs)
-&gt; NS (K SizeInBytes) xs
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">OneEraHeader xs -&gt; NS Header xs
forall (xs :: [*]). OneEraHeader xs -&gt; NS Header xs
</span><a href="Ouroboros.Consensus.HardFork.Combinator.AcrossEras.html#getOneEraHeader"><span class="hs-identifier hs-var hs-var">getOneEraHeader</span></a></span><span>
</span><span id="line-365"></span><span>      </span><span class="annot"><span class="annottext">(OneEraHeader xs -&gt; NS Header xs)
-&gt; (Header (HardForkBlock xs) -&gt; OneEraHeader xs)
-&gt; Header (HardForkBlock xs)
-&gt; NS Header xs
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Header (HardForkBlock xs) -&gt; OneEraHeader xs
forall (xs :: [*]). Header (HardForkBlock xs) -&gt; OneEraHeader xs
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Block.html#getHardForkHeader"><span class="hs-identifier hs-var hs-var">getHardForkHeader</span></a></span></span><span>
</span><span id="line-366"></span><span>
</span><span id="line-367"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Exceptions
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-370"></span><span>
</span><span id="line-371"></span><span class="hs-comment">-- | Exception thrown in the HFC encoders</span><span>
</span><span id="line-372"></span><span class="hs-keyword">data</span><span> </span><span id="HardForkEncoderException"><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#HardForkEncoderException"><span class="hs-identifier hs-var">HardForkEncoderException</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-373"></span><span>  </span><span class="hs-comment">-- | HFC disabled, but we saw a value from an era other than the first</span><span>
</span><span id="line-374"></span><span>  </span><span id="local-6989586621680057746"><span id="HardForkEncoderFutureEra"><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#HardForkEncoderFutureEra"><span class="hs-identifier hs-var">HardForkEncoderFutureEra</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Info.html#SingleEraInfo"><span class="hs-identifier hs-type">SingleEraInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057746"><span class="hs-identifier hs-type">blk</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#HardForkEncoderException"><span class="hs-identifier hs-type">HardForkEncoderException</span></a></span></span><span>
</span><span id="line-375"></span><span>
</span><span id="line-376"></span><span>  </span><span class="hs-comment">-- | HFC enabled, but we saw a value from a disabled era</span><span>
</span><span id="line-377"></span><span>  </span><span id="local-6989586621680057744"><span id="HardForkEncoderDisabledEra"><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#HardForkEncoderDisabledEra"><span class="hs-identifier hs-var">HardForkEncoderDisabledEra</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Info.html#SingleEraInfo"><span class="hs-identifier hs-type">SingleEraInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057744"><span class="hs-identifier hs-type">blk</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#HardForkEncoderException"><span class="hs-identifier hs-type">HardForkEncoderException</span></a></span></span><span>
</span><span id="line-378"></span><span>
</span><span id="line-379"></span><span>  </span><span class="hs-comment">-- | HFC disabled, but we saw a query that is only supported by the HFC</span><span>
</span><span id="line-380"></span><span>  </span><span id="HardForkEncoderQueryHfcDisabled"><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#HardForkEncoderQueryHfcDisabled"><span class="hs-identifier hs-var">HardForkEncoderQueryHfcDisabled</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#HardForkEncoderException"><span class="hs-identifier hs-type">HardForkEncoderException</span></a></span><span>
</span><span id="line-381"></span><span>
</span><span id="line-382"></span><span>  </span><span class="hs-comment">-- | HFC enabled, but we saw a HFC query that is not supported by the</span><span>
</span><span id="line-383"></span><span>  </span><span class="hs-comment">-- HFC-specific version used</span><span>
</span><span id="line-384"></span><span>  </span><span id="HardForkEncoderQueryWrongVersion"><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#HardForkEncoderQueryWrongVersion"><span class="hs-identifier hs-var">HardForkEncoderQueryWrongVersion</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#HardForkEncoderException"><span class="hs-identifier hs-type">HardForkEncoderException</span></a></span><span>
</span><span id="line-385"></span><span>
</span><span id="line-386"></span><span id="local-6989586621680057735"><span id="local-6989586621680057737"><span id="local-6989586621680057739"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#HardForkEncoderException"><span class="hs-identifier hs-type">HardForkEncoderException</span></a></span></span></span></span><span>
</span><span id="line-387"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680057727"><span id="local-6989586621680057729"><span id="local-6989586621680057731"><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Exception</span></a></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#HardForkEncoderException"><span class="hs-identifier hs-type">HardForkEncoderException</span></a></span></span></span></span><span>
</span><span id="line-388"></span><span>
</span><span id="line-389"></span><span id="local-6989586621680058187"><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#futureEraException"><span class="hs-identifier hs-type">futureEraException</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-390"></span><span>     </span><span class="annot"><span class="hs-identifier hs-type">SListI</span></span><span> </span><span class="annot"><a href="#local-6989586621680058187"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-391"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#NS"><span class="hs-identifier hs-type">NS</span></a></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Info.html#SingleEraInfo"><span class="hs-identifier hs-type">SingleEraInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058187"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-392"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#HardForkEncoderException"><span class="hs-identifier hs-type">HardForkEncoderException</span></a></span></span><span>
</span><span id="line-393"></span><span id="futureEraException"><span class="annot"><span class="annottext">futureEraException :: NS SingleEraInfo xs -&gt; HardForkEncoderException
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#futureEraException"><span class="hs-identifier hs-var hs-var">futureEraException</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NS (K HardForkEncoderException) xs -&gt; HardForkEncoderException
forall k l (h :: (k -&gt; *) -&gt; l -&gt; *) (xs :: l) a.
(HCollapse h, SListIN h xs) =&gt;
h (K a) xs -&gt; CollapseTo h a
</span><span class="hs-identifier hs-var">hcollapse</span></span><span> </span><span class="annot"><span class="annottext">(NS (K HardForkEncoderException) xs -&gt; HardForkEncoderException)
-&gt; (NS SingleEraInfo xs -&gt; NS (K HardForkEncoderException) xs)
-&gt; NS SingleEraInfo xs
-&gt; HardForkEncoderException
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(forall a. SingleEraInfo a -&gt; K HardForkEncoderException a)
-&gt; NS SingleEraInfo xs -&gt; NS (K HardForkEncoderException) xs
forall k l (h :: (k -&gt; *) -&gt; l -&gt; *) (xs :: l) (f :: k -&gt; *)
       (f' :: k -&gt; *).
(SListIN (Prod h) xs, HAp h) =&gt;
(forall (a :: k). f a -&gt; f' a) -&gt; h f xs -&gt; h f' xs
</span><span class="hs-identifier hs-var">hmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HardForkEncoderException -&gt; K HardForkEncoderException a
forall k a (b :: k). a -&gt; K a b
</span><span class="hs-identifier hs-var">K</span></span><span> </span><span class="annot"><span class="annottext">(HardForkEncoderException -&gt; K HardForkEncoderException a)
-&gt; (SingleEraInfo a -&gt; HardForkEncoderException)
-&gt; SingleEraInfo a
-&gt; K HardForkEncoderException a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">SingleEraInfo a -&gt; HardForkEncoderException
forall blk. SingleEraInfo blk -&gt; HardForkEncoderException
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#HardForkEncoderFutureEra"><span class="hs-identifier hs-var">HardForkEncoderFutureEra</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-394"></span><span>
</span><span id="line-395"></span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#disabledEraException"><span class="hs-identifier hs-type">disabledEraException</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-396"></span><span>     </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680057724"><span class="annot"><a href="#local-6989586621680057724"><span class="hs-identifier hs-type">blk</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Abstract.SingleEraBlock.html#SingleEraBlock"><span class="hs-identifier hs-type">SingleEraBlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057724"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-397"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057724"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-398"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#HardForkEncoderException"><span class="hs-identifier hs-type">HardForkEncoderException</span></a></span><span>
</span><span id="line-399"></span><span id="disabledEraException"><span class="annot"><span class="annottext">disabledEraException :: Proxy blk -&gt; HardForkEncoderException
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#disabledEraException"><span class="hs-identifier hs-var hs-var">disabledEraException</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SingleEraInfo blk -&gt; HardForkEncoderException
forall blk. SingleEraInfo blk -&gt; HardForkEncoderException
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#HardForkEncoderDisabledEra"><span class="hs-identifier hs-var">HardForkEncoderDisabledEra</span></a></span><span> </span><span class="annot"><span class="annottext">(SingleEraInfo blk -&gt; HardForkEncoderException)
-&gt; (Proxy blk -&gt; SingleEraInfo blk)
-&gt; Proxy blk
-&gt; HardForkEncoderException
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy blk -&gt; SingleEraInfo blk
forall blk (proxy :: * -&gt; *).
SingleEraBlock blk =&gt;
proxy blk -&gt; SingleEraInfo blk
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Abstract.SingleEraBlock.html#singleEraInfo"><span class="hs-identifier hs-var">singleEraInfo</span></a></span><span>
</span><span id="line-400"></span><span>
</span><span id="line-401"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Dealing with annotations
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-404"></span><span>
</span><span id="line-405"></span><span class="hs-keyword">data</span><span> </span><span id="AnnDecoder"><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#AnnDecoder"><span class="hs-identifier hs-var">AnnDecoder</span></a></span></span><span> </span><span id="local-6989586621680058526"><span class="annot"><a href="#local-6989586621680058526"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621680058525"><span class="annot"><a href="#local-6989586621680058525"><span class="hs-identifier hs-type">blk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="AnnDecoder"><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#AnnDecoder"><span class="hs-identifier hs-var">AnnDecoder</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-406"></span><span>      </span><span id="annDecoder"><span class="annot"><span class="annottext">AnnDecoder f blk -&gt; forall s. Decoder s (ByteString -&gt; f blk)
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#annDecoder"><span class="hs-identifier hs-var hs-var">annDecoder</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680058527"><span class="annot"><a href="#local-6989586621680058527"><span class="hs-identifier hs-type">s</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Decoder</span></span><span> </span><span class="annot"><a href="#local-6989586621680058527"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/bytestring-0.10.12.0/src"><span class="hs-identifier hs-type">Lazy.ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680058526"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058525"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-407"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-408"></span><span>
</span><span id="line-409"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Serialisation of telescopes
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-412"></span><span>
</span><span id="line-413"></span><span id="local-6989586621680057721"><span id="local-6989586621680057722"><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#encodeTelescope"><span class="hs-identifier hs-type">encodeTelescope</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SListI</span></span><span> </span><span class="annot"><a href="#local-6989586621680057722"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-414"></span><span>                </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#NP"><span class="hs-identifier hs-type">NP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680057721"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">-.-&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">K</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Encoding</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680057722"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.State.Types.html#HardForkState"><span class="hs-identifier hs-type">HardForkState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057721"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057722"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Encoding</span></span></span></span><span>
</span><span id="line-415"></span><span id="encodeTelescope"><span class="annot"><span class="annottext">encodeTelescope :: NP (f -.-&gt; K Encoding) xs -&gt; HardForkState f xs -&gt; Encoding
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#encodeTelescope"><span class="hs-identifier hs-var hs-var">encodeTelescope</span></a></span></span><span> </span><span id="local-6989586621680057720"><span class="annot"><span class="annottext">NP (f -.-&gt; K Encoding) xs
</span><a href="#local-6989586621680057720"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.State.Types.html#HardForkState"><span class="hs-identifier hs-type">HardForkState</span></a></span><span> </span><span id="local-6989586621680057718"><span class="annot"><span class="annottext">Telescope (K Past) (Current f) xs
</span><a href="#local-6989586621680057718"><span class="hs-identifier hs-var">st</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Encoding] -&gt; Encoding
forall a. Monoid a =&gt; [a] -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mconcat</span></a></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-416"></span><span>      </span><span class="annot"><span class="annottext">Word -&gt; Encoding
</span><span class="hs-identifier hs-var">Enc.encodeListLen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Word -&gt; Word -&gt; Word
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621680057716"><span class="hs-identifier hs-var">ix</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-417"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Encoding] -&gt; Encoding
forall a. Monoid a =&gt; [a] -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mconcat</span></a></span><span> </span><span class="annot"><span class="annottext">([Encoding] -&gt; Encoding) -&gt; [Encoding] -&gt; Encoding
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">SimpleTelescope (K Encoding) xs
-&gt; CollapseTo SimpleTelescope Encoding
forall k l (h :: (k -&gt; *) -&gt; l -&gt; *) (xs :: l) a.
(HCollapse h, SListIN h xs) =&gt;
h (K a) xs -&gt; CollapseTo h a
</span><span class="hs-identifier hs-var">hcollapse</span></span><span> </span><span class="annot"><span class="annottext">(SimpleTelescope (K Encoding) xs
 -&gt; CollapseTo SimpleTelescope Encoding)
-&gt; SimpleTelescope (K Encoding) xs
-&gt; CollapseTo SimpleTelescope Encoding
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope (K Encoding) (K Encoding) xs
-&gt; SimpleTelescope (K Encoding) xs
forall k (f :: k -&gt; *) (xs :: [k]).
Telescope f f xs -&gt; SimpleTelescope f xs
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Util.Telescope.html#SimpleTelescope"><span class="hs-identifier hs-var">SimpleTelescope</span></a></span><span> </span><span class="annot"><span class="annottext">(Telescope (K Encoding) (K Encoding) xs
 -&gt; SimpleTelescope (K Encoding) xs)
-&gt; Telescope (K Encoding) (K Encoding) xs
-&gt; SimpleTelescope (K Encoding) xs
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-418"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall x. (-.-&gt;) f (K Encoding) x -&gt; K Past x -&gt; K Encoding x)
-&gt; (forall x.
    (-.-&gt;) f (K Encoding) x -&gt; Current f x -&gt; K Encoding x)
-&gt; NP (f -.-&gt; K Encoding) xs
-&gt; Telescope (K Past) (Current f) xs
-&gt; Telescope (K Encoding) (K Encoding) xs
forall k (xs :: [k]) (h :: k -&gt; *) (g :: k -&gt; *) (g' :: k -&gt; *)
       (f :: k -&gt; *) (f' :: k -&gt; *).
SListI xs =&gt;
(forall (x :: k). h x -&gt; g x -&gt; g' x)
-&gt; (forall (x :: k). h x -&gt; f x -&gt; f' x)
-&gt; NP h xs
-&gt; Telescope g f xs
-&gt; Telescope g' f' xs
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Util.Telescope.html#bihzipWith"><span class="hs-identifier hs-var">Telescope.bihzipWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(K Past x -&gt; K Encoding x)
-&gt; (-.-&gt;) f (K Encoding) x -&gt; K Past x -&gt; K Encoding x
forall a b. a -&gt; b -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">K Past x -&gt; K Encoding x
forall blk. K Past blk -&gt; K Encoding blk
</span><a href="#local-6989586621680057712"><span class="hs-identifier hs-var">encPast</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall x. (-.-&gt;) f (K Encoding) x -&gt; Current f x -&gt; K Encoding x
forall (f :: * -&gt; *) blk.
(-.-&gt;) f (K Encoding) blk -&gt; Current f blk -&gt; K Encoding blk
</span><a href="#local-6989586621680057711"><span class="hs-identifier hs-var">encCurrent</span></a></span><span> </span><span class="annot"><span class="annottext">NP (f -.-&gt; K Encoding) xs
</span><a href="#local-6989586621680057720"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope (K Past) (Current f) xs
</span><a href="#local-6989586621680057718"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-419"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-420"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-421"></span><span>    </span><span class="hs-comment">-- The tip of the telescope also tells us the length</span><span>
</span><span id="line-422"></span><span>    </span><span class="annot"><a href="#local-6989586621680057716"><span class="hs-identifier hs-type">ix</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Word8</span></a></span><span>
</span><span id="line-423"></span><span>    </span><span id="local-6989586621680057716"><span class="annot"><span class="annottext">ix :: Word8
</span><a href="#local-6989586621680057716"><span class="hs-identifier hs-var hs-var">ix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NS (Current f) xs -&gt; Word8
forall k (xs :: [k]) (f :: k -&gt; *). SListI xs =&gt; NS f xs -&gt; Word8
</span><a href="Ouroboros.Consensus.Util.SOP.html#nsToIndex"><span class="hs-identifier hs-var">nsToIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Telescope (K Past) (Current f) xs -&gt; NS (Current f) xs
forall k (g :: k -&gt; *) (f :: k -&gt; *) (xs :: [k]).
Telescope g f xs -&gt; NS f xs
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Util.Telescope.html#tip"><span class="hs-identifier hs-var">Telescope.tip</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope (K Past) (Current f) xs
</span><a href="#local-6989586621680057718"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-424"></span><span>
</span><span id="line-425"></span><span>    </span><span id="local-6989586621680058396"><span class="annot"><a href="#local-6989586621680057712"><span class="hs-identifier hs-type">encPast</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">K</span></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.State.Types.html#Past"><span class="hs-identifier hs-type">Past</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058396"><span class="hs-identifier hs-type">blk</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">K</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Encoding</span></span><span> </span><span class="annot"><a href="#local-6989586621680058396"><span class="hs-identifier hs-type">blk</span></a></span></span><span>
</span><span id="line-426"></span><span>    </span><span id="local-6989586621680057712"><span class="annot"><span class="annottext">encPast :: K Past blk -&gt; K Encoding blk
</span><a href="#local-6989586621680057712"><span class="hs-identifier hs-var hs-var">encPast</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Encoding -&gt; K Encoding blk
forall k a (b :: k). a -&gt; K a b
</span><span class="hs-identifier hs-var">K</span></span><span> </span><span class="annot"><span class="annottext">(Encoding -&gt; K Encoding blk)
-&gt; (K Past blk -&gt; Encoding) -&gt; K Past blk -&gt; K Encoding blk
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Past -&gt; Encoding
</span><a href="Ouroboros.Consensus.HardFork.Combinator.State.Instances.html#encodePast"><span class="hs-identifier hs-var">encodePast</span></a></span><span> </span><span class="annot"><span class="annottext">(Past -&gt; Encoding)
-&gt; (K Past blk -&gt; Past) -&gt; K Past blk -&gt; Encoding
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">K Past blk -&gt; Past
forall k a (b :: k). K a b -&gt; a
</span><span class="hs-identifier hs-var">unK</span></span><span>
</span><span id="line-427"></span><span>
</span><span id="line-428"></span><span>    </span><span id="local-6989586621680058394"><span id="local-6989586621680058395"><span class="annot"><a href="#local-6989586621680057711"><span class="hs-identifier hs-type">encCurrent</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680058395"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">-.-&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">K</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Encoding</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680058394"><span class="hs-identifier hs-type">blk</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.State.Types.html#Current"><span class="hs-identifier hs-type">Current</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058395"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058394"><span class="hs-identifier hs-type">blk</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">K</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Encoding</span></span><span> </span><span class="annot"><a href="#local-6989586621680058394"><span class="hs-identifier hs-type">blk</span></a></span></span></span><span>
</span><span id="line-429"></span><span>    </span><span id="local-6989586621680057711"><span class="annot"><span class="annottext">encCurrent :: (-.-&gt;) f (K Encoding) blk -&gt; Current f blk -&gt; K Encoding blk
</span><a href="#local-6989586621680057711"><span class="hs-identifier hs-var hs-var">encCurrent</span></a></span></span><span> </span><span id="local-6989586621680057706"><span class="annot"><span class="annottext">(-.-&gt;) f (K Encoding) blk
</span><a href="#local-6989586621680057706"><span class="hs-identifier hs-var">enc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Encoding -&gt; K Encoding blk
forall k a (b :: k). a -&gt; K a b
</span><span class="hs-identifier hs-var">K</span></span><span> </span><span class="annot"><span class="annottext">(Encoding -&gt; K Encoding blk)
-&gt; (Current f blk -&gt; Encoding) -&gt; Current f blk -&gt; K Encoding blk
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(f blk -&gt; Encoding) -&gt; Current f blk -&gt; Encoding
forall (f :: * -&gt; *) blk.
(f blk -&gt; Encoding) -&gt; Current f blk -&gt; Encoding
</span><a href="Ouroboros.Consensus.HardFork.Combinator.State.Instances.html#encodeCurrent"><span class="hs-identifier hs-var">encodeCurrent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">K Encoding blk -&gt; Encoding
forall k a (b :: k). K a b -&gt; a
</span><span class="hs-identifier hs-var">unK</span></span><span> </span><span class="annot"><span class="annottext">(K Encoding blk -&gt; Encoding)
-&gt; (f blk -&gt; K Encoding blk) -&gt; f blk -&gt; Encoding
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(-.-&gt;) f (K Encoding) blk -&gt; f blk -&gt; K Encoding blk
forall k (f :: k -&gt; *) (g :: k -&gt; *) (a :: k).
(-.-&gt;) f g a -&gt; f a -&gt; g a
</span><span class="hs-identifier hs-var hs-var">apFn</span></span><span> </span><span class="annot"><span class="annottext">(-.-&gt;) f (K Encoding) blk
</span><a href="#local-6989586621680057706"><span class="hs-identifier hs-var">enc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-430"></span><span>
</span><span id="line-431"></span><span id="local-6989586621680057701"><span id="local-6989586621680057702"><span id="local-6989586621680057703"><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#decodeTelescope"><span class="hs-identifier hs-type">decodeTelescope</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#NP"><span class="hs-identifier hs-type">NP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Decoder</span></span><span> </span><span class="annot"><a href="#local-6989586621680057703"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:.:</span></span><span> </span><span class="annot"><a href="#local-6989586621680057702"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680057701"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Decoder</span></span><span> </span><span class="annot"><a href="#local-6989586621680057703"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.State.Types.html#HardForkState"><span class="hs-identifier hs-type">HardForkState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057702"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057701"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-432"></span><span id="decodeTelescope"><span class="annot"><span class="annottext">decodeTelescope :: NP (Decoder s :.: f) xs -&gt; Decoder s (HardForkState f xs)
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#decodeTelescope"><span class="hs-identifier hs-var hs-var">decodeTelescope</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680057700"><span class="annot"><span class="annottext">NP (Decoder s :.: f) xs
</span><a href="#local-6989586621680057700"><span class="hs-identifier hs-var">ds</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-433"></span><span>    </span><span id="local-6989586621680057699"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680057699"><span class="hs-identifier hs-var">ix</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Decoder s Int
forall s. Decoder s Int
</span><span class="hs-identifier hs-var">Dec.decodeListLen</span></span><span>
</span><span id="line-434"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680057699"><span class="hs-identifier hs-var">ix</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-435"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String -&gt; Decoder s (HardForkState f xs)
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Decoder s (HardForkState f xs))
-&gt; String -&gt; Decoder s (HardForkState f xs)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;decodeTelescope: invalid telescope length &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680057699"><span class="hs-identifier hs-var">ix</span></a></span><span>
</span><span id="line-436"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Telescope (K Past) (Current f) xs -&gt; HardForkState f xs
forall (f :: * -&gt; *) (xs :: [*]).
Telescope (K Past) (Current f) xs -&gt; HardForkState f xs
</span><a href="Ouroboros.Consensus.HardFork.Combinator.State.Types.html#HardForkState"><span class="hs-identifier hs-var">HardForkState</span></a></span><span> </span><span class="annot"><span class="annottext">(Telescope (K Past) (Current f) xs -&gt; HardForkState f xs)
-&gt; Decoder s (Telescope (K Past) (Current f) xs)
-&gt; Decoder s (HardForkState f xs)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int
-&gt; NP (Decoder s :.: f) xs
-&gt; Decoder s (Telescope (K Past) (Current f) xs)
forall s (f :: * -&gt; *) (xs :: [*]).
Int
-&gt; NP (Decoder s :.: f) xs
-&gt; Decoder s (Telescope (K Past) (Current f) xs)
</span><a href="#local-6989586621680057696"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680057699"><span class="hs-identifier hs-var">ix</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NP (Decoder s :.: f) xs
</span><a href="#local-6989586621680057700"><span class="hs-identifier hs-var">ds</span></a></span><span>
</span><span id="line-437"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-438"></span><span>    </span><span id="local-6989586621680058362"><span id="local-6989586621680058363"><span id="local-6989586621680058364"><span class="annot"><a href="#local-6989586621680057696"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-439"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#NP"><span class="hs-identifier hs-type">NP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Decoder</span></span><span> </span><span class="annot"><a href="#local-6989586621680058364"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:.:</span></span><span> </span><span class="annot"><a href="#local-6989586621680058363"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680058362"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-440"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Decoder</span></span><span> </span><span class="annot"><a href="#local-6989586621680058364"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Util.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">K</span></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.State.Types.html#Past"><span class="hs-identifier hs-type">Past</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.State.Types.html#Current"><span class="hs-identifier hs-type">Current</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058363"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680058362"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-441"></span><span>    </span><span id="local-6989586621680057696"><span class="annot"><span class="annottext">go :: Int
-&gt; NP (Decoder s :.: f) xs
-&gt; Decoder s (Telescope (K Past) (Current f) xs)
</span><a href="#local-6989586621680057696"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Comp</span></span><span> </span><span id="local-6989586621680057694"><span class="annot"><span class="annottext">Decoder s (f x)
</span><a href="#local-6989586621680057694"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#%3A%2A"><span class="hs-operator hs-type">:*</span></a></span><span> </span><span class="annot"><span class="annottext">NP (Decoder s :.: f) xs
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Current f x -&gt; Telescope (K Past) (Current f) (x : xs)
forall a (f :: a -&gt; *) (x :: a) (g :: a -&gt; *) (xs :: [a]).
f x -&gt; Telescope g f (x : xs)
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Util.Telescope.html#TZ"><span class="hs-identifier hs-var">TZ</span></a></span><span> </span><span class="annot"><span class="annottext">(Current f x -&gt; Telescope (K Past) (Current f) (x : xs))
-&gt; Decoder s (Current f x)
-&gt; Decoder s (Telescope (K Past) (Current f) (x : xs))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Decoder s (f x) -&gt; Decoder s (Current f x)
forall s (f :: * -&gt; *) blk.
Decoder s (f blk) -&gt; Decoder s (Current f blk)
</span><a href="Ouroboros.Consensus.HardFork.Combinator.State.Instances.html#decodeCurrent"><span class="hs-identifier hs-var">decodeCurrent</span></a></span><span> </span><span class="annot"><span class="annottext">Decoder s (f x)
</span><a href="#local-6989586621680057694"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-442"></span><span>    </span><span class="annot"><a href="#local-6989586621680057696"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621680057690"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680057690"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Comp</span></span><span> </span><span class="annot"><span class="annottext">Decoder s (f x)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#%3A%2A"><span class="hs-operator hs-type">:*</span></a></span><span> </span><span id="local-6989586621680057689"><span class="annot"><span class="annottext">NP (Decoder s :.: f) xs
</span><a href="#local-6989586621680057689"><span class="hs-identifier hs-var">ds</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">K Past x
-&gt; Telescope (K Past) (Current f) xs
-&gt; Telescope (K Past) (Current f) (x : xs)
forall a (g :: a -&gt; *) (x :: a) (f :: a -&gt; *) (xs :: [a]).
g x -&gt; Telescope g f xs -&gt; Telescope g f (x : xs)
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Util.Telescope.html#TS"><span class="hs-identifier hs-var">TS</span></a></span><span> </span><span class="annot"><span class="annottext">(K Past x
 -&gt; Telescope (K Past) (Current f) xs
 -&gt; Telescope (K Past) (Current f) (x : xs))
-&gt; Decoder s (K Past x)
-&gt; Decoder
     s
     (Telescope (K Past) (Current f) xs
      -&gt; Telescope (K Past) (Current f) (x : xs))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Past -&gt; K Past x
forall k a (b :: k). a -&gt; K a b
</span><span class="hs-identifier hs-var">K</span></span><span> </span><span class="annot"><span class="annottext">(Past -&gt; K Past x) -&gt; Decoder s Past -&gt; Decoder s (K Past x)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Decoder s Past
forall s. Decoder s Past
</span><a href="Ouroboros.Consensus.HardFork.Combinator.State.Instances.html#decodePast"><span class="hs-identifier hs-var">decodePast</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Decoder
  s
  (Telescope (K Past) (Current f) xs
   -&gt; Telescope (K Past) (Current f) (x : xs))
-&gt; Decoder s (Telescope (K Past) (Current f) xs)
-&gt; Decoder s (Telescope (K Past) (Current f) (x : xs))
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int
-&gt; NP (Decoder s :.: f) xs
-&gt; Decoder s (Telescope (K Past) (Current f) xs)
forall s (f :: * -&gt; *) (xs :: [*]).
Int
-&gt; NP (Decoder s :.: f) xs
-&gt; Decoder s (Telescope (K Past) (Current f) xs)
</span><a href="#local-6989586621680057696"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680057690"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NP (Decoder s :.: f) xs
</span><a href="#local-6989586621680057689"><span class="hs-identifier hs-var">ds</span></a></span><span>
</span><span id="line-443"></span><span>    </span><span class="annot"><a href="#local-6989586621680057696"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">NP (Decoder s :.: f) xs
</span><a href="Data.SOP.Strict.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Decoder s (Telescope (K Past) (Current f) xs)
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;decodeTelescope: invalid telescope length&quot;</span></span><span>
</span><span id="line-444"></span><span>
</span><span id="line-445"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Serialisation of sums
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-448"></span><span>
</span><span id="line-449"></span><span id="local-6989586621680058566"><span id="local-6989586621680058568"><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#encodeNS"><span class="hs-identifier hs-type">encodeNS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SListI</span></span><span> </span><span class="annot"><a href="#local-6989586621680058568"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#NP"><span class="hs-identifier hs-type">NP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680058566"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">-.-&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">K</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Encoding</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680058568"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#NS"><span class="hs-identifier hs-type">NS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058566"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058568"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Encoding</span></span></span></span><span>
</span><span id="line-450"></span><span id="encodeNS"><span class="annot"><span class="annottext">encodeNS :: NP (f -.-&gt; K Encoding) xs -&gt; NS f xs -&gt; Encoding
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#encodeNS"><span class="hs-identifier hs-var hs-var">encodeNS</span></a></span></span><span> </span><span id="local-6989586621680057685"><span class="annot"><span class="annottext">NP (f -.-&gt; K Encoding) xs
</span><a href="#local-6989586621680057685"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span id="local-6989586621680057684"><span class="annot"><span class="annottext">NS f xs
</span><a href="#local-6989586621680057684"><span class="hs-identifier hs-var">ns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Encoding] -&gt; Encoding
forall a. Monoid a =&gt; [a] -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mconcat</span></a></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-451"></span><span>      </span><span class="annot"><span class="annottext">Word -&gt; Encoding
</span><span class="hs-identifier hs-var">Enc.encodeListLen</span></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">2</span></span><span>
</span><span id="line-452"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Encoding
</span><span class="hs-identifier hs-var">Enc.encodeWord8</span></span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; Encoding) -&gt; Word8 -&gt; Encoding
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">NS f xs -&gt; Word8
forall k (xs :: [k]) (f :: k -&gt; *). SListI xs =&gt; NS f xs -&gt; Word8
</span><a href="Ouroboros.Consensus.Util.SOP.html#nsToIndex"><span class="hs-identifier hs-var">nsToIndex</span></a></span><span> </span><span class="annot"><span class="annottext">NS f xs
</span><a href="#local-6989586621680057684"><span class="hs-identifier hs-var">ns</span></a></span><span>
</span><span id="line-453"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NS (K Encoding) xs -&gt; CollapseTo NS Encoding
forall k l (h :: (k -&gt; *) -&gt; l -&gt; *) (xs :: l) a.
(HCollapse h, SListIN h xs) =&gt;
h (K a) xs -&gt; CollapseTo h a
</span><span class="hs-identifier hs-var">hcollapse</span></span><span> </span><span class="annot"><span class="annottext">(NS (K Encoding) xs -&gt; CollapseTo NS Encoding)
-&gt; NS (K Encoding) xs -&gt; CollapseTo NS Encoding
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(forall a. (-.-&gt;) f (K Encoding) a -&gt; f a -&gt; K Encoding a)
-&gt; Prod NS (f -.-&gt; K Encoding) xs -&gt; NS f xs -&gt; NS (K Encoding) xs
forall k l (h :: (k -&gt; *) -&gt; l -&gt; *) (xs :: l) (f :: k -&gt; *)
       (f' :: k -&gt; *) (f'' :: k -&gt; *).
(SListIN (Prod h) xs, HAp h, HAp (Prod h)) =&gt;
(forall (a :: k). f a -&gt; f' a -&gt; f'' a)
-&gt; Prod h f xs -&gt; h f' xs -&gt; h f'' xs
</span><span class="hs-identifier hs-var">hzipWith</span></span><span> </span><span class="annot"><span class="annottext">forall a. (-.-&gt;) f (K Encoding) a -&gt; f a -&gt; K Encoding a
forall k (f :: k -&gt; *) (g :: k -&gt; *) (a :: k).
(-.-&gt;) f g a -&gt; f a -&gt; g a
</span><span class="hs-identifier hs-var hs-var">apFn</span></span><span> </span><span class="annot"><span class="annottext">Prod NS (f -.-&gt; K Encoding) xs
NP (f -.-&gt; K Encoding) xs
</span><a href="#local-6989586621680057685"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">NS f xs
</span><a href="#local-6989586621680057684"><span class="hs-identifier hs-var">ns</span></a></span><span>
</span><span id="line-454"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-455"></span><span>
</span><span id="line-456"></span><span id="local-6989586621680058163"><span id="local-6989586621680058164"><span id="local-6989586621680058165"><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#decodeNS"><span class="hs-identifier hs-type">decodeNS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SListI</span></span><span> </span><span class="annot"><a href="#local-6989586621680058165"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#NP"><span class="hs-identifier hs-type">NP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Decoder</span></span><span> </span><span class="annot"><a href="#local-6989586621680058164"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:.:</span></span><span> </span><span class="annot"><a href="#local-6989586621680058163"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680058165"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Decoder</span></span><span> </span><span class="annot"><a href="#local-6989586621680058164"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Strict.html#NS"><span class="hs-identifier hs-type">NS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058163"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058165"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-457"></span><span id="decodeNS"><span class="annot"><span class="annottext">decodeNS :: NP (Decoder s :.: f) xs -&gt; Decoder s (NS f xs)
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#decodeNS"><span class="hs-identifier hs-var hs-var">decodeNS</span></a></span></span><span> </span><span id="local-6989586621680057681"><span class="annot"><span class="annottext">NP (Decoder s :.: f) xs
</span><a href="#local-6989586621680057681"><span class="hs-identifier hs-var">ds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-458"></span><span>    </span><span class="annot"><span class="annottext">Text -&gt; Int -&gt; Decoder s ()
forall s. Text -&gt; Int -&gt; Decoder s ()
</span><span class="hs-identifier hs-var">enforceSize</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;decodeNS&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-459"></span><span>    </span><span id="local-6989586621680057680"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621680057680"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Decoder s Word8
forall s. Decoder s Word8
</span><span class="hs-identifier hs-var">Dec.decodeWord8</span></span><span>
</span><span id="line-460"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Maybe (NS (K ()) xs)
forall k (xs :: [k]). SListI xs =&gt; Word8 -&gt; Maybe (NS (K ()) xs)
</span><a href="Ouroboros.Consensus.Util.SOP.html#nsFromIndex"><span class="hs-identifier hs-var">nsFromIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621680057680"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-461"></span><span>      </span><span class="annot"><span class="annottext">Maybe (NS (K ()) xs)
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Decoder s (NS f xs)
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Decoder s (NS f xs)) -&gt; String -&gt; Decoder s (NS f xs)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;decodeNS: invalid index &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621680057680"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-462"></span><span>      </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680057678"><span class="annot"><span class="annottext">NS (K ()) xs
</span><a href="#local-6989586621680057678"><span class="hs-identifier hs-var">ns</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NS (K (Decoder s (NS f xs))) xs
-&gt; CollapseTo NS (Decoder s (NS f xs))
forall k l (h :: (k -&gt; *) -&gt; l -&gt; *) (xs :: l) a.
(HCollapse h, SListIN h xs) =&gt;
h (K a) xs -&gt; CollapseTo h a
</span><span class="hs-identifier hs-var">hcollapse</span></span><span> </span><span class="annot"><span class="annottext">(NS (K (Decoder s (NS f xs))) xs
 -&gt; CollapseTo NS (Decoder s (NS f xs)))
-&gt; NS (K (Decoder s (NS f xs))) xs
-&gt; CollapseTo NS (Decoder s (NS f xs))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(forall a.
 Index xs a
 -&gt; (:.:) (Decoder s) f a -&gt; K () a -&gt; K (Decoder s (NS f xs)) a)
-&gt; NP (Decoder s :.: f) xs
-&gt; NS (K ()) xs
-&gt; NS (K (Decoder s (NS f xs))) xs
forall k (h :: (k -&gt; *) -&gt; [k] -&gt; *) (xs :: [k]) (f1 :: k -&gt; *)
       (f2 :: k -&gt; *) (f3 :: k -&gt; *).
(HAp h, SListI xs, Prod h ~ NP) =&gt;
(forall (a :: k). Index xs a -&gt; f1 a -&gt; f2 a -&gt; f3 a)
-&gt; NP f1 xs -&gt; h f2 xs -&gt; h f3 xs
</span><a href="Ouroboros.Consensus.Util.SOP.html#hizipWith"><span class="hs-identifier hs-var">hizipWith</span></a></span><span> </span><span class="annot"><span class="annottext">forall (xs :: [*]) blk s (f :: * -&gt; *).
Index xs blk
-&gt; (:.:) (Decoder s) f blk
-&gt; K () blk
-&gt; K (Decoder s (NS f xs)) blk
forall a.
Index xs a
-&gt; (:.:) (Decoder s) f a -&gt; K () a -&gt; K (Decoder s (NS f xs)) a
</span><a href="#local-6989586621680057676"><span class="hs-identifier hs-var">aux</span></a></span><span> </span><span class="annot"><span class="annottext">NP (Decoder s :.: f) xs
</span><a href="#local-6989586621680057681"><span class="hs-identifier hs-var">ds</span></a></span><span> </span><span class="annot"><span class="annottext">NS (K ()) xs
</span><a href="#local-6989586621680057678"><span class="hs-identifier hs-var">ns</span></a></span><span>
</span><span id="line-463"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-464"></span><span>    </span><span id="local-6989586621680058310"><span id="local-6989586621680058311"><span id="local-6989586621680058312"><span id="local-6989586621680058313"><span class="annot"><a href="#local-6989586621680057676"><span class="hs-identifier hs-type">aux</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Util.SOP.html#Index"><span class="hs-identifier hs-type">Index</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058313"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058312"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-465"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Decoder</span></span><span> </span><span class="annot"><a href="#local-6989586621680058311"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:.:</span></span><span> </span><span class="annot"><a href="#local-6989586621680058310"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680058312"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-466"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">K</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680058312"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-467"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">K</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Decoder</span></span><span> </span><span class="annot"><a href="#local-6989586621680058311"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Strict.html#NS"><span class="hs-identifier hs-type">NS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058310"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058313"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680058312"><span class="hs-identifier hs-type">blk</span></a></span></span></span></span></span><span>
</span><span id="line-468"></span><span>    </span><span id="local-6989586621680057676"><span class="annot"><span class="annottext">aux :: Index xs blk
-&gt; (:.:) (Decoder s) f blk
-&gt; K () blk
-&gt; K (Decoder s (NS f xs)) blk
</span><a href="#local-6989586621680057676"><span class="hs-identifier hs-var hs-var">aux</span></a></span></span><span> </span><span id="local-6989586621680057675"><span class="annot"><span class="annottext">Index xs blk
</span><a href="#local-6989586621680057675"><span class="hs-identifier hs-var">index</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Comp</span></span><span> </span><span id="local-6989586621680057674"><span class="annot"><span class="annottext">Decoder s (f blk)
</span><a href="#local-6989586621680057674"><span class="hs-identifier hs-var">dec</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">K</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Decoder s (NS f xs) -&gt; K (Decoder s (NS f xs)) blk
forall k a (b :: k). a -&gt; K a b
</span><span class="hs-identifier hs-var">K</span></span><span> </span><span class="annot"><span class="annottext">(Decoder s (NS f xs) -&gt; K (Decoder s (NS f xs)) blk)
-&gt; Decoder s (NS f xs) -&gt; K (Decoder s (NS f xs)) blk
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Index xs blk -&gt; f blk -&gt; NS f xs
forall k (f :: k -&gt; *) (x :: k) (xs :: [k]).
Index xs x -&gt; f x -&gt; NS f xs
</span><a href="Ouroboros.Consensus.Util.SOP.html#injectNS"><span class="hs-identifier hs-var">injectNS</span></a></span><span> </span><span class="annot"><span class="annottext">Index xs blk
</span><a href="#local-6989586621680057675"><span class="hs-identifier hs-var">index</span></a></span><span> </span><span class="annot"><span class="annottext">(f blk -&gt; NS f xs) -&gt; Decoder s (f blk) -&gt; Decoder s (NS f xs)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Decoder s (f blk)
</span><a href="#local-6989586621680057674"><span class="hs-identifier hs-var">dec</span></a></span><span>
</span><span id="line-469"></span><span>
</span><span id="line-470"></span><span id="local-6989586621680058531"><span id="local-6989586621680058532"><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#decodeAnnNS"><span class="hs-identifier hs-type">decodeAnnNS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SListI</span></span><span> </span><span class="annot"><a href="#local-6989586621680058532"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-471"></span><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#NP"><span class="hs-identifier hs-type">NP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#AnnDecoder"><span class="hs-identifier hs-type">AnnDecoder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058531"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680058532"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-472"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680058533"><span class="annot"><a href="#local-6989586621680058533"><span class="hs-identifier hs-type">s</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Decoder</span></span><span> </span><span class="annot"><a href="#local-6989586621680058533"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/bytestring-0.10.12.0/src"><span class="hs-identifier hs-type">Lazy.ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#NS"><span class="hs-identifier hs-type">NS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058531"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058532"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-473"></span><span id="decodeAnnNS"><span class="annot"><span class="annottext">decodeAnnNS :: NP (AnnDecoder f) xs -&gt; forall s. Decoder s (ByteString -&gt; NS f xs)
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#decodeAnnNS"><span class="hs-identifier hs-var hs-var">decodeAnnNS</span></a></span></span><span> </span><span id="local-6989586621680057672"><span class="annot"><span class="annottext">NP (AnnDecoder f) xs
</span><a href="#local-6989586621680057672"><span class="hs-identifier hs-var">ds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-474"></span><span>    </span><span class="annot"><span class="annottext">Text -&gt; Int -&gt; Decoder s ()
forall s. Text -&gt; Int -&gt; Decoder s ()
</span><span class="hs-identifier hs-var">enforceSize</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;decodeDiskAnnNS&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-475"></span><span>    </span><span id="local-6989586621680057671"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621680057671"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Decoder s Word8
forall s. Decoder s Word8
</span><span class="hs-identifier hs-var">Dec.decodeWord8</span></span><span>
</span><span id="line-476"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Maybe (NS (K ()) xs)
forall k (xs :: [k]). SListI xs =&gt; Word8 -&gt; Maybe (NS (K ()) xs)
</span><a href="Ouroboros.Consensus.Util.SOP.html#nsFromIndex"><span class="hs-identifier hs-var">nsFromIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621680057671"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-477"></span><span>      </span><span class="annot"><span class="annottext">Maybe (NS (K ()) xs)
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Decoder s (ByteString -&gt; NS f xs)
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Decoder s (ByteString -&gt; NS f xs))
-&gt; String -&gt; Decoder s (ByteString -&gt; NS f xs)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;decodeAnnNS: invalid index &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621680057671"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-478"></span><span>      </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680057670"><span class="annot"><span class="annottext">NS (K ()) xs
</span><a href="#local-6989586621680057670"><span class="hs-identifier hs-var">ns</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NS (K (Decoder s (ByteString -&gt; NS f xs))) xs
-&gt; CollapseTo NS (Decoder s (ByteString -&gt; NS f xs))
forall k l (h :: (k -&gt; *) -&gt; l -&gt; *) (xs :: l) a.
(HCollapse h, SListIN h xs) =&gt;
h (K a) xs -&gt; CollapseTo h a
</span><span class="hs-identifier hs-var">hcollapse</span></span><span> </span><span class="annot"><span class="annottext">(NS (K (Decoder s (ByteString -&gt; NS f xs))) xs
 -&gt; CollapseTo NS (Decoder s (ByteString -&gt; NS f xs)))
-&gt; NS (K (Decoder s (ByteString -&gt; NS f xs))) xs
-&gt; CollapseTo NS (Decoder s (ByteString -&gt; NS f xs))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(forall a.
 Index xs a
 -&gt; AnnDecoder f a
 -&gt; K () a
 -&gt; K (Decoder s (ByteString -&gt; NS f xs)) a)
-&gt; NP (AnnDecoder f) xs
-&gt; NS (K ()) xs
-&gt; NS (K (Decoder s (ByteString -&gt; NS f xs))) xs
forall k (h :: (k -&gt; *) -&gt; [k] -&gt; *) (xs :: [k]) (f1 :: k -&gt; *)
       (f2 :: k -&gt; *) (f3 :: k -&gt; *).
(HAp h, SListI xs, Prod h ~ NP) =&gt;
(forall (a :: k). Index xs a -&gt; f1 a -&gt; f2 a -&gt; f3 a)
-&gt; NP f1 xs -&gt; h f2 xs -&gt; h f3 xs
</span><a href="Ouroboros.Consensus.Util.SOP.html#hizipWith"><span class="hs-identifier hs-var">hizipWith</span></a></span><span> </span><span class="annot"><span class="annottext">forall (xs :: [*]) blk (f :: * -&gt; *) s.
Index xs blk
-&gt; AnnDecoder f blk
-&gt; K () blk
-&gt; K (Decoder s (ByteString -&gt; NS f xs)) blk
forall a.
Index xs a
-&gt; AnnDecoder f a
-&gt; K () a
-&gt; K (Decoder s (ByteString -&gt; NS f xs)) a
</span><a href="#local-6989586621680057669"><span class="hs-identifier hs-var">aux</span></a></span><span> </span><span class="annot"><span class="annottext">NP (AnnDecoder f) xs
</span><a href="#local-6989586621680057672"><span class="hs-identifier hs-var">ds</span></a></span><span> </span><span class="annot"><span class="annottext">NS (K ()) xs
</span><a href="#local-6989586621680057670"><span class="hs-identifier hs-var">ns</span></a></span><span>
</span><span id="line-479"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-480"></span><span>    </span><span id="local-6989586621680058295"><span id="local-6989586621680058296"><span id="local-6989586621680058297"><span id="local-6989586621680058298"><span class="annot"><a href="#local-6989586621680057669"><span class="hs-identifier hs-type">aux</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Util.SOP.html#Index"><span class="hs-identifier hs-type">Index</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058298"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058297"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-481"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#AnnDecoder"><span class="hs-identifier hs-type">AnnDecoder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058296"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058297"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-482"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">K</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680058297"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-483"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">K</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Decoder</span></span><span> </span><span class="annot"><a href="#local-6989586621680058295"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/bytestring-0.10.12.0/src"><span class="hs-identifier hs-type">Lazy.ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#NS"><span class="hs-identifier hs-type">NS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058296"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058298"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680058297"><span class="hs-identifier hs-type">blk</span></a></span></span></span></span></span><span>
</span><span id="line-484"></span><span>    </span><span id="local-6989586621680057669"><span class="annot"><span class="annottext">aux :: Index xs blk
-&gt; AnnDecoder f blk
-&gt; K () blk
-&gt; K (Decoder s (ByteString -&gt; NS f xs)) blk
</span><a href="#local-6989586621680057669"><span class="hs-identifier hs-var hs-var">aux</span></a></span></span><span> </span><span id="local-6989586621680057668"><span class="annot"><span class="annottext">Index xs blk
</span><a href="#local-6989586621680057668"><span class="hs-identifier hs-var">index</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#AnnDecoder"><span class="hs-identifier hs-type">AnnDecoder</span></a></span><span> </span><span id="local-6989586621680057667"><span class="annot"><span class="annottext">forall s. Decoder s (ByteString -&gt; f blk)
</span><a href="#local-6989586621680057667"><span class="hs-identifier hs-var">dec</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">K</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Decoder s (ByteString -&gt; NS f xs)
-&gt; K (Decoder s (ByteString -&gt; NS f xs)) blk
forall k a (b :: k). a -&gt; K a b
</span><span class="hs-identifier hs-var">K</span></span><span> </span><span class="annot"><span class="annottext">(Decoder s (ByteString -&gt; NS f xs)
 -&gt; K (Decoder s (ByteString -&gt; NS f xs)) blk)
-&gt; Decoder s (ByteString -&gt; NS f xs)
-&gt; K (Decoder s (ByteString -&gt; NS f xs)) blk
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Index xs blk -&gt; f blk -&gt; NS f xs
forall k (f :: k -&gt; *) (x :: k) (xs :: [k]).
Index xs x -&gt; f x -&gt; NS f xs
</span><a href="Ouroboros.Consensus.Util.SOP.html#injectNS"><span class="hs-identifier hs-var">injectNS</span></a></span><span> </span><span class="annot"><span class="annottext">Index xs blk
</span><a href="#local-6989586621680057668"><span class="hs-identifier hs-var">index</span></a></span><span> </span><span class="annot"><span class="annottext">(f blk -&gt; NS f xs)
-&gt; (ByteString -&gt; f blk) -&gt; ByteString -&gt; NS f xs
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((ByteString -&gt; f blk) -&gt; ByteString -&gt; NS f xs)
-&gt; Decoder s (ByteString -&gt; f blk)
-&gt; Decoder s (ByteString -&gt; NS f xs)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Decoder s (ByteString -&gt; f blk)
forall s. Decoder s (ByteString -&gt; f blk)
</span><a href="#local-6989586621680057667"><span class="hs-identifier hs-var">dec</span></a></span><span>
</span><span id="line-485"></span><span>
</span><span id="line-486"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Dependent serialisation
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-489"></span><span>
</span><span id="line-490"></span><span id="local-6989586621680057664"><span id="local-6989586621680057665"><span id="local-6989586621680057666"><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#encodeNested"><span class="hs-identifier hs-type">encodeNested</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">All</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Storage.Serialisation.html#EncodeDiskDep"><span class="hs-identifier hs-type">EncodeDiskDep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Block.NestedContent.html#NestedCtxt"><span class="hs-identifier hs-type">NestedCtxt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057666"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680057665"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-491"></span><span>             </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Block.Abstract.html#CodecConfig"><span class="hs-identifier hs-type">CodecConfig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Basics.html#HardForkBlock"><span class="hs-identifier hs-type">HardForkBlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057665"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-492"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Block.NestedContent.html#NestedCtxt"><span class="hs-identifier hs-type">NestedCtxt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057666"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Basics.html#HardForkBlock"><span class="hs-identifier hs-type">HardForkBlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057665"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680057664"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-493"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680057664"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-494"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Encoding</span></span></span></span></span><span>
</span><span id="line-495"></span><span id="encodeNested"><span class="annot"><span class="annottext">encodeNested :: CodecConfig (HardForkBlock xs)
-&gt; NestedCtxt f (HardForkBlock xs) a -&gt; a -&gt; Encoding
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#encodeNested"><span class="hs-identifier hs-var hs-var">encodeNested</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680057663"><span class="annot"><span class="annottext">CodecConfig (HardForkBlock xs)
</span><a href="#local-6989586621680057663"><span class="hs-identifier hs-var">ccfg</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Block.NestedContent.html#NestedCtxt"><span class="hs-identifier hs-type">NestedCtxt</span></a></span><span> </span><span id="local-6989586621680057662"><span class="annot"><span class="annottext">NestedCtxt_ (HardForkBlock xs) f a
</span><a href="#local-6989586621680057662"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680057661"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680057661"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-496"></span><span>    </span><span class="annot"><span class="annottext">NP CodecConfig xs
-&gt; NestedCtxt_ (HardForkBlock xs) f a -&gt; a -&gt; Encoding
forall (f :: * -&gt; *) (xs' :: [*]) a.
All (EncodeDiskDep (NestedCtxt f)) xs' =&gt;
NP CodecConfig xs'
-&gt; NestedCtxt_ (HardForkBlock xs') f a -&gt; a -&gt; Encoding
</span><a href="#local-6989586621680057660"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PerEraCodecConfig xs -&gt; NP CodecConfig xs
forall (xs :: [*]). PerEraCodecConfig xs -&gt; NP CodecConfig xs
</span><a href="Ouroboros.Consensus.HardFork.Combinator.AcrossEras.html#getPerEraCodecConfig"><span class="hs-identifier hs-var hs-var">getPerEraCodecConfig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodecConfig (HardForkBlock xs) -&gt; PerEraCodecConfig xs
forall (xs :: [*]).
CodecConfig (HardForkBlock xs) -&gt; PerEraCodecConfig xs
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Basics.html#hardForkCodecConfigPerEra"><span class="hs-identifier hs-var hs-var">hardForkCodecConfigPerEra</span></a></span><span> </span><span class="annot"><span class="annottext">CodecConfig (HardForkBlock xs)
</span><a href="#local-6989586621680057663"><span class="hs-identifier hs-var">ccfg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NestedCtxt_ (HardForkBlock xs) f a
</span><a href="#local-6989586621680057662"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680057661"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-497"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-498"></span><span>    </span><span id="local-6989586621680058283"><span id="local-6989586621680058285"><span id="local-6989586621680058287"><span class="annot"><a href="#local-6989586621680057660"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">All</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Storage.Serialisation.html#EncodeDiskDep"><span class="hs-identifier hs-type">EncodeDiskDep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Block.NestedContent.html#NestedCtxt"><span class="hs-identifier hs-type">NestedCtxt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058287"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680058285"><span class="hs-identifier hs-type">xs'</span></a></span><span>
</span><span id="line-499"></span><span>       </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#NP"><span class="hs-identifier hs-type">NP</span></a></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Block.Abstract.html#CodecConfig"><span class="hs-identifier hs-type">CodecConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058285"><span class="hs-identifier hs-type">xs'</span></a></span><span>
</span><span id="line-500"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Block.NestedContent.html#NestedCtxt_"><span class="hs-identifier hs-type">NestedCtxt_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Basics.html#HardForkBlock"><span class="hs-identifier hs-type">HardForkBlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058285"><span class="hs-identifier hs-type">xs'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680058287"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058283"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-501"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680058283"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Encoding</span></span></span></span></span><span>
</span><span id="line-502"></span><span>    </span><span id="local-6989586621680057660"><span class="annot"><span class="annottext">go :: NP CodecConfig xs'
-&gt; NestedCtxt_ (HardForkBlock xs') f a -&gt; a -&gt; Encoding
</span><a href="#local-6989586621680057660"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><span class="annottext">NP CodecConfig xs'
</span><a href="Data.SOP.Strict.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span>       </span><span id="local-6989586621680057659"><span class="annot"><span class="annottext">NestedCtxt_ (HardForkBlock xs') f a
</span><a href="#local-6989586621680057659"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">NestedCtxt_ (HardForkBlock xs') f a
</span><a href="#local-6989586621680057659"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>
</span><span id="line-503"></span><span>    </span><span class="annot"><a href="#local-6989586621680057660"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680057658"><span class="annot"><span class="annottext">CodecConfig x
</span><a href="#local-6989586621680057658"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#%3A%2A"><span class="hs-operator hs-type">:*</span></a></span><span> </span><span class="annot"><span class="annottext">NP CodecConfig xs
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Block.html#NCZ"><span class="hs-identifier hs-type">NCZ</span></a></span><span> </span><span id="local-6989586621680057657"><span class="annot"><a href="#local-6989586621680057657"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CodecConfig x -&gt; NestedCtxt f x a -&gt; a -&gt; Encoding
forall (f :: * -&gt; * -&gt; *) blk a.
EncodeDiskDep f blk =&gt;
CodecConfig blk -&gt; f blk a -&gt; a -&gt; Encoding
</span><a href="Ouroboros.Consensus.Storage.Serialisation.html#encodeDiskDep"><span class="hs-identifier hs-var">encodeDiskDep</span></a></span><span> </span><span class="annot"><span class="annottext">CodecConfig x
</span><a href="#local-6989586621680057658"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NestedCtxt_ x f a -&gt; NestedCtxt f x a
forall (f :: * -&gt; *) blk a.
NestedCtxt_ blk f a -&gt; NestedCtxt f blk a
</span><a href="Ouroboros.Consensus.Block.NestedContent.html#NestedCtxt"><span class="hs-identifier hs-var">NestedCtxt</span></a></span><span> </span><span class="annot"><span class="annottext">NestedCtxt_ x f a
</span><a href="#local-6989586621680057657"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-504"></span><span>    </span><span class="annot"><a href="#local-6989586621680057660"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodecConfig x
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#%3A%2A"><span class="hs-operator hs-type">:*</span></a></span><span> </span><span id="local-6989586621680057655"><span class="annot"><span class="annottext">NP CodecConfig xs
</span><a href="#local-6989586621680057655"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Block.html#NCS"><span class="hs-identifier hs-type">NCS</span></a></span><span> </span><span id="local-6989586621680057654"><span class="annot"><a href="#local-6989586621680057654"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NP CodecConfig xs
-&gt; NestedCtxt_ (HardForkBlock xs) f a -&gt; a -&gt; Encoding
forall (f :: * -&gt; *) (xs' :: [*]) a.
All (EncodeDiskDep (NestedCtxt f)) xs' =&gt;
NP CodecConfig xs'
-&gt; NestedCtxt_ (HardForkBlock xs') f a -&gt; a -&gt; Encoding
</span><a href="#local-6989586621680057660"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">NP CodecConfig xs
</span><a href="#local-6989586621680057655"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">NestedCtxt_ (HardForkBlock xs) f a
NestedCtxt_ (HardForkBlock xs) f a
</span><a href="#local-6989586621680057654"><span class="hs-identifier hs-var">ctxt</span></a></span><span>
</span><span id="line-505"></span><span>
</span><span id="line-506"></span><span id="local-6989586621680057651"><span id="local-6989586621680057652"><span id="local-6989586621680057653"><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#decodeNested"><span class="hs-identifier hs-type">decodeNested</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">All</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Storage.Serialisation.html#DecodeDiskDep"><span class="hs-identifier hs-type">DecodeDiskDep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Block.NestedContent.html#NestedCtxt"><span class="hs-identifier hs-type">NestedCtxt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057653"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680057652"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-507"></span><span>             </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Block.Abstract.html#CodecConfig"><span class="hs-identifier hs-type">CodecConfig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Basics.html#HardForkBlock"><span class="hs-identifier hs-type">HardForkBlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057652"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-508"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Block.NestedContent.html#NestedCtxt"><span class="hs-identifier hs-type">NestedCtxt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057653"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Basics.html#HardForkBlock"><span class="hs-identifier hs-type">HardForkBlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057652"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680057651"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-509"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680058267"><span class="annot"><a href="#local-6989586621680058267"><span class="hs-identifier hs-type">s</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Decoder</span></span><span> </span><span class="annot"><a href="#local-6989586621680058267"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/bytestring-0.10.12.0/src"><span class="hs-identifier hs-type">Lazy.ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680057651"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-510"></span><span id="decodeNested"><span class="annot"><span class="annottext">decodeNested :: CodecConfig (HardForkBlock xs)
-&gt; NestedCtxt f (HardForkBlock xs) a
-&gt; forall s. Decoder s (ByteString -&gt; a)
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#decodeNested"><span class="hs-identifier hs-var hs-var">decodeNested</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680057650"><span class="annot"><span class="annottext">CodecConfig (HardForkBlock xs)
</span><a href="#local-6989586621680057650"><span class="hs-identifier hs-var">ccfg</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Block.NestedContent.html#NestedCtxt"><span class="hs-identifier hs-type">NestedCtxt</span></a></span><span> </span><span id="local-6989586621680057649"><span class="annot"><span class="annottext">NestedCtxt_ (HardForkBlock xs) f a
</span><a href="#local-6989586621680057649"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-511"></span><span>    </span><span class="annot"><span class="annottext">NP CodecConfig xs
-&gt; NestedCtxt_ (HardForkBlock xs) f a
-&gt; Decoder s (ByteString -&gt; a)
forall (f :: * -&gt; *) (xs' :: [*]) a s.
All (DecodeDiskDep (NestedCtxt f)) xs' =&gt;
NP CodecConfig xs'
-&gt; NestedCtxt_ (HardForkBlock xs') f a
-&gt; Decoder s (ByteString -&gt; a)
</span><a href="#local-6989586621680057648"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PerEraCodecConfig xs -&gt; NP CodecConfig xs
forall (xs :: [*]). PerEraCodecConfig xs -&gt; NP CodecConfig xs
</span><a href="Ouroboros.Consensus.HardFork.Combinator.AcrossEras.html#getPerEraCodecConfig"><span class="hs-identifier hs-var hs-var">getPerEraCodecConfig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodecConfig (HardForkBlock xs) -&gt; PerEraCodecConfig xs
forall (xs :: [*]).
CodecConfig (HardForkBlock xs) -&gt; PerEraCodecConfig xs
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Basics.html#hardForkCodecConfigPerEra"><span class="hs-identifier hs-var hs-var">hardForkCodecConfigPerEra</span></a></span><span> </span><span class="annot"><span class="annottext">CodecConfig (HardForkBlock xs)
</span><a href="#local-6989586621680057650"><span class="hs-identifier hs-var">ccfg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NestedCtxt_ (HardForkBlock xs) f a
</span><a href="#local-6989586621680057649"><span class="hs-identifier hs-var">ctxt</span></a></span><span>
</span><span id="line-512"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-513"></span><span>    </span><span id="local-6989586621680058261"><span id="local-6989586621680058262"><span id="local-6989586621680058263"><span id="local-6989586621680058265"><span class="annot"><a href="#local-6989586621680057648"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">All</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Storage.Serialisation.html#DecodeDiskDep"><span class="hs-identifier hs-type">DecodeDiskDep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Block.NestedContent.html#NestedCtxt"><span class="hs-identifier hs-type">NestedCtxt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058265"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680058263"><span class="hs-identifier hs-type">xs'</span></a></span><span>
</span><span id="line-514"></span><span>       </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#NP"><span class="hs-identifier hs-type">NP</span></a></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Block.Abstract.html#CodecConfig"><span class="hs-identifier hs-type">CodecConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058263"><span class="hs-identifier hs-type">xs'</span></a></span><span>
</span><span id="line-515"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Block.NestedContent.html#NestedCtxt_"><span class="hs-identifier hs-type">NestedCtxt_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Basics.html#HardForkBlock"><span class="hs-identifier hs-type">HardForkBlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058263"><span class="hs-identifier hs-type">xs'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680058265"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058262"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-516"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Decoder</span></span><span> </span><span class="annot"><a href="#local-6989586621680058261"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/bytestring-0.10.12.0/src"><span class="hs-identifier hs-type">Lazy.ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680058262"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-517"></span><span>    </span><span id="local-6989586621680057648"><span class="annot"><span class="annottext">go :: NP CodecConfig xs'
-&gt; NestedCtxt_ (HardForkBlock xs') f a
-&gt; Decoder s (ByteString -&gt; a)
</span><a href="#local-6989586621680057648"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><span class="annottext">NP CodecConfig xs'
</span><a href="Data.SOP.Strict.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span>       </span><span id="local-6989586621680057647"><span class="annot"><span class="annottext">NestedCtxt_ (HardForkBlock xs') f a
</span><a href="#local-6989586621680057647"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">NestedCtxt_ (HardForkBlock xs') f a
</span><a href="#local-6989586621680057647"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>
</span><span id="line-518"></span><span>    </span><span class="annot"><a href="#local-6989586621680057648"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680057646"><span class="annot"><span class="annottext">CodecConfig x
</span><a href="#local-6989586621680057646"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#%3A%2A"><span class="hs-operator hs-type">:*</span></a></span><span> </span><span class="annot"><span class="annottext">NP CodecConfig xs
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Block.html#NCZ"><span class="hs-identifier hs-type">NCZ</span></a></span><span> </span><span id="local-6989586621680057645"><span class="annot"><a href="#local-6989586621680057645"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CodecConfig x
-&gt; NestedCtxt f x a -&gt; forall s. Decoder s (ByteString -&gt; a)
forall (f :: * -&gt; * -&gt; *) blk a.
DecodeDiskDep f blk =&gt;
CodecConfig blk -&gt; f blk a -&gt; forall s. Decoder s (ByteString -&gt; a)
</span><a href="Ouroboros.Consensus.Storage.Serialisation.html#decodeDiskDep"><span class="hs-identifier hs-var">decodeDiskDep</span></a></span><span> </span><span class="annot"><span class="annottext">CodecConfig x
</span><a href="#local-6989586621680057646"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NestedCtxt_ x f a -&gt; NestedCtxt f x a
forall (f :: * -&gt; *) blk a.
NestedCtxt_ blk f a -&gt; NestedCtxt f blk a
</span><a href="Ouroboros.Consensus.Block.NestedContent.html#NestedCtxt"><span class="hs-identifier hs-var">NestedCtxt</span></a></span><span> </span><span class="annot"><span class="annottext">NestedCtxt_ x f a
</span><a href="#local-6989586621680057645"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-519"></span><span>    </span><span class="annot"><a href="#local-6989586621680057648"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodecConfig x
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#%3A%2A"><span class="hs-operator hs-type">:*</span></a></span><span> </span><span id="local-6989586621680057643"><span class="annot"><span class="annottext">NP CodecConfig xs
</span><a href="#local-6989586621680057643"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Block.html#NCS"><span class="hs-identifier hs-type">NCS</span></a></span><span> </span><span id="local-6989586621680057642"><span class="annot"><a href="#local-6989586621680057642"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NP CodecConfig xs
-&gt; NestedCtxt_ (HardForkBlock xs) f a
-&gt; Decoder s (ByteString -&gt; a)
forall (f :: * -&gt; *) (xs' :: [*]) a s.
All (DecodeDiskDep (NestedCtxt f)) xs' =&gt;
NP CodecConfig xs'
-&gt; NestedCtxt_ (HardForkBlock xs') f a
-&gt; Decoder s (ByteString -&gt; a)
</span><a href="#local-6989586621680057648"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">NP CodecConfig xs
</span><a href="#local-6989586621680057643"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">NestedCtxt_ (HardForkBlock xs) f a
NestedCtxt_ (HardForkBlock xs) f a
</span><a href="#local-6989586621680057642"><span class="hs-identifier hs-var">ctxt</span></a></span><span>
</span><span id="line-520"></span><span>
</span><span id="line-521"></span><span id="local-6989586621680057640"><span id="local-6989586621680057641"><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#encodeNestedCtxt"><span class="hs-identifier hs-type">encodeNestedCtxt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">All</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Storage.Serialisation.html#EncodeDiskDepIx"><span class="hs-identifier hs-type">EncodeDiskDepIx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Block.NestedContent.html#NestedCtxt"><span class="hs-identifier hs-type">NestedCtxt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057641"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680057640"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-522"></span><span>                 </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Block.Abstract.html#CodecConfig"><span class="hs-identifier hs-type">CodecConfig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Basics.html#HardForkBlock"><span class="hs-identifier hs-type">HardForkBlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057640"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-523"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Util.html#SomeSecond"><span class="hs-identifier hs-type">SomeSecond</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Block.NestedContent.html#NestedCtxt"><span class="hs-identifier hs-type">NestedCtxt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057641"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Basics.html#HardForkBlock"><span class="hs-identifier hs-type">HardForkBlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057640"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-524"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Encoding</span></span></span></span><span>
</span><span id="line-525"></span><span id="encodeNestedCtxt"><span class="annot"><span class="annottext">encodeNestedCtxt :: CodecConfig (HardForkBlock xs)
-&gt; SomeSecond (NestedCtxt f) (HardForkBlock xs) -&gt; Encoding
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#encodeNestedCtxt"><span class="hs-identifier hs-var hs-var">encodeNestedCtxt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680057639"><span class="annot"><span class="annottext">CodecConfig (HardForkBlock xs)
</span><a href="#local-6989586621680057639"><span class="hs-identifier hs-var">ccfg</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Util.html#SomeSecond"><span class="hs-identifier hs-type">SomeSecond</span></a></span><span> </span><span id="local-6989586621680057638"><span class="annot"><span class="annottext">NestedCtxt f (HardForkBlock xs) b
</span><a href="#local-6989586621680057638"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-526"></span><span>    </span><span class="annot"><span class="annottext">NP CodecConfig xs
-&gt; NP (K Word8) xs
-&gt; NestedCtxt_ (HardForkBlock xs) f b
-&gt; Encoding
forall (f :: * -&gt; *) (xs' :: [*]) a.
All (EncodeDiskDepIx (NestedCtxt f)) xs' =&gt;
NP CodecConfig xs'
-&gt; NP (K Word8) xs'
-&gt; NestedCtxt_ (HardForkBlock xs') f a
-&gt; Encoding
</span><a href="#local-6989586621680057637"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PerEraCodecConfig xs -&gt; NP CodecConfig xs
forall (xs :: [*]). PerEraCodecConfig xs -&gt; NP CodecConfig xs
</span><a href="Ouroboros.Consensus.HardFork.Combinator.AcrossEras.html#getPerEraCodecConfig"><span class="hs-identifier hs-var hs-var">getPerEraCodecConfig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodecConfig (HardForkBlock xs) -&gt; PerEraCodecConfig xs
forall (xs :: [*]).
CodecConfig (HardForkBlock xs) -&gt; PerEraCodecConfig xs
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Basics.html#hardForkCodecConfigPerEra"><span class="hs-identifier hs-var hs-var">hardForkCodecConfigPerEra</span></a></span><span> </span><span class="annot"><span class="annottext">CodecConfig (HardForkBlock xs)
</span><a href="#local-6989586621680057639"><span class="hs-identifier hs-var">ccfg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-527"></span><span>       </span><span class="annot"><span class="annottext">NP (K Word8) xs
forall k (xs :: [k]). SListI xs =&gt; NP (K Word8) xs
</span><a href="Ouroboros.Consensus.Util.SOP.html#npWithIndices"><span class="hs-identifier hs-var">npWithIndices</span></a></span><span>
</span><span id="line-528"></span><span>       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NestedCtxt f (HardForkBlock xs) b
-&gt; NestedCtxt_ (HardForkBlock xs) f b
forall (f :: * -&gt; *) blk a.
NestedCtxt f blk a -&gt; NestedCtxt_ blk f a
</span><a href="Ouroboros.Consensus.Block.NestedContent.html#flipNestedCtxt"><span class="hs-identifier hs-var hs-var">flipNestedCtxt</span></a></span><span> </span><span class="annot"><span class="annottext">NestedCtxt f (HardForkBlock xs) b
</span><a href="#local-6989586621680057638"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-529"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-530"></span><span>    </span><span id="local-6989586621680058240"><span id="local-6989586621680058241"><span id="local-6989586621680058243"><span class="annot"><a href="#local-6989586621680057637"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">All</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Storage.Serialisation.html#EncodeDiskDepIx"><span class="hs-identifier hs-type">EncodeDiskDepIx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Block.NestedContent.html#NestedCtxt"><span class="hs-identifier hs-type">NestedCtxt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058243"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680058241"><span class="hs-identifier hs-type">xs'</span></a></span><span>
</span><span id="line-531"></span><span>       </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#NP"><span class="hs-identifier hs-type">NP</span></a></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Block.Abstract.html#CodecConfig"><span class="hs-identifier hs-type">CodecConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058241"><span class="hs-identifier hs-type">xs'</span></a></span><span>
</span><span id="line-532"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#NP"><span class="hs-identifier hs-type">NP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">K</span></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Word8</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680058241"><span class="hs-identifier hs-type">xs'</span></a></span><span>
</span><span id="line-533"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Block.NestedContent.html#NestedCtxt_"><span class="hs-identifier hs-type">NestedCtxt_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Basics.html#HardForkBlock"><span class="hs-identifier hs-type">HardForkBlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058241"><span class="hs-identifier hs-type">xs'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680058243"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058240"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-534"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Encoding</span></span></span></span></span><span>
</span><span id="line-535"></span><span>    </span><span id="local-6989586621680057637"><span class="annot"><span class="annottext">go :: NP CodecConfig xs'
-&gt; NP (K Word8) xs'
-&gt; NestedCtxt_ (HardForkBlock xs') f a
-&gt; Encoding
</span><a href="#local-6989586621680057637"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><span class="annottext">NP CodecConfig xs'
</span><a href="Data.SOP.Strict.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span>       </span><span class="annot"><span class="annottext">NP (K Word8) xs'
</span><span class="hs-identifier">_</span></span><span>           </span><span id="local-6989586621680057634"><span class="annot"><span class="annottext">NestedCtxt_ (HardForkBlock xs') f a
</span><a href="#local-6989586621680057634"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">NestedCtxt_ (HardForkBlock xs') f a
</span><a href="#local-6989586621680057634"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>
</span><span id="line-536"></span><span>    </span><span class="annot"><a href="#local-6989586621680057637"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodecConfig x
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#%3A%2A"><span class="hs-operator hs-type">:*</span></a></span><span> </span><span id="local-6989586621680057633"><span class="annot"><span class="annottext">NP CodecConfig xs
</span><a href="#local-6989586621680057633"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">K Word8 x
</span><span class="hs-identifier">_</span></span><span>   </span><span class="annot"><a href="Data.SOP.Strict.html#%3A%2A"><span class="hs-operator hs-type">:*</span></a></span><span> </span><span id="local-6989586621680057632"><span class="annot"><span class="annottext">NP (K Word8) xs
</span><a href="#local-6989586621680057632"><span class="hs-identifier hs-var">is</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Block.html#NCS"><span class="hs-identifier hs-type">NCS</span></a></span><span> </span><span id="local-6989586621680057631"><span class="annot"><a href="#local-6989586621680057631"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NP CodecConfig xs
-&gt; NP (K Word8) xs
-&gt; NestedCtxt_ (HardForkBlock xs) f a
-&gt; Encoding
forall (f :: * -&gt; *) (xs' :: [*]) a.
All (EncodeDiskDepIx (NestedCtxt f)) xs' =&gt;
NP CodecConfig xs'
-&gt; NP (K Word8) xs'
-&gt; NestedCtxt_ (HardForkBlock xs') f a
-&gt; Encoding
</span><a href="#local-6989586621680057637"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">NP CodecConfig xs
</span><a href="#local-6989586621680057633"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">NP (K Word8) xs
NP (K Word8) xs
</span><a href="#local-6989586621680057632"><span class="hs-identifier hs-var">is</span></a></span><span> </span><span class="annot"><span class="annottext">NestedCtxt_ (HardForkBlock xs) f a
NestedCtxt_ (HardForkBlock xs) f a
</span><a href="#local-6989586621680057631"><span class="hs-identifier hs-var">ctxt</span></a></span><span>
</span><span id="line-537"></span><span>    </span><span class="annot"><a href="#local-6989586621680057637"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680057630"><span class="annot"><span class="annottext">CodecConfig x
</span><a href="#local-6989586621680057630"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#%3A%2A"><span class="hs-operator hs-type">:*</span></a></span><span> </span><span class="annot"><span class="annottext">NP CodecConfig xs
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">K</span></span><span> </span><span id="local-6989586621680057629"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621680057629"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#%3A%2A"><span class="hs-operator hs-type">:*</span></a></span><span> </span><span class="annot"><span class="annottext">NP (K Word8) xs
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Block.html#NCZ"><span class="hs-identifier hs-type">NCZ</span></a></span><span> </span><span id="local-6989586621680057628"><span class="annot"><a href="#local-6989586621680057628"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Encoding] -&gt; Encoding
forall a. Monoid a =&gt; [a] -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mconcat</span></a></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-538"></span><span>          </span><span class="annot"><span class="annottext">Word -&gt; Encoding
</span><span class="hs-identifier hs-var">Enc.encodeListLen</span></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">2</span></span><span>
</span><span id="line-539"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Encoding
forall a. Serialise a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">Serialise.encode</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621680057629"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-540"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CodecConfig x -&gt; SomeSecond (NestedCtxt f) x -&gt; Encoding
forall (f :: * -&gt; * -&gt; *) blk.
EncodeDiskDepIx f blk =&gt;
CodecConfig blk -&gt; SomeSecond f blk -&gt; Encoding
</span><a href="Ouroboros.Consensus.Storage.Serialisation.html#encodeDiskDepIx"><span class="hs-identifier hs-var">encodeDiskDepIx</span></a></span><span> </span><span class="annot"><span class="annottext">CodecConfig x
</span><a href="#local-6989586621680057630"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NestedCtxt f x a -&gt; SomeSecond (NestedCtxt f) x
forall (f :: * -&gt; * -&gt; *) a b. f a b -&gt; SomeSecond f a
</span><a href="Ouroboros.Consensus.Util.html#SomeSecond"><span class="hs-identifier hs-var">SomeSecond</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NestedCtxt_ x f a -&gt; NestedCtxt f x a
forall (f :: * -&gt; *) blk a.
NestedCtxt_ blk f a -&gt; NestedCtxt f blk a
</span><a href="Ouroboros.Consensus.Block.NestedContent.html#NestedCtxt"><span class="hs-identifier hs-var">NestedCtxt</span></a></span><span> </span><span class="annot"><span class="annottext">NestedCtxt_ x f a
</span><a href="#local-6989586621680057628"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-541"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-542"></span><span>
</span><span id="line-543"></span><span id="local-6989586621680057624"><span id="local-6989586621680057625"><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#decodeNestedCtxt"><span class="hs-identifier hs-type">decodeNestedCtxt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">All</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Storage.Serialisation.html#DecodeDiskDepIx"><span class="hs-identifier hs-type">DecodeDiskDepIx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Block.NestedContent.html#NestedCtxt"><span class="hs-identifier hs-type">NestedCtxt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057625"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680057624"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-544"></span><span>                 </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Block.Abstract.html#CodecConfig"><span class="hs-identifier hs-type">CodecConfig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Basics.html#HardForkBlock"><span class="hs-identifier hs-type">HardForkBlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057624"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-545"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680058219"><span class="annot"><a href="#local-6989586621680058219"><span class="hs-identifier hs-type">s</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Decoder</span></span><span> </span><span class="annot"><a href="#local-6989586621680058219"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Util.html#SomeSecond"><span class="hs-identifier hs-type">SomeSecond</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Block.NestedContent.html#NestedCtxt"><span class="hs-identifier hs-type">NestedCtxt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057625"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Basics.html#HardForkBlock"><span class="hs-identifier hs-type">HardForkBlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057624"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-546"></span><span id="decodeNestedCtxt"><span class="annot"><span class="annottext">decodeNestedCtxt :: CodecConfig (HardForkBlock xs)
-&gt; forall s.
   Decoder s (SomeSecond (NestedCtxt f) (HardForkBlock xs))
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#decodeNestedCtxt"><span class="hs-identifier hs-var hs-var">decodeNestedCtxt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680057623"><span class="annot"><span class="annottext">CodecConfig (HardForkBlock xs)
</span><a href="#local-6989586621680057623"><span class="hs-identifier hs-var">ccfg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-547"></span><span>    </span><span class="annot"><span class="annottext">Text -&gt; Int -&gt; Decoder s ()
forall s. Text -&gt; Int -&gt; Decoder s ()
</span><span class="hs-identifier hs-var">enforceSize</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;decodeNestedCtxt&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-548"></span><span>    </span><span id="local-6989586621680057622"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621680057622"><span class="hs-identifier hs-var">tag</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Decoder s Word8
forall a s. Serialise a =&gt; Decoder s a
</span><span class="hs-identifier hs-var">Serialise.decode</span></span><span>
</span><span id="line-549"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Maybe (NS (K ()) xs)
forall k (xs :: [k]). SListI xs =&gt; Word8 -&gt; Maybe (NS (K ()) xs)
</span><a href="Ouroboros.Consensus.Util.SOP.html#nsFromIndex"><span class="hs-identifier hs-var">nsFromIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621680057622"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-550"></span><span>      </span><span class="annot"><span class="annottext">Maybe (NS (K ()) xs)
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Decoder s (SomeSecond (NestedCtxt f) (HardForkBlock xs))
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">(String
 -&gt; Decoder s (SomeSecond (NestedCtxt f) (HardForkBlock xs)))
-&gt; String
-&gt; Decoder s (SomeSecond (NestedCtxt f) (HardForkBlock xs))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;decodeNestedCtxt: invalid tag &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621680057622"><span class="hs-identifier hs-var">tag</span></a></span><span>
</span><span id="line-551"></span><span>      </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680057620"><span class="annot"><span class="annottext">NS (K ()) xs
</span><a href="#local-6989586621680057620"><span class="hs-identifier hs-var">ns</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-552"></span><span>        </span><span class="annot"><span class="annottext">NP CodecConfig xs
-&gt; NS (K ()) xs
-&gt; forall s.
   Decoder s (SomeSecond (NestedCtxt f) (HardForkBlock xs))
forall (f :: * -&gt; *) (xs' :: [*]).
All (DecodeDiskDepIx (NestedCtxt f)) xs' =&gt;
NP CodecConfig xs'
-&gt; NS (K ()) xs'
-&gt; forall s.
   Decoder s (SomeSecond (NestedCtxt f) (HardForkBlock xs'))
</span><a href="#local-6989586621680057619"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PerEraCodecConfig xs -&gt; NP CodecConfig xs
forall (xs :: [*]). PerEraCodecConfig xs -&gt; NP CodecConfig xs
</span><a href="Ouroboros.Consensus.HardFork.Combinator.AcrossEras.html#getPerEraCodecConfig"><span class="hs-identifier hs-var hs-var">getPerEraCodecConfig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodecConfig (HardForkBlock xs) -&gt; PerEraCodecConfig xs
forall (xs :: [*]).
CodecConfig (HardForkBlock xs) -&gt; PerEraCodecConfig xs
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Basics.html#hardForkCodecConfigPerEra"><span class="hs-identifier hs-var hs-var">hardForkCodecConfigPerEra</span></a></span><span> </span><span class="annot"><span class="annottext">CodecConfig (HardForkBlock xs)
</span><a href="#local-6989586621680057623"><span class="hs-identifier hs-var">ccfg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NS (K ()) xs
</span><a href="#local-6989586621680057620"><span class="hs-identifier hs-var">ns</span></a></span><span>
</span><span id="line-553"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-554"></span><span>    </span><span id="local-6989586621680058213"><span id="local-6989586621680058215"><span class="annot"><a href="#local-6989586621680057619"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">All</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Storage.Serialisation.html#DecodeDiskDepIx"><span class="hs-identifier hs-type">DecodeDiskDepIx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Block.NestedContent.html#NestedCtxt"><span class="hs-identifier hs-type">NestedCtxt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058215"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680058213"><span class="hs-identifier hs-type">xs'</span></a></span><span>
</span><span id="line-555"></span><span>       </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#NP"><span class="hs-identifier hs-type">NP</span></a></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Block.Abstract.html#CodecConfig"><span class="hs-identifier hs-type">CodecConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058213"><span class="hs-identifier hs-type">xs'</span></a></span><span>
</span><span id="line-556"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#NS"><span class="hs-identifier hs-type">NS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">K</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680058213"><span class="hs-identifier hs-type">xs'</span></a></span><span>
</span><span id="line-557"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680058212"><span class="annot"><a href="#local-6989586621680058212"><span class="hs-identifier hs-type">s</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Decoder</span></span><span> </span><span class="annot"><a href="#local-6989586621680058212"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Util.html#SomeSecond"><span class="hs-identifier hs-type">SomeSecond</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Block.NestedContent.html#NestedCtxt"><span class="hs-identifier hs-type">NestedCtxt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058215"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Basics.html#HardForkBlock"><span class="hs-identifier hs-type">HardForkBlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058213"><span class="hs-identifier hs-type">xs'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-558"></span><span>    </span><span id="local-6989586621680057619"><span class="annot"><span class="annottext">go :: NP CodecConfig xs'
-&gt; NS (K ()) xs'
-&gt; forall s.
   Decoder s (SomeSecond (NestedCtxt f) (HardForkBlock xs'))
</span><a href="#local-6989586621680057619"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><span class="annottext">NP CodecConfig xs'
</span><a href="Data.SOP.Strict.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span>       </span><span id="local-6989586621680057618"><span class="annot"><span class="annottext">NS (K ()) xs'
</span><a href="#local-6989586621680057618"><span class="hs-identifier hs-var">i</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">NS (K ()) xs'
</span><a href="#local-6989586621680057618"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>
</span><span id="line-559"></span><span>    </span><span class="annot"><a href="#local-6989586621680057619"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680057617"><span class="annot"><span class="annottext">CodecConfig x
</span><a href="#local-6989586621680057617"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#%3A%2A"><span class="hs-operator hs-type">:*</span></a></span><span> </span><span class="annot"><span class="annottext">NP CodecConfig xs
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Strict.html#Z"><span class="hs-identifier hs-type">Z</span></a></span><span> </span><span class="annot"><span class="annottext">K () x
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall a.
 NestedCtxt_ x f a -&gt; NestedCtxt_ (HardForkBlock xs') f a)
-&gt; SomeSecond (NestedCtxt f) x
-&gt; SomeSecond (NestedCtxt f) (HardForkBlock xs')
forall blk (f :: * -&gt; *) blk' (f' :: * -&gt; *).
(forall a. NestedCtxt_ blk f a -&gt; NestedCtxt_ blk' f' a)
-&gt; SomeSecond (NestedCtxt f) blk -&gt; SomeSecond (NestedCtxt f') blk'
</span><a href="Ouroboros.Consensus.Block.NestedContent.html#mapSomeNestedCtxt"><span class="hs-identifier hs-var">mapSomeNestedCtxt</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. NestedCtxt_ x f a -&gt; NestedCtxt_ (HardForkBlock xs') f a
forall x (f :: * -&gt; *) a (xs :: [*]).
NestedCtxt_ x f a -&gt; NestedCtxt_ (HardForkBlock (x : xs)) f a
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Block.html#NCZ"><span class="hs-identifier hs-var">NCZ</span></a></span><span> </span><span class="annot"><span class="annottext">(SomeSecond (NestedCtxt f) x
 -&gt; SomeSecond (NestedCtxt f) (HardForkBlock xs'))
-&gt; Decoder s (SomeSecond (NestedCtxt f) x)
-&gt; Decoder s (SomeSecond (NestedCtxt f) (HardForkBlock xs'))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">CodecConfig x -&gt; Decoder s (SomeSecond (NestedCtxt f) x)
forall (f :: * -&gt; * -&gt; *) blk s.
DecodeDiskDepIx f blk =&gt;
CodecConfig blk -&gt; Decoder s (SomeSecond f blk)
</span><a href="Ouroboros.Consensus.Storage.Serialisation.html#decodeDiskDepIx"><span class="hs-identifier hs-var">decodeDiskDepIx</span></a></span><span> </span><span class="annot"><span class="annottext">CodecConfig x
</span><a href="#local-6989586621680057617"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-560"></span><span>    </span><span class="annot"><a href="#local-6989586621680057619"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodecConfig x
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#%3A%2A"><span class="hs-operator hs-type">:*</span></a></span><span> </span><span id="local-6989586621680057614"><span class="annot"><span class="annottext">NP CodecConfig xs
</span><a href="#local-6989586621680057614"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Strict.html#S"><span class="hs-identifier hs-type">S</span></a></span><span> </span><span id="local-6989586621680057613"><span class="annot"><span class="annottext">NS (K ()) xs
</span><a href="#local-6989586621680057613"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall a.
 NestedCtxt_ (HardForkBlock xs) f a
 -&gt; NestedCtxt_ (HardForkBlock xs') f a)
-&gt; SomeSecond (NestedCtxt f) (HardForkBlock xs)
-&gt; SomeSecond (NestedCtxt f) (HardForkBlock xs')
forall blk (f :: * -&gt; *) blk' (f' :: * -&gt; *).
(forall a. NestedCtxt_ blk f a -&gt; NestedCtxt_ blk' f' a)
-&gt; SomeSecond (NestedCtxt f) blk -&gt; SomeSecond (NestedCtxt f') blk'
</span><a href="Ouroboros.Consensus.Block.NestedContent.html#mapSomeNestedCtxt"><span class="hs-identifier hs-var">mapSomeNestedCtxt</span></a></span><span> </span><span class="annot"><span class="annottext">forall (xs :: [*]) (f :: * -&gt; *) a x.
NestedCtxt_ (HardForkBlock xs) f a
-&gt; NestedCtxt_ (HardForkBlock (x : xs)) f a
forall a.
NestedCtxt_ (HardForkBlock xs) f a
-&gt; NestedCtxt_ (HardForkBlock xs') f a
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Block.html#NCS"><span class="hs-identifier hs-var">NCS</span></a></span><span> </span><span class="annot"><span class="annottext">(SomeSecond (NestedCtxt f) (HardForkBlock xs)
 -&gt; SomeSecond (NestedCtxt f) (HardForkBlock xs'))
-&gt; Decoder s (SomeSecond (NestedCtxt f) (HardForkBlock xs))
-&gt; Decoder s (SomeSecond (NestedCtxt f) (HardForkBlock xs'))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">NP CodecConfig xs
-&gt; NS (K ()) xs
-&gt; forall s.
   Decoder s (SomeSecond (NestedCtxt f) (HardForkBlock xs))
forall (f :: * -&gt; *) (xs' :: [*]).
All (DecodeDiskDepIx (NestedCtxt f)) xs' =&gt;
NP CodecConfig xs'
-&gt; NS (K ()) xs'
-&gt; forall s.
   Decoder s (SomeSecond (NestedCtxt f) (HardForkBlock xs'))
</span><a href="#local-6989586621680057619"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">NP CodecConfig xs
</span><a href="#local-6989586621680057614"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">NS (K ()) xs
NS (K ()) xs
</span><a href="#local-6989586621680057613"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-561"></span><span>
</span><span id="line-562"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Serialisation of 'MismatchEraInfo'

  We have to be careful here not to introduce any additional wrapping when
  using 'HardForkNodeToClientDisabled'.
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-568"></span><span>
</span><span id="line-569"></span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#encodeEitherMismatch"><span class="hs-identifier hs-type">encodeEitherMismatch</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680057612"><span class="annot"><a href="#local-6989586621680057612"><span class="hs-identifier hs-type">xs</span></a></span></span><span> </span><span id="local-6989586621680057611"><span class="annot"><a href="#local-6989586621680057611"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SListI</span></span><span> </span><span class="annot"><a href="#local-6989586621680057612"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-570"></span><span>                     </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Node.NetworkProtocolVersion.html#BlockNodeToClientVersion"><span class="hs-identifier hs-type">BlockNodeToClientVersion</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Basics.html#HardForkBlock"><span class="hs-identifier hs-type">HardForkBlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057612"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-571"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680057611"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Encoding</span></span><span class="hs-special">)</span><span>
</span><span id="line-572"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.AcrossEras.html#MismatchEraInfo"><span class="hs-identifier hs-type">MismatchEraInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057612"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680057611"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Encoding</span></span><span class="hs-special">)</span><span>
</span><span id="line-573"></span><span id="encodeEitherMismatch"><span class="annot"><span class="annottext">encodeEitherMismatch :: BlockNodeToClientVersion (HardForkBlock xs)
-&gt; (a -&gt; Encoding) -&gt; Either (MismatchEraInfo xs) a -&gt; Encoding
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#encodeEitherMismatch"><span class="hs-identifier hs-var hs-var">encodeEitherMismatch</span></a></span></span><span> </span><span id="local-6989586621680057610"><span class="annot"><span class="annottext">BlockNodeToClientVersion (HardForkBlock xs)
</span><a href="#local-6989586621680057610"><span class="hs-identifier hs-var">version</span></a></span></span><span> </span><span id="local-6989586621680057609"><span class="annot"><span class="annottext">a -&gt; Encoding
</span><a href="#local-6989586621680057609"><span class="hs-identifier hs-var">enc</span></a></span></span><span> </span><span id="local-6989586621680057608"><span class="annot"><span class="annottext">Either (MismatchEraInfo xs) a
</span><a href="#local-6989586621680057608"><span class="hs-identifier hs-var">ma</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-574"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BlockNodeToClientVersion (HardForkBlock xs)
HardForkNodeToClientVersion xs
</span><a href="#local-6989586621680057610"><span class="hs-identifier hs-var">version</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Either (MismatchEraInfo xs) a
</span><a href="#local-6989586621680057608"><span class="hs-identifier hs-var">ma</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-575"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#HardForkNodeToClientDisabled"><span class="hs-identifier hs-type">HardForkNodeToClientDisabled</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621680057607"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680057607"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-576"></span><span>          </span><span class="annot"><span class="annottext">a -&gt; Encoding
</span><a href="#local-6989586621680057609"><span class="hs-identifier hs-var">enc</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680057607"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-577"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#HardForkNodeToClientDisabled"><span class="hs-identifier hs-type">HardForkNodeToClientDisabled</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621680057606"><span class="annot"><span class="annottext">MismatchEraInfo xs
</span><a href="#local-6989586621680057606"><span class="hs-identifier hs-var">err</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-578"></span><span>          </span><span class="annot"><span class="annottext">HardForkEncoderException -&gt; Encoding
forall a e. Exception e =&gt; e -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">throw</span></a></span><span> </span><span class="annot"><span class="annottext">(HardForkEncoderException -&gt; Encoding)
-&gt; HardForkEncoderException -&gt; Encoding
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">NS SingleEraInfo xs -&gt; HardForkEncoderException
forall (xs :: [*]).
SListI xs =&gt;
NS SingleEraInfo xs -&gt; HardForkEncoderException
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#futureEraException"><span class="hs-identifier hs-var">futureEraException</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MismatchEraInfo (x : xs) -&gt; NS SingleEraInfo xs
forall (xs :: [*]) x.
SListI xs =&gt;
MismatchEraInfo (x : xs) -&gt; NS SingleEraInfo xs
</span><a href="Ouroboros.Consensus.HardFork.Combinator.AcrossEras.html#mismatchFutureEra"><span class="hs-identifier hs-var">mismatchFutureEra</span></a></span><span> </span><span class="annot"><span class="annottext">MismatchEraInfo xs
MismatchEraInfo (x : xs)
</span><a href="#local-6989586621680057606"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-579"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#HardForkNodeToClientEnabled"><span class="hs-identifier hs-type">HardForkNodeToClientEnabled</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621680057604"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680057604"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Encoding] -&gt; Encoding
forall a. Monoid a =&gt; [a] -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mconcat</span></a></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-580"></span><span>            </span><span class="annot"><span class="annottext">Word -&gt; Encoding
</span><span class="hs-identifier hs-var">Enc.encodeListLen</span></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">1</span></span><span>
</span><span id="line-581"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a -&gt; Encoding
</span><a href="#local-6989586621680057609"><span class="hs-identifier hs-var">enc</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680057604"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-582"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-583"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#HardForkNodeToClientEnabled"><span class="hs-identifier hs-type">HardForkNodeToClientEnabled</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.AcrossEras.html#MismatchEraInfo"><span class="hs-identifier hs-type">MismatchEraInfo</span></a></span><span> </span><span id="local-6989586621680057602"><span class="annot"><span class="annottext">Mismatch SingleEraInfo LedgerEraInfo xs
</span><a href="#local-6989586621680057602"><span class="hs-identifier hs-var">err</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Encoding] -&gt; Encoding
forall a. Monoid a =&gt; [a] -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mconcat</span></a></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-584"></span><span>            </span><span class="annot"><span class="annottext">Word -&gt; Encoding
</span><span class="hs-identifier hs-var">Enc.encodeListLen</span></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">2</span></span><span>
</span><span id="line-585"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NP (SingleEraInfo -.-&gt; K Encoding) xs
-&gt; NS SingleEraInfo xs -&gt; Encoding
forall (xs :: [*]) (f :: * -&gt; *).
SListI xs =&gt;
NP (f -.-&gt; K Encoding) xs -&gt; NS f xs -&gt; Encoding
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#encodeNS"><span class="hs-identifier hs-var">encodeNS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall a. (-.-&gt;) SingleEraInfo (K Encoding) a)
-&gt; NP (SingleEraInfo -.-&gt; K Encoding) xs
forall k l (h :: (k -&gt; *) -&gt; l -&gt; *) (xs :: l) (f :: k -&gt; *).
(HPure h, SListIN h xs) =&gt;
(forall (a :: k). f a) -&gt; h f xs
</span><span class="hs-identifier hs-var">hpure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(SingleEraInfo a -&gt; K Encoding a)
-&gt; (-.-&gt;) SingleEraInfo (K Encoding) a
forall k (f :: k -&gt; *) (a :: k) (f' :: k -&gt; *).
(f a -&gt; f' a) -&gt; (-.-&gt;) f f' a
</span><span class="hs-identifier hs-var">fn</span></span><span> </span><span class="annot"><span class="annottext">SingleEraInfo a -&gt; K Encoding a
forall blk. SingleEraInfo blk -&gt; K Encoding blk
</span><a href="#local-6989586621680057600"><span class="hs-identifier hs-var">encodeName</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NS SingleEraInfo xs
</span><a href="#local-6989586621680057599"><span class="hs-identifier hs-var">era1</span></a></span><span>
</span><span id="line-586"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NP (LedgerEraInfo -.-&gt; K Encoding) xs
-&gt; NS LedgerEraInfo xs -&gt; Encoding
forall (xs :: [*]) (f :: * -&gt; *).
SListI xs =&gt;
NP (f -.-&gt; K Encoding) xs -&gt; NS f xs -&gt; Encoding
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#encodeNS"><span class="hs-identifier hs-var">encodeNS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall a. (-.-&gt;) LedgerEraInfo (K Encoding) a)
-&gt; NP (LedgerEraInfo -.-&gt; K Encoding) xs
forall k l (h :: (k -&gt; *) -&gt; l -&gt; *) (xs :: l) (f :: k -&gt; *).
(HPure h, SListIN h xs) =&gt;
(forall (a :: k). f a) -&gt; h f xs
</span><span class="hs-identifier hs-var">hpure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(LedgerEraInfo a -&gt; K Encoding a)
-&gt; (-.-&gt;) LedgerEraInfo (K Encoding) a
forall k (f :: k -&gt; *) (a :: k) (f' :: k -&gt; *).
(f a -&gt; f' a) -&gt; (-.-&gt;) f f' a
</span><span class="hs-identifier hs-var">fn</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SingleEraInfo a -&gt; K Encoding a
forall blk. SingleEraInfo blk -&gt; K Encoding blk
</span><a href="#local-6989586621680057600"><span class="hs-identifier hs-var">encodeName</span></a></span><span> </span><span class="annot"><span class="annottext">(SingleEraInfo a -&gt; K Encoding a)
-&gt; (LedgerEraInfo a -&gt; SingleEraInfo a)
-&gt; LedgerEraInfo a
-&gt; K Encoding a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">LedgerEraInfo a -&gt; SingleEraInfo a
forall blk. LedgerEraInfo blk -&gt; SingleEraInfo blk
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Info.html#getLedgerEraInfo"><span class="hs-identifier hs-var hs-var">getLedgerEraInfo</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NS LedgerEraInfo xs
</span><a href="#local-6989586621680057597"><span class="hs-identifier hs-var">era2</span></a></span><span>
</span><span id="line-587"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-588"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-589"></span><span>          </span><span class="annot"><a href="#local-6989586621680057599"><span class="hs-identifier hs-type">era1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#NS"><span class="hs-identifier hs-type">NS</span></a></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Info.html#SingleEraInfo"><span class="hs-identifier hs-type">SingleEraInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057612"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-590"></span><span>          </span><span class="annot"><a href="#local-6989586621680057597"><span class="hs-identifier hs-type">era2</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#NS"><span class="hs-identifier hs-type">NS</span></a></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Info.html#LedgerEraInfo"><span class="hs-identifier hs-type">LedgerEraInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057612"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-591"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680057599"><span class="annot"><span class="annottext">NS SingleEraInfo xs
</span><a href="#local-6989586621680057599"><span class="hs-identifier hs-var">era1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680057597"><span class="annot"><span class="annottext">NS LedgerEraInfo xs
</span><a href="#local-6989586621680057597"><span class="hs-identifier hs-var">era2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Mismatch SingleEraInfo LedgerEraInfo xs
-&gt; (NS SingleEraInfo xs, NS LedgerEraInfo xs)
forall k (f :: k -&gt; *) (g :: k -&gt; *) (xs :: [k]).
Mismatch f g xs -&gt; (NS f xs, NS g xs)
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Util.Match.html#mismatchToNS"><span class="hs-identifier hs-var">Match.mismatchToNS</span></a></span><span> </span><span class="annot"><span class="annottext">Mismatch SingleEraInfo LedgerEraInfo xs
</span><a href="#local-6989586621680057602"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-592"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-593"></span><span>    </span><span id="local-6989586621680058177"><span class="annot"><a href="#local-6989586621680057600"><span class="hs-identifier hs-type">encodeName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Info.html#SingleEraInfo"><span class="hs-identifier hs-type">SingleEraInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058177"><span class="hs-identifier hs-type">blk</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">K</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Encoding</span></span><span> </span><span class="annot"><a href="#local-6989586621680058177"><span class="hs-identifier hs-type">blk</span></a></span></span><span>
</span><span id="line-594"></span><span>    </span><span id="local-6989586621680057600"><span class="annot"><span class="annottext">encodeName :: SingleEraInfo blk -&gt; K Encoding blk
</span><a href="#local-6989586621680057600"><span class="hs-identifier hs-var hs-var">encodeName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Encoding -&gt; K Encoding blk
forall k a (b :: k). a -&gt; K a b
</span><span class="hs-identifier hs-var">K</span></span><span> </span><span class="annot"><span class="annottext">(Encoding -&gt; K Encoding blk)
-&gt; (SingleEraInfo blk -&gt; Encoding)
-&gt; SingleEraInfo blk
-&gt; K Encoding blk
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Encoding
forall a. Serialise a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">Serialise.encode</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Encoding)
-&gt; (SingleEraInfo blk -&gt; Text) -&gt; SingleEraInfo blk -&gt; Encoding
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">SingleEraInfo blk -&gt; Text
forall blk. SingleEraInfo blk -&gt; Text
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Info.html#singleEraName"><span class="hs-identifier hs-var hs-var">singleEraName</span></a></span><span>
</span><span id="line-595"></span><span>
</span><span id="line-596"></span><span id="local-6989586621680057592"><span id="local-6989586621680057593"><span id="local-6989586621680057594"><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#decodeEitherMismatch"><span class="hs-identifier hs-type">decodeEitherMismatch</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SListI</span></span><span> </span><span class="annot"><a href="#local-6989586621680057594"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-597"></span><span>                     </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Node.NetworkProtocolVersion.html#BlockNodeToClientVersion"><span class="hs-identifier hs-type">BlockNodeToClientVersion</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Basics.html#HardForkBlock"><span class="hs-identifier hs-type">HardForkBlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057594"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-598"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Decoder</span></span><span> </span><span class="annot"><a href="#local-6989586621680057593"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057592"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-599"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Decoder</span></span><span> </span><span class="annot"><a href="#local-6989586621680057593"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.AcrossEras.html#MismatchEraInfo"><span class="hs-identifier hs-type">MismatchEraInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057594"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680057592"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-600"></span><span id="decodeEitherMismatch"><span class="annot"><span class="annottext">decodeEitherMismatch :: BlockNodeToClientVersion (HardForkBlock xs)
-&gt; Decoder s a -&gt; Decoder s (Either (MismatchEraInfo xs) a)
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#decodeEitherMismatch"><span class="hs-identifier hs-var hs-var">decodeEitherMismatch</span></a></span></span><span> </span><span id="local-6989586621680057591"><span class="annot"><span class="annottext">BlockNodeToClientVersion (HardForkBlock xs)
</span><a href="#local-6989586621680057591"><span class="hs-identifier hs-var">version</span></a></span></span><span> </span><span id="local-6989586621680057590"><span class="annot"><span class="annottext">Decoder s a
</span><a href="#local-6989586621680057590"><span class="hs-identifier hs-var">dec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-601"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">BlockNodeToClientVersion (HardForkBlock xs)
</span><a href="#local-6989586621680057591"><span class="hs-identifier hs-var">version</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-602"></span><span>      </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#HardForkNodeToClientDisabled"><span class="hs-identifier hs-type">HardForkNodeToClientDisabled</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-603"></span><span>        </span><span class="annot"><span class="annottext">a -&gt; Either (MismatchEraInfo xs) a
forall a b. b -&gt; Either a b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Right</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Either (MismatchEraInfo xs) a)
-&gt; Decoder s a -&gt; Decoder s (Either (MismatchEraInfo xs) a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Decoder s a
</span><a href="#local-6989586621680057590"><span class="hs-identifier hs-var">dec</span></a></span><span>
</span><span id="line-604"></span><span>      </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#HardForkNodeToClientEnabled"><span class="hs-identifier hs-type">HardForkNodeToClientEnabled</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-605"></span><span>        </span><span id="local-6989586621680057589"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680057589"><span class="hs-identifier hs-var">tag</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Decoder s Int
forall s. Decoder s Int
</span><span class="hs-identifier hs-var">Dec.decodeListLen</span></span><span>
</span><span id="line-606"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680057589"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-607"></span><span>          </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; Either (MismatchEraInfo xs) a
forall a b. b -&gt; Either a b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Right</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Either (MismatchEraInfo xs) a)
-&gt; Decoder s a -&gt; Decoder s (Either (MismatchEraInfo xs) a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Decoder s a
</span><a href="#local-6989586621680057590"><span class="hs-identifier hs-var">dec</span></a></span><span>
</span><span id="line-608"></span><span>          </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680057588"><span class="annot"><span class="annottext">NS SingleEraInfo xs
</span><a href="#local-6989586621680057588"><span class="hs-identifier hs-var">era1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NP (Decoder s :.: SingleEraInfo) xs
-&gt; Decoder s (NS SingleEraInfo xs)
forall (xs :: [*]) s (f :: * -&gt; *).
SListI xs =&gt;
NP (Decoder s :.: f) xs -&gt; Decoder s (NS f xs)
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#decodeNS"><span class="hs-identifier hs-var">decodeNS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall a. (:.:) (Decoder s) SingleEraInfo a)
-&gt; NP (Decoder s :.: SingleEraInfo) xs
forall k l (h :: (k -&gt; *) -&gt; l -&gt; *) (xs :: l) (f :: k -&gt; *).
(HPure h, SListIN h xs) =&gt;
(forall (a :: k). f a) -&gt; h f xs
</span><span class="hs-identifier hs-var">hpure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Decoder s (SingleEraInfo a) -&gt; (:.:) (Decoder s) SingleEraInfo a
forall l k (f :: l -&gt; *) (g :: k -&gt; l) (p :: k).
f (g p) -&gt; (:.:) f g p
</span><span class="hs-identifier hs-var">Comp</span></span><span> </span><span class="annot"><span class="annottext">Decoder s (SingleEraInfo a)
forall blk s. Decoder s (SingleEraInfo blk)
</span><a href="#local-6989586621680057587"><span class="hs-identifier hs-var">decodeName</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-609"></span><span>                  </span><span id="local-6989586621680057586"><span class="annot"><span class="annottext">NS LedgerEraInfo xs
</span><a href="#local-6989586621680057586"><span class="hs-identifier hs-var">era2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NP (Decoder s :.: LedgerEraInfo) xs
-&gt; Decoder s (NS LedgerEraInfo xs)
forall (xs :: [*]) s (f :: * -&gt; *).
SListI xs =&gt;
NP (Decoder s :.: f) xs -&gt; Decoder s (NS f xs)
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#decodeNS"><span class="hs-identifier hs-var">decodeNS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall a. (:.:) (Decoder s) LedgerEraInfo a)
-&gt; NP (Decoder s :.: LedgerEraInfo) xs
forall k l (h :: (k -&gt; *) -&gt; l -&gt; *) (xs :: l) (f :: k -&gt; *).
(HPure h, SListIN h xs) =&gt;
(forall (a :: k). f a) -&gt; h f xs
</span><span class="hs-identifier hs-var">hpure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Decoder s (LedgerEraInfo a) -&gt; (:.:) (Decoder s) LedgerEraInfo a
forall l k (f :: l -&gt; *) (g :: k -&gt; l) (p :: k).
f (g p) -&gt; (:.:) f g p
</span><span class="hs-identifier hs-var">Comp</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SingleEraInfo a -&gt; LedgerEraInfo a
forall blk. SingleEraInfo blk -&gt; LedgerEraInfo blk
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Info.html#LedgerEraInfo"><span class="hs-identifier hs-var">LedgerEraInfo</span></a></span><span> </span><span class="annot"><span class="annottext">(SingleEraInfo a -&gt; LedgerEraInfo a)
-&gt; Decoder s (SingleEraInfo a) -&gt; Decoder s (LedgerEraInfo a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Decoder s (SingleEraInfo a)
forall blk s. Decoder s (SingleEraInfo blk)
</span><a href="#local-6989586621680057587"><span class="hs-identifier hs-var">decodeName</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-610"></span><span>                  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">NS SingleEraInfo xs
-&gt; NS LedgerEraInfo xs
-&gt; Either
     (Mismatch SingleEraInfo LedgerEraInfo xs)
     (NS (Product SingleEraInfo LedgerEraInfo) xs)
forall k (f :: k -&gt; *) (xs :: [k]) (g :: k -&gt; *).
NS f xs
-&gt; NS g xs -&gt; Either (Mismatch f g xs) (NS (Product f g) xs)
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Util.Match.html#matchNS"><span class="hs-identifier hs-var">Match.matchNS</span></a></span><span> </span><span class="annot"><span class="annottext">NS SingleEraInfo xs
</span><a href="#local-6989586621680057588"><span class="hs-identifier hs-var">era1</span></a></span><span> </span><span class="annot"><span class="annottext">NS LedgerEraInfo xs
</span><a href="#local-6989586621680057586"><span class="hs-identifier hs-var">era2</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-611"></span><span>                    </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621680057583"><span class="annot"><span class="annottext">Mismatch SingleEraInfo LedgerEraInfo xs
</span><a href="#local-6989586621680057583"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either (MismatchEraInfo xs) a
-&gt; Decoder s (Either (MismatchEraInfo xs) a)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Either (MismatchEraInfo xs) a
 -&gt; Decoder s (Either (MismatchEraInfo xs) a))
-&gt; Either (MismatchEraInfo xs) a
-&gt; Decoder s (Either (MismatchEraInfo xs) a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">MismatchEraInfo xs -&gt; Either (MismatchEraInfo xs) a
forall a b. a -&gt; Either a b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Mismatch SingleEraInfo LedgerEraInfo xs -&gt; MismatchEraInfo xs
forall (xs :: [*]).
Mismatch SingleEraInfo LedgerEraInfo xs -&gt; MismatchEraInfo xs
</span><a href="Ouroboros.Consensus.HardFork.Combinator.AcrossEras.html#MismatchEraInfo"><span class="hs-identifier hs-var">MismatchEraInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Mismatch SingleEraInfo LedgerEraInfo xs
</span><a href="#local-6989586621680057583"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-612"></span><span>                    </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span class="annot"><span class="annottext">NS (Product SingleEraInfo LedgerEraInfo) xs
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Decoder s (Either (MismatchEraInfo xs) a)
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;dispatchDecoderErr: unexpected match&quot;</span></span><span>
</span><span id="line-613"></span><span>          </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Decoder s (Either (MismatchEraInfo xs) a)
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Decoder s (Either (MismatchEraInfo xs) a))
-&gt; String -&gt; Decoder s (Either (MismatchEraInfo xs) a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;dispatchDecoderErr: invalid tag &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680057589"><span class="hs-identifier hs-var">tag</span></a></span><span>
</span><span id="line-614"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-615"></span><span>    </span><span class="annot"><a href="#local-6989586621680057587"><span class="hs-identifier hs-type">decodeName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680058155"><span class="annot"><a href="#local-6989586621680058155"><span class="hs-identifier hs-type">blk</span></a></span></span><span> </span><span id="local-6989586621680058156"><span class="annot"><a href="#local-6989586621680058156"><span class="hs-identifier hs-type">s</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Decoder</span></span><span> </span><span class="annot"><a href="#local-6989586621680058156"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Info.html#SingleEraInfo"><span class="hs-identifier hs-type">SingleEraInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058155"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-616"></span><span>    </span><span id="local-6989586621680057587"><span class="annot"><span class="annottext">decodeName :: Decoder s (SingleEraInfo blk)
</span><a href="#local-6989586621680057587"><span class="hs-identifier hs-var hs-var">decodeName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; SingleEraInfo blk
forall blk. Text -&gt; SingleEraInfo blk
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Info.html#SingleEraInfo"><span class="hs-identifier hs-var">SingleEraInfo</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; SingleEraInfo blk)
-&gt; Decoder s Text -&gt; Decoder s (SingleEraInfo blk)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Decoder s Text
forall a s. Serialise a =&gt; Decoder s a
</span><span class="hs-identifier hs-var">Serialise.decode</span></span><span>
</span><span id="line-617"></span><span>
</span><span id="line-618"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Distributive properties
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-621"></span><span>
</span><span id="line-622"></span><span id="local-6989586621680057581"><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#distribSerialisedHeader"><span class="hs-identifier hs-type">distribSerialisedHeader</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.Serialisation.html#SerialisedHeader"><span class="hs-identifier hs-type">SerialisedHeader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Basics.html#HardForkBlock"><span class="hs-identifier hs-type">HardForkBlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057581"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-623"></span><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#NS"><span class="hs-identifier hs-type">NS</span></a></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.Serialisation.html#SerialisedHeader"><span class="hs-identifier hs-type">SerialisedHeader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057581"><span class="hs-identifier hs-type">xs</span></a></span></span><span>
</span><span id="line-624"></span><span id="distribSerialisedHeader"><span class="annot"><span class="annottext">distribSerialisedHeader :: SerialisedHeader (HardForkBlock xs) -&gt; NS SerialisedHeader xs
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#distribSerialisedHeader"><span class="hs-identifier hs-var hs-var">distribSerialisedHeader</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680057580"><span class="annot"><span class="annottext">SerialisedHeader (HardForkBlock xs)
</span><a href="#local-6989586621680057580"><span class="hs-identifier hs-var">hdr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-625"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SerialisedHeader (HardForkBlock xs)
-&gt; GenDepPair Serialised (NestedCtxt Header (HardForkBlock xs))
forall blk.
SerialisedHeader blk
-&gt; GenDepPair Serialised (NestedCtxt Header blk)
</span><a href="Ouroboros.Consensus.Storage.Serialisation.html#serialisedHeaderToDepPair"><span class="hs-identifier hs-var hs-var">serialisedHeaderToDepPair</span></a></span><span> </span><span class="annot"><span class="annottext">SerialisedHeader (HardForkBlock xs)
</span><a href="#local-6989586621680057580"><span class="hs-identifier hs-var">hdr</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-626"></span><span>      </span><span class="annot"><a href="Ouroboros.Consensus.Util.DepPair.html#GenDepPair"><span class="hs-identifier hs-type">GenDepPair</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Block.NestedContent.html#NestedCtxt"><span class="hs-identifier hs-type">NestedCtxt</span></a></span><span> </span><span id="local-6989586621680057577"><span class="annot"><span class="annottext">NestedCtxt_ (HardForkBlock xs) Header a
</span><a href="#local-6989586621680057577"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680057576"><span class="annot"><span class="annottext">Serialised a
</span><a href="#local-6989586621680057576"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-627"></span><span>        </span><span class="annot"><span class="annottext">NestedCtxt_ (HardForkBlock xs) Header a
-&gt; Serialised a -&gt; NS SerialisedHeader xs
forall (xs :: [*]) a.
NestedCtxt_ (HardForkBlock xs) Header a
-&gt; Serialised a -&gt; NS SerialisedHeader xs
</span><a href="#local-6989586621680057575"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">NestedCtxt_ (HardForkBlock xs) Header a
</span><a href="#local-6989586621680057577"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Serialised a
</span><a href="#local-6989586621680057576"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-628"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-629"></span><span>    </span><span id="local-6989586621680058136"><span id="local-6989586621680058137"><span class="annot"><a href="#local-6989586621680057575"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Block.NestedContent.html#NestedCtxt_"><span class="hs-identifier hs-type">NestedCtxt_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Basics.html#HardForkBlock"><span class="hs-identifier hs-type">HardForkBlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058137"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Block.Abstract.html#Header"><span class="hs-identifier hs-type">Header</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058136"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-630"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.7/ouroboros-network-api-0.1.0.0/noopt/doc/html/ouroboros-network-api/src"><span class="hs-identifier hs-type">Serialised</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058136"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-631"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#NS"><span class="hs-identifier hs-type">NS</span></a></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.Serialisation.html#SerialisedHeader"><span class="hs-identifier hs-type">SerialisedHeader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058137"><span class="hs-identifier hs-type">xs</span></a></span></span></span><span>
</span><span id="line-632"></span><span>    </span><span id="local-6989586621680057575"><span class="annot"><span class="annottext">go :: NestedCtxt_ (HardForkBlock xs) Header a
-&gt; Serialised a -&gt; NS SerialisedHeader xs
</span><a href="#local-6989586621680057575"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Block.html#NCZ"><span class="hs-identifier hs-type">NCZ</span></a></span><span> </span><span id="local-6989586621680057574"><span class="annot"><a href="#local-6989586621680057574"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SerialisedHeader x -&gt; NS SerialisedHeader (x : xs)
forall a (f :: a -&gt; *) (x :: a) (xs :: [a]). f x -&gt; NS f (x : xs)
</span><a href="Data.SOP.Strict.html#Z"><span class="hs-identifier hs-var">Z</span></a></span><span> </span><span class="annot"><span class="annottext">(SerialisedHeader x -&gt; NS SerialisedHeader (x : xs))
-&gt; (Serialised a -&gt; SerialisedHeader x)
-&gt; Serialised a
-&gt; NS SerialisedHeader (x : xs)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">GenDepPair Serialised (NestedCtxt Header x) -&gt; SerialisedHeader x
forall blk.
GenDepPair Serialised (NestedCtxt Header blk)
-&gt; SerialisedHeader blk
</span><a href="Ouroboros.Consensus.Storage.Serialisation.html#SerialisedHeaderFromDepPair"><span class="hs-identifier hs-var">SerialisedHeaderFromDepPair</span></a></span><span> </span><span class="annot"><span class="annottext">(GenDepPair Serialised (NestedCtxt Header x) -&gt; SerialisedHeader x)
-&gt; (Serialised a -&gt; GenDepPair Serialised (NestedCtxt Header x))
-&gt; Serialised a
-&gt; SerialisedHeader x
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">NestedCtxt Header x a
-&gt; Serialised a -&gt; GenDepPair Serialised (NestedCtxt Header x)
forall (f :: * -&gt; *) a (g :: * -&gt; *). f a -&gt; g a -&gt; GenDepPair g f
</span><a href="Ouroboros.Consensus.Util.DepPair.html#GenDepPair"><span class="hs-identifier hs-var">GenDepPair</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NestedCtxt_ x Header a -&gt; NestedCtxt Header x a
forall (f :: * -&gt; *) blk a.
NestedCtxt_ blk f a -&gt; NestedCtxt f blk a
</span><a href="Ouroboros.Consensus.Block.NestedContent.html#NestedCtxt"><span class="hs-identifier hs-var">NestedCtxt</span></a></span><span> </span><span class="annot"><span class="annottext">NestedCtxt_ x Header a
</span><a href="#local-6989586621680057574"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-633"></span><span>    </span><span class="annot"><a href="#local-6989586621680057575"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Block.html#NCS"><span class="hs-identifier hs-type">NCS</span></a></span><span> </span><span id="local-6989586621680057572"><span class="annot"><a href="#local-6989586621680057572"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NS SerialisedHeader xs -&gt; NS SerialisedHeader (x : xs)
forall a (f :: a -&gt; *) (xs :: [a]) (x :: a).
NS f xs -&gt; NS f (x : xs)
</span><a href="Data.SOP.Strict.html#S"><span class="hs-identifier hs-var">S</span></a></span><span> </span><span class="annot"><span class="annottext">(NS SerialisedHeader xs -&gt; NS SerialisedHeader (x : xs))
-&gt; (Serialised a -&gt; NS SerialisedHeader xs)
-&gt; Serialised a
-&gt; NS SerialisedHeader (x : xs)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">NestedCtxt_ (HardForkBlock xs) Header a
-&gt; Serialised a -&gt; NS SerialisedHeader xs
forall (xs :: [*]) a.
NestedCtxt_ (HardForkBlock xs) Header a
-&gt; Serialised a -&gt; NS SerialisedHeader xs
</span><a href="#local-6989586621680057575"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">NestedCtxt_ (HardForkBlock xs) Header a
</span><a href="#local-6989586621680057572"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-634"></span><span>
</span><span id="line-635"></span><span id="local-6989586621680057571"><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#undistribSerialisedHeader"><span class="hs-identifier hs-type">undistribSerialisedHeader</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#NS"><span class="hs-identifier hs-type">NS</span></a></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.Serialisation.html#SerialisedHeader"><span class="hs-identifier hs-type">SerialisedHeader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057571"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-636"></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.Serialisation.html#SerialisedHeader"><span class="hs-identifier hs-type">SerialisedHeader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Basics.html#HardForkBlock"><span class="hs-identifier hs-type">HardForkBlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057571"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-637"></span><span id="undistribSerialisedHeader"><span class="annot"><span class="annottext">undistribSerialisedHeader :: NS SerialisedHeader xs -&gt; SerialisedHeader (HardForkBlock xs)
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#undistribSerialisedHeader"><span class="hs-identifier hs-var hs-var">undistribSerialisedHeader</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-638"></span><span>    </span><span class="annot"><span class="annottext">GenDepPair Serialised (NestedCtxt Header (HardForkBlock xs))
-&gt; SerialisedHeader (HardForkBlock xs)
forall blk.
GenDepPair Serialised (NestedCtxt Header blk)
-&gt; SerialisedHeader blk
</span><a href="Ouroboros.Consensus.Storage.Serialisation.html#SerialisedHeaderFromDepPair"><span class="hs-identifier hs-var">SerialisedHeaderFromDepPair</span></a></span><span> </span><span class="annot"><span class="annottext">(GenDepPair Serialised (NestedCtxt Header (HardForkBlock xs))
 -&gt; SerialisedHeader (HardForkBlock xs))
-&gt; (NS SerialisedHeader xs
    -&gt; GenDepPair Serialised (NestedCtxt Header (HardForkBlock xs)))
-&gt; NS SerialisedHeader xs
-&gt; SerialisedHeader (HardForkBlock xs)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">NS SerialisedHeader xs
-&gt; GenDepPair Serialised (NestedCtxt Header (HardForkBlock xs))
forall (xs :: [*]).
NS SerialisedHeader xs
-&gt; GenDepPair Serialised (NestedCtxt Header (HardForkBlock xs))
</span><a href="#local-6989586621680057570"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-639"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-640"></span><span>    </span><span id="local-6989586621680058117"><span class="annot"><a href="#local-6989586621680057570"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#NS"><span class="hs-identifier hs-type">NS</span></a></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.Serialisation.html#SerialisedHeader"><span class="hs-identifier hs-type">SerialisedHeader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058117"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-641"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Util.DepPair.html#GenDepPair"><span class="hs-identifier hs-type">GenDepPair</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.7/ouroboros-network-api-0.1.0.0/noopt/doc/html/ouroboros-network-api/src"><span class="hs-identifier hs-type">Serialised</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Block.NestedContent.html#NestedCtxt"><span class="hs-identifier hs-type">NestedCtxt</span></a></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Block.Abstract.html#Header"><span class="hs-identifier hs-type">Header</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Basics.html#HardForkBlock"><span class="hs-identifier hs-type">HardForkBlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058117"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-642"></span><span>    </span><span id="local-6989586621680057570"><span class="annot"><span class="annottext">go :: NS SerialisedHeader xs
-&gt; GenDepPair Serialised (NestedCtxt Header (HardForkBlock xs))
</span><a href="#local-6989586621680057570"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Strict.html#Z"><span class="hs-identifier hs-type">Z</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Storage.Serialisation.html#SerialisedHeaderFromDepPair"><span class="hs-identifier hs-type">SerialisedHeaderFromDepPair</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Util.DepPair.html#GenDepPair"><span class="hs-identifier hs-type">GenDepPair</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Block.NestedContent.html#NestedCtxt"><span class="hs-identifier hs-type">NestedCtxt</span></a></span><span> </span><span id="local-6989586621680057569"><span class="annot"><span class="annottext">NestedCtxt_ x Header a
</span><a href="#local-6989586621680057569"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680057568"><span class="annot"><span class="annottext">Serialised a
</span><a href="#local-6989586621680057568"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-643"></span><span>        </span><span class="annot"><span class="annottext">NestedCtxt Header (HardForkBlock (x : xs)) a
-&gt; Serialised a
-&gt; GenDepPair
     Serialised (NestedCtxt Header (HardForkBlock (x : xs)))
forall (f :: * -&gt; *) a (g :: * -&gt; *). f a -&gt; g a -&gt; GenDepPair g f
</span><a href="Ouroboros.Consensus.Util.DepPair.html#GenDepPair"><span class="hs-identifier hs-var">GenDepPair</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NestedCtxt_ (HardForkBlock (x : xs)) Header a
-&gt; NestedCtxt Header (HardForkBlock (x : xs)) a
forall (f :: * -&gt; *) blk a.
NestedCtxt_ blk f a -&gt; NestedCtxt f blk a
</span><a href="Ouroboros.Consensus.Block.NestedContent.html#NestedCtxt"><span class="hs-identifier hs-var">NestedCtxt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NestedCtxt_ x Header a
-&gt; NestedCtxt_ (HardForkBlock (x : xs)) Header a
forall x (f :: * -&gt; *) a (xs :: [*]).
NestedCtxt_ x f a -&gt; NestedCtxt_ (HardForkBlock (x : xs)) f a
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Block.html#NCZ"><span class="hs-identifier hs-var">NCZ</span></a></span><span> </span><span class="annot"><span class="annottext">NestedCtxt_ x Header a
</span><a href="#local-6989586621680057569"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Serialised a
</span><a href="#local-6989586621680057568"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-644"></span><span>    </span><span class="annot"><a href="#local-6989586621680057570"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Strict.html#S"><span class="hs-identifier hs-type">S</span></a></span><span> </span><span id="local-6989586621680057567"><span class="annot"><span class="annottext">NS SerialisedHeader xs
</span><a href="#local-6989586621680057567"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-645"></span><span>        </span><span class="annot"><span class="annottext">(forall a.
 NestedCtxt Header (HardForkBlock xs) a
 -&gt; NestedCtxt Header (HardForkBlock xs) a)
-&gt; GenDepPair Serialised (NestedCtxt Header (HardForkBlock xs))
-&gt; GenDepPair Serialised (NestedCtxt Header (HardForkBlock xs))
forall (f :: * -&gt; *) (f' :: * -&gt; *) (g :: * -&gt; *).
(forall a. f a -&gt; f' a) -&gt; GenDepPair g f -&gt; GenDepPair g f'
</span><a href="Ouroboros.Consensus.Util.DepPair.html#depPairFirst"><span class="hs-identifier hs-var">depPairFirst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(NestedCtxt_ (HardForkBlock xs) Header a
 -&gt; NestedCtxt_ (HardForkBlock (x : xs)) Header a)
-&gt; NestedCtxt Header (HardForkBlock xs) a
-&gt; NestedCtxt Header (HardForkBlock (x : xs)) a
forall blk (f :: * -&gt; *) a blk' (f' :: * -&gt; *) a'.
(NestedCtxt_ blk f a -&gt; NestedCtxt_ blk' f' a')
-&gt; NestedCtxt f blk a -&gt; NestedCtxt f' blk' a'
</span><a href="Ouroboros.Consensus.Block.NestedContent.html#mapNestedCtxt"><span class="hs-identifier hs-var">mapNestedCtxt</span></a></span><span> </span><span class="annot"><span class="annottext">NestedCtxt_ (HardForkBlock xs) Header a
-&gt; NestedCtxt_ (HardForkBlock (x : xs)) Header a
forall (xs :: [*]) (f :: * -&gt; *) a x.
NestedCtxt_ (HardForkBlock xs) f a
-&gt; NestedCtxt_ (HardForkBlock (x : xs)) f a
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Block.html#NCS"><span class="hs-identifier hs-var">NCS</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(GenDepPair Serialised (NestedCtxt Header (HardForkBlock xs))
 -&gt; GenDepPair Serialised (NestedCtxt Header (HardForkBlock xs)))
-&gt; GenDepPair Serialised (NestedCtxt Header (HardForkBlock xs))
-&gt; GenDepPair Serialised (NestedCtxt Header (HardForkBlock xs))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">NS SerialisedHeader xs
-&gt; GenDepPair Serialised (NestedCtxt Header (HardForkBlock xs))
forall (xs :: [*]).
NS SerialisedHeader xs
-&gt; GenDepPair Serialised (NestedCtxt Header (HardForkBlock xs))
</span><a href="#local-6989586621680057570"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">NS SerialisedHeader xs
</span><a href="#local-6989586621680057567"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-646"></span><span>
</span><span id="line-647"></span><span id="local-6989586621680057564"><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#distribQueryIfCurrent"><span class="hs-identifier hs-type">distribQueryIfCurrent</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-648"></span><span>     </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.7/ouroboros-network-protocols-0.3.0.0/noopt/doc/html/ouroboros-network-protocols/src"><span class="hs-identifier hs-type">Some</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Ledger.Query.html#QueryIfCurrent"><span class="hs-identifier hs-type">QueryIfCurrent</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057564"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-649"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#NS"><span class="hs-identifier hs-type">NS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Util.html#SomeSecond"><span class="hs-identifier hs-type">SomeSecond</span></a></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Ledger.Query.html#BlockQuery"><span class="hs-identifier hs-type">BlockQuery</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680057564"><span class="hs-identifier hs-type">xs</span></a></span></span><span>
</span><span id="line-650"></span><span id="distribQueryIfCurrent"><span class="annot"><span class="annottext">distribQueryIfCurrent :: Some (QueryIfCurrent xs) -&gt; NS (SomeSecond BlockQuery) xs
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#distribQueryIfCurrent"><span class="hs-identifier hs-var hs-var">distribQueryIfCurrent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.7/ouroboros-network-protocols-0.3.0.0/noopt/doc/html/ouroboros-network-protocols/src"><span class="hs-identifier hs-type">Some</span></a></span><span> </span><span id="local-6989586621680057562"><span class="annot"><span class="annottext">QueryIfCurrent xs a
</span><a href="#local-6989586621680057562"><span class="hs-identifier hs-var">qry</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">QueryIfCurrent xs a -&gt; NS (SomeSecond BlockQuery) xs
forall (xs :: [*]) result.
QueryIfCurrent xs result -&gt; NS (SomeSecond BlockQuery) xs
</span><a href="#local-6989586621680057561"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">QueryIfCurrent xs a
</span><a href="#local-6989586621680057562"><span class="hs-identifier hs-var">qry</span></a></span><span>
</span><span id="line-651"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-652"></span><span>    </span><span id="local-6989586621680058093"><span id="local-6989586621680058094"><span class="annot"><a href="#local-6989586621680057561"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Ledger.Query.html#QueryIfCurrent"><span class="hs-identifier hs-type">QueryIfCurrent</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058094"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058093"><span class="hs-identifier hs-type">result</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#NS"><span class="hs-identifier hs-type">NS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Util.html#SomeSecond"><span class="hs-identifier hs-type">SomeSecond</span></a></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Ledger.Query.html#BlockQuery"><span class="hs-identifier hs-type">BlockQuery</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680058094"><span class="hs-identifier hs-type">xs</span></a></span></span></span><span>
</span><span id="line-653"></span><span>    </span><span id="local-6989586621680057561"><span class="annot"><span class="annottext">go :: QueryIfCurrent xs result -&gt; NS (SomeSecond BlockQuery) xs
</span><a href="#local-6989586621680057561"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Ledger.Query.html#QZ"><span class="hs-identifier hs-type">QZ</span></a></span><span> </span><span id="local-6989586621680057559"><span class="annot"><span class="annottext">BlockQuery x result
</span><a href="#local-6989586621680057559"><span class="hs-identifier hs-var">qry</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SomeSecond BlockQuery x -&gt; NS (SomeSecond BlockQuery) (x : xs)
forall a (f :: a -&gt; *) (x :: a) (xs :: [a]). f x -&gt; NS f (x : xs)
</span><a href="Data.SOP.Strict.html#Z"><span class="hs-identifier hs-var">Z</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BlockQuery x result -&gt; SomeSecond BlockQuery x
forall (f :: * -&gt; * -&gt; *) a b. f a b -&gt; SomeSecond f a
</span><a href="Ouroboros.Consensus.Util.html#SomeSecond"><span class="hs-identifier hs-var">SomeSecond</span></a></span><span> </span><span class="annot"><span class="annottext">BlockQuery x result
</span><a href="#local-6989586621680057559"><span class="hs-identifier hs-var">qry</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-654"></span><span>    </span><span class="annot"><a href="#local-6989586621680057561"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Ledger.Query.html#QS"><span class="hs-identifier hs-type">QS</span></a></span><span> </span><span id="local-6989586621680057557"><span class="annot"><span class="annottext">QueryIfCurrent xs result
</span><a href="#local-6989586621680057557"><span class="hs-identifier hs-var">qry</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NS (SomeSecond BlockQuery) xs
-&gt; NS (SomeSecond BlockQuery) (x : xs)
forall a (f :: a -&gt; *) (xs :: [a]) (x :: a).
NS f xs -&gt; NS f (x : xs)
</span><a href="Data.SOP.Strict.html#S"><span class="hs-identifier hs-var">S</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QueryIfCurrent xs result -&gt; NS (SomeSecond BlockQuery) xs
forall (xs :: [*]) result.
QueryIfCurrent xs result -&gt; NS (SomeSecond BlockQuery) xs
</span><a href="#local-6989586621680057561"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">QueryIfCurrent xs result
</span><a href="#local-6989586621680057557"><span class="hs-identifier hs-var">qry</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-655"></span><span>
</span><span id="line-656"></span><span id="local-6989586621680057556"><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#undistribQueryIfCurrent"><span class="hs-identifier hs-type">undistribQueryIfCurrent</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-657"></span><span>     </span><span class="annot"><a href="Data.SOP.Strict.html#NS"><span class="hs-identifier hs-type">NS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Util.html#SomeSecond"><span class="hs-identifier hs-type">SomeSecond</span></a></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Ledger.Query.html#BlockQuery"><span class="hs-identifier hs-type">BlockQuery</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680057556"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-658"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.7/ouroboros-network-protocols-0.3.0.0/noopt/doc/html/ouroboros-network-protocols/src"><span class="hs-identifier hs-type">Some</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Ledger.Query.html#QueryIfCurrent"><span class="hs-identifier hs-type">QueryIfCurrent</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057556"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-659"></span><span id="undistribQueryIfCurrent"><span class="annot"><span class="annottext">undistribQueryIfCurrent :: NS (SomeSecond BlockQuery) xs -&gt; Some (QueryIfCurrent xs)
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#undistribQueryIfCurrent"><span class="hs-identifier hs-var hs-var">undistribQueryIfCurrent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NS (SomeSecond BlockQuery) xs -&gt; Some (QueryIfCurrent xs)
forall (xs :: [*]).
NS (SomeSecond BlockQuery) xs -&gt; Some (QueryIfCurrent xs)
</span><a href="#local-6989586621680057555"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-660"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-661"></span><span>    </span><span id="local-6989586621680058085"><span class="annot"><a href="#local-6989586621680057555"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#NS"><span class="hs-identifier hs-type">NS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Util.html#SomeSecond"><span class="hs-identifier hs-type">SomeSecond</span></a></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Ledger.Query.html#BlockQuery"><span class="hs-identifier hs-type">BlockQuery</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680058085"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.7/ouroboros-network-protocols-0.3.0.0/noopt/doc/html/ouroboros-network-protocols/src"><span class="hs-identifier hs-type">Some</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Ledger.Query.html#QueryIfCurrent"><span class="hs-identifier hs-type">QueryIfCurrent</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058085"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-662"></span><span>    </span><span id="local-6989586621680057555"><span class="annot"><span class="annottext">go :: NS (SomeSecond BlockQuery) xs -&gt; Some (QueryIfCurrent xs)
</span><a href="#local-6989586621680057555"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Strict.html#Z"><span class="hs-identifier hs-type">Z</span></a></span><span> </span><span id="local-6989586621680057554"><span class="annot"><span class="annottext">SomeSecond BlockQuery x
</span><a href="#local-6989586621680057554"><span class="hs-identifier hs-var">qry</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SomeSecond BlockQuery x
</span><a href="#local-6989586621680057554"><span class="hs-identifier hs-var">qry</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-663"></span><span>                   </span><span class="annot"><a href="Ouroboros.Consensus.Util.html#SomeSecond"><span class="hs-identifier hs-type">SomeSecond</span></a></span><span> </span><span id="local-6989586621680057553"><span class="annot"><span class="annottext">BlockQuery x b
</span><a href="#local-6989586621680057553"><span class="hs-identifier hs-var">qry'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-664"></span><span>                     </span><span class="annot"><span class="annottext">QueryIfCurrent (x : xs) b -&gt; Some (QueryIfCurrent (x : xs))
forall k (f :: k -&gt; *) (a :: k). f a -&gt; Some f
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.7/ouroboros-network-protocols-0.3.0.0/noopt/doc/html/ouroboros-network-protocols/src"><span class="hs-identifier hs-var">Some</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BlockQuery x b -&gt; QueryIfCurrent (x : xs) b
forall x result (xs :: [*]).
BlockQuery x result -&gt; QueryIfCurrent (x : xs) result
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Ledger.Query.html#QZ"><span class="hs-identifier hs-var">QZ</span></a></span><span> </span><span class="annot"><span class="annottext">BlockQuery x b
</span><a href="#local-6989586621680057553"><span class="hs-identifier hs-var">qry'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-665"></span><span>    </span><span class="annot"><a href="#local-6989586621680057555"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Strict.html#S"><span class="hs-identifier hs-type">S</span></a></span><span> </span><span id="local-6989586621680057552"><span class="annot"><span class="annottext">NS (SomeSecond BlockQuery) xs
</span><a href="#local-6989586621680057552"><span class="hs-identifier hs-var">qry</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">NS (SomeSecond BlockQuery) xs -&gt; Some (QueryIfCurrent xs)
forall (xs :: [*]).
NS (SomeSecond BlockQuery) xs -&gt; Some (QueryIfCurrent xs)
</span><a href="#local-6989586621680057555"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">NS (SomeSecond BlockQuery) xs
</span><a href="#local-6989586621680057552"><span class="hs-identifier hs-var">qry</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-666"></span><span>                   </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.7/ouroboros-network-protocols-0.3.0.0/noopt/doc/html/ouroboros-network-protocols/src"><span class="hs-identifier hs-type">Some</span></a></span><span> </span><span id="local-6989586621680057551"><span class="annot"><span class="annottext">QueryIfCurrent xs a
</span><a href="#local-6989586621680057551"><span class="hs-identifier hs-var">qry'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-667"></span><span>                     </span><span class="annot"><span class="annottext">QueryIfCurrent (x : xs) a -&gt; Some (QueryIfCurrent (x : xs))
forall k (f :: k -&gt; *) (a :: k). f a -&gt; Some f
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.7/ouroboros-network-protocols-0.3.0.0/noopt/doc/html/ouroboros-network-protocols/src"><span class="hs-identifier hs-var">Some</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QueryIfCurrent xs a -&gt; QueryIfCurrent (x : xs) a
forall (xs :: [*]) result x.
QueryIfCurrent xs result -&gt; QueryIfCurrent (x : xs) result
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Ledger.Query.html#QS"><span class="hs-identifier hs-var">QS</span></a></span><span> </span><span class="annot"><span class="annottext">QueryIfCurrent xs a
</span><a href="#local-6989586621680057551"><span class="hs-identifier hs-var">qry'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-668"></span><span>
</span><span id="line-669"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Deriving-via support

  This is primarily for the benefit of tests, and depends only on 'Serialise'
  (rather than 'SerialiseDisk'/'SerialiseNodeToNode'/'SerialiseNodeToClient').
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-675"></span><span>
</span><span id="line-676"></span><span class="hs-comment">-- | Used for deriving via</span><span>
</span><span id="line-677"></span><span class="hs-comment">--</span><span>
</span><span id="line-678"></span><span class="hs-comment">-- Example</span><span>
</span><span id="line-679"></span><span class="hs-comment">--</span><span>
</span><span id="line-680"></span><span class="hs-comment">-- &gt; deriving via SerialiseNS Header SomeEras</span><span>
</span><span id="line-681"></span><span class="hs-comment">-- &gt;          instance Serialise (Header SomeSecond)</span><span>
</span><span id="line-682"></span><span class="hs-keyword">newtype</span><span> </span><span id="SerialiseNS"><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#SerialiseNS"><span class="hs-identifier hs-var">SerialiseNS</span></a></span></span><span> </span><span id="local-6989586621680058060"><span class="annot"><a href="#local-6989586621680058060"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621680058059"><span class="annot"><a href="#local-6989586621680058059"><span class="hs-identifier hs-type">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="SerialiseNS"><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#SerialiseNS"><span class="hs-identifier hs-var">SerialiseNS</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-683"></span><span>      </span><span id="getSerialiseNS"><span class="annot"><span class="annottext">SerialiseNS f xs -&gt; NS f xs
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#getSerialiseNS"><span class="hs-identifier hs-var hs-var">getSerialiseNS</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#NS"><span class="hs-identifier hs-type">NS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058060"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680058059"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-684"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-685"></span><span>
</span><span id="line-686"></span><span id="local-6989586621680057547"><span id="local-6989586621680057548"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680057541"><span id="local-6989586621680057543"><span class="annot"><span class="hs-identifier hs-type">All</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Compose</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Serialise</span></span><span> </span><span class="annot"><a href="#local-6989586621680057548"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680057547"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Serialise</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#SerialiseNS"><span class="hs-identifier hs-type">SerialiseNS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057548"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680057547"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-687"></span><span>  </span><span id="local-6989586621680057539"><span class="annot"><span class="annottext">encode :: SerialiseNS f xs -&gt; Encoding
</span><a href="#local-6989586621680057539"><span class="hs-identifier hs-var hs-var hs-var hs-var">encode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NP (f -.-&gt; K Encoding) xs -&gt; NS f xs -&gt; Encoding
forall (xs :: [*]) (f :: * -&gt; *).
SListI xs =&gt;
NP (f -.-&gt; K Encoding) xs -&gt; NS f xs -&gt; Encoding
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#encodeNS"><span class="hs-identifier hs-var">encodeNS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy (Compose Serialise f)
-&gt; (forall a. Compose Serialise f a =&gt; (-.-&gt;) f (K Encoding) a)
-&gt; NP (f -.-&gt; K Encoding) xs
forall k l (h :: (k -&gt; *) -&gt; l -&gt; *) (c :: k -&gt; Constraint)
       (xs :: l) (proxy :: (k -&gt; Constraint) -&gt; *) (f :: k -&gt; *).
(HPure h, AllN h c xs) =&gt;
proxy c -&gt; (forall (a :: k). c a =&gt; f a) -&gt; h f xs
</span><span class="hs-identifier hs-var">hcpure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy (Compose Serialise f)
forall k (t :: k). Proxy t
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Compose</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Serialise</span></span><span> </span><span class="annot"><a href="#local-6989586621680057548"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-688"></span><span>                            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(f a -&gt; K Encoding a) -&gt; (-.-&gt;) f (K Encoding) a
forall k (f :: k -&gt; *) (a :: k) (f' :: k -&gt; *).
(f a -&gt; f' a) -&gt; (-.-&gt;) f f' a
</span><span class="hs-identifier hs-var">fn</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Encoding -&gt; K Encoding a
forall k a (b :: k). a -&gt; K a b
</span><span class="hs-identifier hs-var">K</span></span><span> </span><span class="annot"><span class="annottext">(Encoding -&gt; K Encoding a)
-&gt; (f a -&gt; Encoding) -&gt; f a -&gt; K Encoding a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">f a -&gt; Encoding
forall a. Serialise a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">Serialise.encode</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-689"></span><span>         </span><span class="annot"><span class="annottext">(NS f xs -&gt; Encoding)
-&gt; (SerialiseNS f xs -&gt; NS f xs) -&gt; SerialiseNS f xs -&gt; Encoding
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">SerialiseNS f xs -&gt; NS f xs
forall (f :: * -&gt; *) (xs :: [*]). SerialiseNS f xs -&gt; NS f xs
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#getSerialiseNS"><span class="hs-identifier hs-var hs-var">getSerialiseNS</span></a></span><span>
</span><span id="line-690"></span><span>
</span><span id="line-691"></span><span>  </span><span id="local-6989586621680057538"><span class="annot"><span class="annottext">decode :: Decoder s (SerialiseNS f xs)
</span><a href="#local-6989586621680057538"><span class="hs-identifier hs-var hs-var hs-var hs-var">decode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(NS f xs -&gt; SerialiseNS f xs)
-&gt; Decoder s (NS f xs) -&gt; Decoder s (SerialiseNS f xs)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">NS f xs -&gt; SerialiseNS f xs
forall (f :: * -&gt; *) (xs :: [*]). NS f xs -&gt; SerialiseNS f xs
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#SerialiseNS"><span class="hs-identifier hs-var">SerialiseNS</span></a></span><span>
</span><span id="line-692"></span><span>         </span><span class="annot"><span class="annottext">(Decoder s (NS f xs) -&gt; Decoder s (SerialiseNS f xs))
-&gt; Decoder s (NS f xs) -&gt; Decoder s (SerialiseNS f xs)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">NP (Decoder s :.: f) xs -&gt; Decoder s (NS f xs)
forall (xs :: [*]) s (f :: * -&gt; *).
SListI xs =&gt;
NP (Decoder s :.: f) xs -&gt; Decoder s (NS f xs)
</span><a href="Ouroboros.Consensus.HardFork.Combinator.Serialisation.Common.html#decodeNS"><span class="hs-identifier hs-var">decodeNS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy (Compose Serialise f)
-&gt; (forall a. Compose Serialise f a =&gt; (:.:) (Decoder s) f a)
-&gt; NP (Decoder s :.: f) xs
forall k l (h :: (k -&gt; *) -&gt; l -&gt; *) (c :: k -&gt; Constraint)
       (xs :: l) (proxy :: (k -&gt; Constraint) -&gt; *) (f :: k -&gt; *).
(HPure h, AllN h c xs) =&gt;
proxy c -&gt; (forall (a :: k). c a =&gt; f a) -&gt; h f xs
</span><span class="hs-identifier hs-var">hcpure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy (Compose Serialise f)
forall k (t :: k). Proxy t
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Compose</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Serialise</span></span><span> </span><span class="annot"><a href="#local-6989586621680057548"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-693"></span><span>                            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Decoder s (f a) -&gt; (:.:) (Decoder s) f a
forall l k (f :: l -&gt; *) (g :: k -&gt; l) (p :: k).
f (g p) -&gt; (:.:) f g p
</span><span class="hs-identifier hs-var">Comp</span></span><span> </span><span class="annot"><span class="annottext">Decoder s (f a)
forall a s. Serialise a =&gt; Decoder s a
</span><span class="hs-identifier hs-var">Serialise.decode</span></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-694"></span></pre></body></html>