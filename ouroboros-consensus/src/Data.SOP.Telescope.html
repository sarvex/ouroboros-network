<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span id="%24con2tag_HFSkHhZoXk9JthIEuTUCz8"></span><span class="hs-pragma">{-# LANGUAGE ConstraintKinds      #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DataKinds            #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE EmptyCase            #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts     #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE GADTs                #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase           #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE PolyKinds            #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes           #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables  #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE StandaloneDeriving   #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications     #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies         #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators        #-}</span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span class="hs-comment">-- | Intended for qualified import</span><span>
</span><span id="line-17"></span><span class="hs-comment">--</span><span>
</span><span id="line-18"></span><span class="hs-comment">-- &gt; import           Data.SOP.Telescope (Telescope(..))</span><span>
</span><span id="line-19"></span><span class="hs-comment">-- &gt; import qualified Data.SOP.Telescope as Telescope</span><span>
</span><span id="line-20"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data.SOP.Telescope</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-21"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Telescope</span></span><span>
</span><span id="line-22"></span><span>    </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier">Telescope</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#sequence"><span class="hs-identifier">sequence</span></a></span><span>
</span><span id="line-24"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Utilities</span></span><span>
</span><span id="line-25"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#fromTZ"><span class="hs-identifier">fromTZ</span></a></span><span>
</span><span id="line-26"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#fromTip"><span class="hs-identifier">fromTip</span></a></span><span>
</span><span id="line-27"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#tip"><span class="hs-identifier">tip</span></a></span><span>
</span><span id="line-28"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#toAtMost"><span class="hs-identifier">toAtMost</span></a></span><span>
</span><span id="line-29"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Bifunctor analogues of SOP functions</span></span><span>
</span><span id="line-30"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#bihap"><span class="hs-identifier">bihap</span></a></span><span>
</span><span id="line-31"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#bihczipWith"><span class="hs-identifier">bihczipWith</span></a></span><span>
</span><span id="line-32"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#bihmap"><span class="hs-identifier">bihmap</span></a></span><span>
</span><span id="line-33"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#bihzipWith"><span class="hs-identifier">bihzipWith</span></a></span><span>
</span><span id="line-34"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Extension, retraction, alignment</span></span><span>
</span><span id="line-35"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Extend"><span class="hs-identifier">Extend</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Retract"><span class="hs-identifier">Retract</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#align"><span class="hs-identifier">align</span></a></span><span>
</span><span id="line-38"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#extend"><span class="hs-identifier">extend</span></a></span><span>
</span><span id="line-39"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#retract"><span class="hs-identifier">retract</span></a></span><span>
</span><span id="line-40"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Simplified API</span></span><span>
</span><span id="line-41"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#alignExtend"><span class="hs-identifier">alignExtend</span></a></span><span>
</span><span id="line-42"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#alignExtendNS"><span class="hs-identifier">alignExtendNS</span></a></span><span>
</span><span id="line-43"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#extendIf"><span class="hs-identifier">extendIf</span></a></span><span>
</span><span id="line-44"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#retractIf"><span class="hs-identifier">retractIf</span></a></span><span>
</span><span id="line-45"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Additional API</span></span><span>
</span><span id="line-46"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#ScanNext"><span class="hs-identifier">ScanNext</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#SimpleTelescope"><span class="hs-identifier">SimpleTelescope</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#scanl"><span class="hs-identifier">scanl</span></a></span><span>
</span><span id="line-49"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Functor.Product</span></a></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Kind</span></a></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Data.SOP.Counting.html"><span class="hs-identifier">Data.SOP.Counting</span></a></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Data.SOP.InPairs.html"><span class="hs-identifier">Data.SOP.InPairs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.InPairs.html#InPairs"><span class="hs-identifier">InPairs</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SOP.InPairs.html#Requiring"><span class="hs-identifier">Requiring</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Data.SOP.InPairs.html"><span class="hs-identifier">Data.SOP.InPairs</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">InPairs</span></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Data.SOP.Strict.html"><span class="hs-identifier">Data.SOP.Strict</span></a></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Data.SOP.Tails.html"><span class="hs-identifier">Data.SOP.Tails</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Tails.html#Tails"><span class="hs-identifier">Tails</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Data.SOP.Tails.html"><span class="hs-identifier">Data.SOP.Tails</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Tails</span></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">GHC.Stack</span></a></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">NoThunks.Class</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NoThunks</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">allNoThunks</span></span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Prelude</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">scanl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">sequence</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">zipWith</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Telescope
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span class="hs-comment">-- | Telescope</span><span>
</span><span id="line-68"></span><span class="hs-comment">--</span><span>
</span><span id="line-69"></span><span class="hs-comment">-- A telescope is an extension of an 'NS', where every time we &quot;go right&quot; in the</span><span>
</span><span id="line-70"></span><span class="hs-comment">-- sum we have an additional value.</span><span>
</span><span id="line-71"></span><span class="hs-comment">--</span><span>
</span><span id="line-72"></span><span class="hs-comment">-- Blockchain intuition: think of @g@ as representing some kind of past state,</span><span>
</span><span id="line-73"></span><span class="hs-comment">-- and @f@ some kind of current state. Then depending on how many hard fork</span><span>
</span><span id="line-74"></span><span class="hs-comment">-- transitions we have had, we might either have, say</span><span>
</span><span id="line-75"></span><span class="hs-comment">--</span><span>
</span><span id="line-76"></span><span class="hs-comment">-- &gt; TZ currentByronState</span><span>
</span><span id="line-77"></span><span class="hs-comment">-- &gt; TS pastByronState $ TZ currentShelleyState</span><span>
</span><span id="line-78"></span><span class="hs-comment">-- &gt; TS pastByronState $ TS pastShelleyState $ TZ currentGoguenState</span><span>
</span><span id="line-79"></span><span class="hs-comment">--</span><span>
</span><span id="line-80"></span><span class="hs-comment">-- The 'Telescope' API mostly follows @sop-core@ conventions, supporting</span><span>
</span><span id="line-81"></span><span class="hs-comment">-- functor ('hmap', 'hcmap'), applicative ('hap', 'hpure'), foldable</span><span>
</span><span id="line-82"></span><span class="hs-comment">-- ('hcollapse') and traversable ('hsequence''). However, since 'Telescope'</span><span>
</span><span id="line-83"></span><span class="hs-comment">-- is a bi-functor, it cannot reuse the @sop-core@ classes. The naming scheme</span><span>
</span><span id="line-84"></span><span class="hs-comment">-- of the functions is adopted from @sop-core@ though; for example:</span><span>
</span><span id="line-85"></span><span class="hs-comment">--</span><span>
</span><span id="line-86"></span><span class="hs-comment">-- &gt; bi h (c) zipWith</span><span>
</span><span id="line-87"></span><span class="hs-comment">-- &gt; |  |  |    |</span><span>
</span><span id="line-88"></span><span class="hs-comment">-- &gt; |  |  |    \ zipWith: the name from base</span><span>
</span><span id="line-89"></span><span class="hs-comment">-- &gt; |  |  |</span><span>
</span><span id="line-90"></span><span class="hs-comment">-- &gt; |  |  \ constrained: version of the function with a constraint parameter</span><span>
</span><span id="line-91"></span><span class="hs-comment">-- &gt; |  |</span><span>
</span><span id="line-92"></span><span class="hs-comment">-- &gt; |  \ higher order: 'Telescope' (like 'NS'/'NP') is a /higher order/ functor</span><span>
</span><span id="line-93"></span><span class="hs-comment">-- &gt; |</span><span>
</span><span id="line-94"></span><span class="hs-comment">-- &gt; \ bifunctor: 'Telescope' (unlike 'NS'/'NP') is a higher order /bifunctor/</span><span>
</span><span id="line-95"></span><span class="hs-comment">--</span><span>
</span><span id="line-96"></span><span class="hs-comment">-- In addition to the standard SOP operators, the new operators that make</span><span>
</span><span id="line-97"></span><span class="hs-comment">-- a 'Telescope' a telescope are 'extend', 'retract' and 'align'; see their</span><span>
</span><span id="line-98"></span><span class="hs-comment">-- documentation for details.</span><span>
</span><span id="line-99"></span><span class="hs-keyword">data</span><span> </span><span id="Telescope"><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-var">Telescope</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680012973"><span class="annot"><a href="#local-6989586621680012973"><span class="hs-identifier hs-type">g</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621680012972"><span class="annot"><a href="#local-6989586621680012972"><span class="hs-identifier hs-type hs-type">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680012971"><span class="annot"><a href="#local-6989586621680012971"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621680012972"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680012970"><span class="annot"><a href="#local-6989586621680012970"><span class="hs-identifier hs-type">xs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621680012972"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-100"></span><span>  </span><span id="local-6989586621680012968"><span id="local-6989586621680012969"><span id="local-6989586621680013742"><span id="local-6989586621680013744"><span id="TZ"><span class="annot"><a href="Data.SOP.Telescope.html#TZ"><span class="hs-identifier hs-var">TZ</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680013744"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012969"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>                        </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013742"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013744"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680012969"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621680012968"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-101"></span><span>  </span><span id="local-6989586621680012965"><span id="local-6989586621680012966"><span id="local-6989586621680013729"><span id="local-6989586621680013731"><span id="TS"><span class="annot"><a href="Data.SOP.Telescope.html#TS"><span class="hs-identifier hs-var">TS</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680013731"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012966"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013731"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013729"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012965"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013731"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013729"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680012966"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621680012965"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  SOP class instances for 'Telescope'
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="Prod"><span class="annot"><span class="hs-identifier hs-var">Prod</span></span></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span id="local-6989586621680012963"><span class="annot"><a href="#local-6989586621680012963"><span class="hs-identifier hs-type hs-type">g</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#NP"><span class="hs-identifier hs-type">NP</span></a></span><span>
</span><span id="line-108"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="SListIN"><span class="annot"><span class="hs-identifier hs-var">SListIN</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span id="local-6989586621680012962"><span class="annot"><a href="#local-6989586621680012962"><span class="hs-identifier hs-type hs-type">g</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SListI</span></span><span>
</span><span id="line-109"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="AllN"><span class="annot"><span class="hs-identifier hs-var">AllN</span></span></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span id="local-6989586621680012961"><span class="annot"><a href="#local-6989586621680012961"><span class="hs-identifier hs-type hs-type">g</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680012960"><span class="annot"><a href="#local-6989586621680012960"><span class="hs-identifier hs-type hs-type">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">All</span></span><span> </span><span class="annot"><a href="#local-6989586621680012960"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span id="local-6989586621680012959"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HAp</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012959"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-112"></span><span>  </span><span id="local-6989586621680012954"><span class="annot"><span class="annottext">hap :: Prod (Telescope g) (f -.-&gt; g) xs
-&gt; Telescope g f xs -&gt; Telescope g g xs
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">hap</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Telescope g f xs -&gt; NP (f -.-&gt; g) xs -&gt; Telescope g g xs)
-&gt; NP (f -.-&gt; g) xs -&gt; Telescope g f xs -&gt; Telescope g g xs
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope g f xs -&gt; NP (f -.-&gt; g) xs -&gt; Telescope g g xs
forall (f :: k -&gt; *) (xs :: [k]) (f' :: k -&gt; *).
Telescope g f xs -&gt; NP (f -.-&gt; f') xs -&gt; Telescope g f' xs
</span><a href="#local-6989586621680012951"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-113"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-114"></span><span>      </span><span class="hs-comment">-- We could define this in terms of 'bihap' but we lack 'SListI'</span><span>
</span><span id="line-115"></span><span>      </span><span id="local-6989586621680013753"><span id="local-6989586621680013754"><span id="local-6989586621680013755"><span class="annot"><a href="#local-6989586621680012951"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012959"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013755"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013754"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#NP"><span class="hs-identifier hs-type">NP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680013755"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">-.-&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680013753"><span class="hs-identifier hs-type">f'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680013754"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012959"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013753"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013754"><span class="hs-identifier hs-type">xs</span></a></span></span></span></span><span>
</span><span id="line-116"></span><span>      </span><span id="local-6989586621680012951"><span class="annot"><span class="annottext">go :: Telescope g f xs -&gt; NP (f -.-&gt; f') xs -&gt; Telescope g f' xs
</span><a href="#local-6989586621680012951"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#TZ"><span class="hs-identifier hs-type">TZ</span></a></span><span> </span><span id="local-6989586621680012950"><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621680012950"><span class="hs-identifier hs-var">fx</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-special">(</span><span id="local-6989586621680012949"><span class="annot"><span class="annottext">(-.-&gt;) f f' x
</span><a href="#local-6989586621680012949"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#%3A%2A"><span class="hs-operator hs-type">:*</span></a></span><span> </span><span class="annot"><span class="annottext">NP (f -.-&gt; f') xs
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f' x -&gt; Telescope g f' (x : xs)
forall a (f :: a -&gt; *) (x :: a) (g :: a -&gt; *) (xs :: [a]).
f x -&gt; Telescope g f (x : xs)
</span><a href="Data.SOP.Telescope.html#TZ"><span class="hs-identifier hs-var">TZ</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(-.-&gt;) f f' x -&gt; f x -&gt; f' x
forall k (f :: k -&gt; *) (g :: k -&gt; *) (a :: k).
(-.-&gt;) f g a -&gt; f a -&gt; g a
</span><span class="hs-identifier hs-var hs-var">apFn</span></span><span> </span><span class="annot"><span class="annottext">(-.-&gt;) f f' x
</span><a href="#local-6989586621680012949"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">f x
f x
</span><a href="#local-6989586621680012950"><span class="hs-identifier hs-var">fx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span>      </span><span class="annot"><a href="#local-6989586621680012951"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#TS"><span class="hs-identifier hs-type">TS</span></a></span><span> </span><span id="local-6989586621680012946"><span class="annot"><span class="annottext">g x
</span><a href="#local-6989586621680012946"><span class="hs-identifier hs-var">gx</span></a></span></span><span> </span><span id="local-6989586621680012945"><span class="annot"><span class="annottext">Telescope g f xs
</span><a href="#local-6989586621680012945"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(-.-&gt;) f f' x
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#%3A%2A"><span class="hs-operator hs-type">:*</span></a></span><span> </span><span id="local-6989586621680012944"><span class="annot"><span class="annottext">NP (f -.-&gt; f') xs
</span><a href="#local-6989586621680012944"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">g x -&gt; Telescope g f' xs -&gt; Telescope g f' (x : xs)
forall a (g :: a -&gt; *) (x :: a) (f :: a -&gt; *) (xs :: [a]).
g x -&gt; Telescope g f xs -&gt; Telescope g f (x : xs)
</span><a href="Data.SOP.Telescope.html#TS"><span class="hs-identifier hs-var">TS</span></a></span><span> </span><span class="annot"><span class="annottext">g x
</span><a href="#local-6989586621680012946"><span class="hs-identifier hs-var">gx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Telescope g f xs -&gt; NP (f -.-&gt; f') xs -&gt; Telescope g f' xs
forall (f :: k -&gt; *) (xs :: [k]) (f' :: k -&gt; *).
Telescope g f xs -&gt; NP (f -.-&gt; f') xs -&gt; Telescope g f' xs
</span><a href="#local-6989586621680012951"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope g f xs
</span><a href="#local-6989586621680012945"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">NP (f -.-&gt; f') xs
NP (f -.-&gt; f') xs
</span><a href="#local-6989586621680012944"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span id="local-6989586621680012943"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HTraverse_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012943"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-120"></span><span>  </span><span id="local-6989586621680012939"><span class="annot"><span class="annottext">hctraverse_ :: proxy c
-&gt; (forall (a :: k). c a =&gt; f a -&gt; g ())
-&gt; Telescope g f xs
-&gt; g ()
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">hctraverse_</span></span></span><span> </span><span id="local-6989586621680012937"><span class="annot"><span class="annottext">proxy c
</span><a href="#local-6989586621680012937"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">proxy c
-&gt; (forall (x :: k). c x =&gt; g x -&gt; g ())
-&gt; (forall (a :: k). c a =&gt; f a -&gt; g ())
-&gt; Telescope g f xs
-&gt; g ()
forall k (proxy :: (k -&gt; Constraint) -&gt; *) (c :: k -&gt; Constraint)
       (xs :: [k]) (m :: * -&gt; *) (g :: k -&gt; *) (f :: k -&gt; *).
(All c xs, Applicative m) =&gt;
proxy c
-&gt; (forall (x :: k). c x =&gt; g x -&gt; m ())
-&gt; (forall (x :: k). c x =&gt; f x -&gt; m ())
-&gt; Telescope g f xs
-&gt; m ()
</span><a href="Data.SOP.Telescope.html#bihctraverse_"><span class="hs-identifier hs-var">bihctraverse_</span></a></span><span> </span><span class="annot"><span class="annottext">proxy c
</span><a href="#local-6989586621680012937"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">g x
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; g ()
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span>  </span><span id="local-6989586621680012935"><span class="annot"><span class="annottext">htraverse_ :: (forall (a :: k). f a -&gt; g ()) -&gt; Telescope g f xs -&gt; g ()
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">htraverse_</span></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall (x :: k). g x -&gt; g ())
-&gt; (forall (a :: k). f a -&gt; g ()) -&gt; Telescope g f xs -&gt; g ()
forall k (xs :: [k]) (m :: * -&gt; *) (g :: k -&gt; *) (f :: k -&gt; *).
(SListI xs, Applicative m) =&gt;
(forall (x :: k). g x -&gt; m ())
-&gt; (forall (x :: k). f x -&gt; m ()) -&gt; Telescope g f xs -&gt; m ()
</span><a href="Data.SOP.Telescope.html#bihtraverse_"><span class="hs-identifier hs-var">bihtraverse_</span></a></span><span>    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">g x
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; g ()
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span id="local-6989586621680012932"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HSequence</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012932"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-124"></span><span>  </span><span id="local-6989586621680012926"><span class="annot"><span class="annottext">hsequence' :: Telescope g (f :.: g) xs -&gt; f (Telescope g g xs)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">hsequence'</span></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Telescope (f :.: g) (f :.: g) xs -&gt; f (Telescope g g xs)
forall k (m :: * -&gt; *) (g :: k -&gt; *) (f :: k -&gt; *) (xs :: [k]).
(SListI xs, Applicative m) =&gt;
Telescope (m :.: g) (m :.: f) xs -&gt; m (Telescope g f xs)
</span><a href="Data.SOP.Telescope.html#bihsequence%27"><span class="hs-identifier hs-var">bihsequence'</span></a></span><span> </span><span class="annot"><span class="annottext">(Telescope (f :.: g) (f :.: g) xs -&gt; f (Telescope g g xs))
-&gt; (Telescope g (f :.: g) xs -&gt; Telescope (f :.: g) (f :.: g) xs)
-&gt; Telescope g (f :.: g) xs
-&gt; f (Telescope g g xs)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(forall (x :: k). g x -&gt; (:.:) f g x)
-&gt; (forall (x :: k). (:.:) f g x -&gt; (:.:) f g x)
-&gt; Telescope g (f :.: g) xs
-&gt; Telescope (f :.: g) (f :.: g) xs
forall k (xs :: [k]) (g :: k -&gt; *) (g' :: k -&gt; *) (f :: k -&gt; *)
       (f' :: k -&gt; *).
SListI xs =&gt;
(forall (x :: k). g x -&gt; g' x)
-&gt; (forall (x :: k). f x -&gt; f' x)
-&gt; Telescope g f xs
-&gt; Telescope g' f' xs
</span><a href="Data.SOP.Telescope.html#bihmap"><span class="hs-identifier hs-var">bihmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f (g x) -&gt; (:.:) f g x
forall l k (f :: l -&gt; *) (g :: k -&gt; l) (p :: k).
f (g p) -&gt; (:.:) f g p
</span><span class="hs-identifier hs-var">Comp</span></span><span> </span><span class="annot"><span class="annottext">(f (g x) -&gt; (:.:) f g x) -&gt; (g x -&gt; f (g x)) -&gt; g x -&gt; (:.:) f g x
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">g x -&gt; f (g x)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (x :: k). (:.:) f g x -&gt; (:.:) f g x
forall a. a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-125"></span><span>  </span><span id="local-6989586621680012920"><span class="annot"><span class="annottext">hctraverse' :: proxy c
-&gt; (forall (a :: k). c a =&gt; f a -&gt; g (f' a))
-&gt; Telescope g f xs
-&gt; g (Telescope g f' xs)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">hctraverse'</span></span></span><span> </span><span id="local-6989586621680012918"><span class="annot"><span class="annottext">proxy c
</span><a href="#local-6989586621680012918"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">proxy c
-&gt; (forall (x :: k). c x =&gt; g x -&gt; g (g x))
-&gt; (forall (a :: k). c a =&gt; f a -&gt; g (f' a))
-&gt; Telescope g f xs
-&gt; g (Telescope g f' xs)
forall k (proxy :: (k -&gt; Constraint) -&gt; *) (c :: k -&gt; Constraint)
       (m :: * -&gt; *) (g :: k -&gt; *) (g' :: k -&gt; *) (f :: k -&gt; *)
       (f' :: k -&gt; *) (xs :: [k]).
(All c xs, Applicative m) =&gt;
proxy c
-&gt; (forall (x :: k). c x =&gt; g x -&gt; m (g' x))
-&gt; (forall (x :: k). c x =&gt; f x -&gt; m (f' x))
-&gt; Telescope g f xs
-&gt; m (Telescope g' f' xs)
</span><a href="Data.SOP.Telescope.html#bihctraverse%27"><span class="hs-identifier hs-var">bihctraverse'</span></a></span><span> </span><span class="annot"><span class="annottext">proxy c
</span><a href="#local-6989586621680012918"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall (x :: k). c x =&gt; g x -&gt; g (g x)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-126"></span><span>  </span><span id="local-6989586621680012916"><span class="annot"><span class="annottext">htraverse' :: (forall (a :: k). f a -&gt; g (f' a))
-&gt; Telescope g f xs -&gt; g (Telescope g f' xs)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">htraverse'</span></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall (x :: k). g x -&gt; g (g x))
-&gt; (forall (a :: k). f a -&gt; g (f' a))
-&gt; Telescope g f xs
-&gt; g (Telescope g f' xs)
forall k (xs :: [k]) (m :: * -&gt; *) (g :: k -&gt; *) (g' :: k -&gt; *)
       (f :: k -&gt; *) (f' :: k -&gt; *).
(SListI xs, Applicative m) =&gt;
(forall (x :: k). g x -&gt; m (g' x))
-&gt; (forall (x :: k). f x -&gt; m (f' x))
-&gt; Telescope g f xs
-&gt; m (Telescope g' f' xs)
</span><a href="Data.SOP.Telescope.html#bihtraverse%27"><span class="hs-identifier hs-var">bihtraverse'</span></a></span><span>    </span><span class="annot"><span class="annottext">forall (x :: k). g x -&gt; g (g x)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span></span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span class="hs-comment">-- | Specialization of 'hsequence'' with weaker constraints</span><span>
</span><span id="line-129"></span><span class="hs-comment">-- ('Functor' rather than 'Applicative')</span><span>
</span><span id="line-130"></span><span class="annot"><a href="Data.SOP.Telescope.html#sequence"><span class="hs-identifier hs-type">sequence</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680012913"><span class="annot"><a href="#local-6989586621680012913"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621680012912"><span class="annot"><a href="#local-6989586621680012912"><span class="hs-identifier hs-type">g</span></a></span></span><span> </span><span id="local-6989586621680012911"><span class="annot"><a href="#local-6989586621680012911"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621680012910"><span class="annot"><a href="#local-6989586621680012910"><span class="hs-identifier hs-type">xs</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Functor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012913"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-131"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012912"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680012913"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:.:</span></span><span> </span><span class="annot"><a href="#local-6989586621680012911"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680012910"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680012913"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012912"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012911"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012910"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span id="sequence"><span class="annot"><span class="annottext">sequence :: Telescope g (m :.: f) xs -&gt; m (Telescope g f xs)
</span><a href="Data.SOP.Telescope.html#sequence"><span class="hs-identifier hs-var hs-var">sequence</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Telescope g (m :.: f) xs -&gt; m (Telescope g f xs)
forall (xs' :: [k]).
Telescope g (m :.: f) xs' -&gt; m (Telescope g f xs')
</span><a href="#local-6989586621680012909"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-133"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-134"></span><span>    </span><span id="local-6989586621680013596"><span class="annot"><a href="#local-6989586621680012909"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012912"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680012913"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:.:</span></span><span> </span><span class="annot"><a href="#local-6989586621680012911"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680013596"><span class="hs-identifier hs-type">xs'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680012913"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012912"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012911"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013596"><span class="hs-identifier hs-type">xs'</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-135"></span><span>    </span><span id="local-6989586621680012909"><span class="annot"><span class="annottext">go :: Telescope g (m :.: f) xs' -&gt; m (Telescope g f xs')
</span><a href="#local-6989586621680012909"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#TZ"><span class="hs-identifier hs-type">TZ</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Comp</span></span><span> </span><span id="local-6989586621680012908"><span class="annot"><span class="annottext">m (f x)
</span><a href="#local-6989586621680012908"><span class="hs-identifier hs-var">fx</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f x -&gt; Telescope g f (x : xs)
forall a (f :: a -&gt; *) (x :: a) (g :: a -&gt; *) (xs :: [a]).
f x -&gt; Telescope g f (x : xs)
</span><a href="Data.SOP.Telescope.html#TZ"><span class="hs-identifier hs-var">TZ</span></a></span><span> </span><span class="annot"><span class="annottext">(f x -&gt; Telescope g f (x : xs))
-&gt; m (f x) -&gt; m (Telescope g f (x : xs))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">m (f x)
</span><a href="#local-6989586621680012908"><span class="hs-identifier hs-var">fx</span></a></span><span>
</span><span id="line-136"></span><span>    </span><span class="annot"><a href="#local-6989586621680012909"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#TS"><span class="hs-identifier hs-type">TS</span></a></span><span> </span><span id="local-6989586621680012906"><span class="annot"><span class="annottext">g x
</span><a href="#local-6989586621680012906"><span class="hs-identifier hs-var">gx</span></a></span></span><span> </span><span id="local-6989586621680012905"><span class="annot"><span class="annottext">Telescope g (m :.: f) xs
</span><a href="#local-6989586621680012905"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">g x -&gt; Telescope g f xs -&gt; Telescope g f (x : xs)
forall a (g :: a -&gt; *) (x :: a) (f :: a -&gt; *) (xs :: [a]).
g x -&gt; Telescope g f xs -&gt; Telescope g f (x : xs)
</span><a href="Data.SOP.Telescope.html#TS"><span class="hs-identifier hs-var">TS</span></a></span><span> </span><span class="annot"><span class="annottext">g x
</span><a href="#local-6989586621680012906"><span class="hs-identifier hs-var">gx</span></a></span><span> </span><span class="annot"><span class="annottext">(Telescope g f xs -&gt; Telescope g f (x : xs))
-&gt; m (Telescope g f xs) -&gt; m (Telescope g f (x : xs))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope g (m :.: f) xs -&gt; m (Telescope g f xs)
forall (xs' :: [k]).
Telescope g (m :.: f) xs' -&gt; m (Telescope g f xs')
</span><a href="#local-6989586621680012909"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope g (m :.: f) xs
</span><a href="#local-6989586621680012905"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Bifunctor analogues of class methods
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span class="hs-comment">-- | Bifunctor analogue of 'hap'</span><span>
</span><span id="line-143"></span><span id="local-6989586621680013473"><span id="local-6989586621680013474"><span id="local-6989586621680013475"><span id="local-6989586621680013476"><span id="local-6989586621680013477"><span class="annot"><a href="Data.SOP.Telescope.html#bihap"><span class="hs-identifier hs-type">bihap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#NP"><span class="hs-identifier hs-type">NP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680013477"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">-.-&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680013476"><span class="hs-identifier hs-type">g'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680013475"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-144"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#NP"><span class="hs-identifier hs-type">NP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680013474"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">-.-&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680013473"><span class="hs-identifier hs-type">f'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680013475"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-145"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013477"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013474"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013475"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013476"><span class="hs-identifier hs-type">g'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013473"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013475"><span class="hs-identifier hs-type">xs</span></a></span></span></span></span></span></span><span>
</span><span id="line-146"></span><span id="bihap"><span class="annot"><span class="annottext">bihap :: NP (g -.-&gt; g') xs
-&gt; NP (f -.-&gt; f') xs -&gt; Telescope g f xs -&gt; Telescope g' f' xs
</span><a href="Data.SOP.Telescope.html#bihap"><span class="hs-identifier hs-var hs-var">bihap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680012904"><span class="annot"><span class="annottext">NP (g -.-&gt; g') xs
</span><a href="#local-6989586621680012904"><span class="hs-identifier hs-var">gs</span></a></span></span><span> </span><span id="local-6989586621680012903"><span class="annot"><span class="annottext">NP (f -.-&gt; f') xs
</span><a href="#local-6989586621680012903"><span class="hs-identifier hs-var">fs</span></a></span></span><span> </span><span id="local-6989586621680012902"><span class="annot"><span class="annottext">Telescope g f xs
</span><a href="#local-6989586621680012902"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Telescope g f xs
-&gt; NP (g -.-&gt; g') xs -&gt; NP (f -.-&gt; f') xs -&gt; Telescope g' f' xs
forall k (g :: k -&gt; *) (f :: k -&gt; *) (xs :: [k]) (g' :: k -&gt; *)
       (f' :: k -&gt; *).
Telescope g f xs
-&gt; NP (g -.-&gt; g') xs -&gt; NP (f -.-&gt; f') xs -&gt; Telescope g' f' xs
</span><a href="#local-6989586621680012901"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope g f xs
</span><a href="#local-6989586621680012902"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">NP (g -.-&gt; g') xs
</span><a href="#local-6989586621680012904"><span class="hs-identifier hs-var">gs</span></a></span><span> </span><span class="annot"><span class="annottext">NP (f -.-&gt; f') xs
</span><a href="#local-6989586621680012903"><span class="hs-identifier hs-var">fs</span></a></span><span>
</span><span id="line-147"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-148"></span><span>    </span><span id="local-6989586621680013576"><span id="local-6989586621680013577"><span id="local-6989586621680013578"><span id="local-6989586621680013579"><span id="local-6989586621680013580"><span class="annot"><a href="#local-6989586621680012901"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013580"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013579"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013578"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-149"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#NP"><span class="hs-identifier hs-type">NP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680013580"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">-.-&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680013577"><span class="hs-identifier hs-type">g'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680013578"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-150"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#NP"><span class="hs-identifier hs-type">NP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680013579"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">-.-&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680013576"><span class="hs-identifier hs-type">f'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680013578"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-151"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013577"><span class="hs-identifier hs-type">g'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013576"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013578"><span class="hs-identifier hs-type">xs</span></a></span></span></span></span></span></span><span>
</span><span id="line-152"></span><span>    </span><span id="local-6989586621680012901"><span class="annot"><span class="annottext">go :: Telescope g f xs
-&gt; NP (g -.-&gt; g') xs -&gt; NP (f -.-&gt; f') xs -&gt; Telescope g' f' xs
</span><a href="#local-6989586621680012901"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#TZ"><span class="hs-identifier hs-type">TZ</span></a></span><span> </span><span id="local-6989586621680012900"><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621680012900"><span class="hs-identifier hs-var">fx</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="annot"><span class="annottext">NP (g -.-&gt; g') xs
</span><span class="hs-identifier">_</span></span><span>         </span><span class="hs-special">(</span><span id="local-6989586621680012899"><span class="annot"><span class="annottext">(-.-&gt;) f f' x
</span><a href="#local-6989586621680012899"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#%3A%2A"><span class="hs-operator hs-type">:*</span></a></span><span> </span><span class="annot"><span class="annottext">NP (f -.-&gt; f') xs
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f' x -&gt; Telescope g' f' (x : xs)
forall a (f :: a -&gt; *) (x :: a) (g :: a -&gt; *) (xs :: [a]).
f x -&gt; Telescope g f (x : xs)
</span><a href="Data.SOP.Telescope.html#TZ"><span class="hs-identifier hs-var">TZ</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(-.-&gt;) f f' x -&gt; f x -&gt; f' x
forall k (f :: k -&gt; *) (g :: k -&gt; *) (a :: k).
(-.-&gt;) f g a -&gt; f a -&gt; g a
</span><span class="hs-identifier hs-var hs-var">apFn</span></span><span> </span><span class="annot"><span class="annottext">(-.-&gt;) f f' x
</span><a href="#local-6989586621680012899"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">f x
f x
</span><a href="#local-6989586621680012900"><span class="hs-identifier hs-var">fx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span>    </span><span class="annot"><a href="#local-6989586621680012901"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#TS"><span class="hs-identifier hs-type">TS</span></a></span><span> </span><span id="local-6989586621680012898"><span class="annot"><span class="annottext">g x
</span><a href="#local-6989586621680012898"><span class="hs-identifier hs-var">gx</span></a></span></span><span> </span><span id="local-6989586621680012897"><span class="annot"><span class="annottext">Telescope g f xs
</span><a href="#local-6989586621680012897"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680012896"><span class="annot"><span class="annottext">(-.-&gt;) g g' x
</span><a href="#local-6989586621680012896"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#%3A%2A"><span class="hs-operator hs-type">:*</span></a></span><span> </span><span id="local-6989586621680012895"><span class="annot"><span class="annottext">NP (g -.-&gt; g') xs
</span><a href="#local-6989586621680012895"><span class="hs-identifier hs-var">gs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(-.-&gt;) f f' x
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#%3A%2A"><span class="hs-operator hs-type">:*</span></a></span><span> </span><span id="local-6989586621680012894"><span class="annot"><span class="annottext">NP (f -.-&gt; f') xs
</span><a href="#local-6989586621680012894"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">g' x -&gt; Telescope g' f' xs -&gt; Telescope g' f' (x : xs)
forall a (g :: a -&gt; *) (x :: a) (f :: a -&gt; *) (xs :: [a]).
g x -&gt; Telescope g f xs -&gt; Telescope g f (x : xs)
</span><a href="Data.SOP.Telescope.html#TS"><span class="hs-identifier hs-var">TS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(-.-&gt;) g g' x -&gt; g x -&gt; g' x
forall k (f :: k -&gt; *) (g :: k -&gt; *) (a :: k).
(-.-&gt;) f g a -&gt; f a -&gt; g a
</span><span class="hs-identifier hs-var hs-var">apFn</span></span><span> </span><span class="annot"><span class="annottext">(-.-&gt;) g g' x
</span><a href="#local-6989586621680012896"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">g x
g x
</span><a href="#local-6989586621680012898"><span class="hs-identifier hs-var">gx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Telescope g f xs
-&gt; NP (g -.-&gt; g') xs -&gt; NP (f -.-&gt; f') xs -&gt; Telescope g' f' xs
forall k (g :: k -&gt; *) (f :: k -&gt; *) (xs :: [k]) (g' :: k -&gt; *)
       (f' :: k -&gt; *).
Telescope g f xs
-&gt; NP (g -.-&gt; g') xs -&gt; NP (f -.-&gt; f') xs -&gt; Telescope g' f' xs
</span><a href="#local-6989586621680012901"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope g f xs
</span><a href="#local-6989586621680012897"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">NP (g -.-&gt; g') xs
NP (g -.-&gt; g') xs
</span><a href="#local-6989586621680012895"><span class="hs-identifier hs-var">gs</span></a></span><span> </span><span class="annot"><span class="annottext">NP (f -.-&gt; f') xs
NP (f -.-&gt; f') xs
</span><a href="#local-6989586621680012894"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span class="hs-comment">-- | Bifunctor analogue of 'hctraverse''</span><span>
</span><span id="line-156"></span><span class="annot"><a href="Data.SOP.Telescope.html#bihctraverse%27"><span class="hs-identifier hs-type">bihctraverse'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680013620"><span class="annot"><a href="#local-6989586621680013620"><span class="hs-identifier hs-type">proxy</span></a></span></span><span> </span><span id="local-6989586621680013623"><span class="annot"><a href="#local-6989586621680013623"><span class="hs-identifier hs-type">c</span></a></span></span><span> </span><span id="local-6989586621680013621"><span class="annot"><a href="#local-6989586621680013621"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621680013619"><span class="annot"><a href="#local-6989586621680013619"><span class="hs-identifier hs-type">g</span></a></span></span><span> </span><span id="local-6989586621680013618"><span class="annot"><a href="#local-6989586621680013618"><span class="hs-identifier hs-type">g'</span></a></span></span><span> </span><span id="local-6989586621680013616"><span class="annot"><a href="#local-6989586621680013616"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621680013615"><span class="annot"><a href="#local-6989586621680013615"><span class="hs-identifier hs-type">f'</span></a></span></span><span> </span><span id="local-6989586621680013622"><span class="annot"><a href="#local-6989586621680013622"><span class="hs-identifier hs-type">xs</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">All</span></span><span> </span><span class="annot"><a href="#local-6989586621680013623"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013622"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Applicative</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013621"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-157"></span><span>              </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680013620"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013623"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-158"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680013625"><span class="annot"><a href="#local-6989586621680013625"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621680013623"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013625"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680013619"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013625"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680013621"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680013618"><span class="hs-identifier hs-type">g'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013625"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-159"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680013617"><span class="annot"><a href="#local-6989586621680013617"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621680013623"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013617"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680013616"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013617"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680013621"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680013615"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013617"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013619"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013616"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013622"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680013621"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013618"><span class="hs-identifier hs-type">g'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013615"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013622"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-161"></span><span id="bihctraverse%27"><span class="annot"><span class="annottext">bihctraverse' :: proxy c
-&gt; (forall (x :: k). c x =&gt; g x -&gt; m (g' x))
-&gt; (forall (x :: k). c x =&gt; f x -&gt; m (f' x))
-&gt; Telescope g f xs
-&gt; m (Telescope g' f' xs)
</span><a href="Data.SOP.Telescope.html#bihctraverse%27"><span class="hs-identifier hs-var hs-var">bihctraverse'</span></a></span></span><span> </span><span class="annot"><span class="annottext">proxy c
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680012893"><span class="annot"><span class="annottext">forall (x :: k). c x =&gt; g x -&gt; m (g' x)
</span><a href="#local-6989586621680012893"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621680012892"><span class="annot"><span class="annottext">forall (x :: k). c x =&gt; f x -&gt; m (f' x)
</span><a href="#local-6989586621680012892"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Telescope g f xs -&gt; m (Telescope g' f' xs)
forall (xs' :: [k]).
All c xs' =&gt;
Telescope g f xs' -&gt; m (Telescope g' f' xs')
</span><a href="#local-6989586621680012891"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-162"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-163"></span><span>    </span><span id="local-6989586621680013550"><span class="annot"><a href="#local-6989586621680012891"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">All</span></span><span> </span><span class="annot"><a href="#local-6989586621680013623"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013550"><span class="hs-identifier hs-type">xs'</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013619"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013616"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013550"><span class="hs-identifier hs-type">xs'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680013621"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013618"><span class="hs-identifier hs-type">g'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013615"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013550"><span class="hs-identifier hs-type">xs'</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-164"></span><span>    </span><span id="local-6989586621680012891"><span class="annot"><span class="annottext">go :: Telescope g f xs' -&gt; m (Telescope g' f' xs')
</span><a href="#local-6989586621680012891"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#TZ"><span class="hs-identifier hs-type">TZ</span></a></span><span> </span><span id="local-6989586621680012890"><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621680012890"><span class="hs-identifier hs-var">fx</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f' x -&gt; Telescope g' f' (x : xs)
forall a (f :: a -&gt; *) (x :: a) (g :: a -&gt; *) (xs :: [a]).
f x -&gt; Telescope g f (x : xs)
</span><a href="Data.SOP.Telescope.html#TZ"><span class="hs-identifier hs-var">TZ</span></a></span><span> </span><span class="annot"><span class="annottext">(f' x -&gt; Telescope g' f' (x : xs))
-&gt; m (f' x) -&gt; m (Telescope g' f' (x : xs))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">f x -&gt; m (f' x)
forall (x :: k). c x =&gt; f x -&gt; m (f' x)
</span><a href="#local-6989586621680012892"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621680012890"><span class="hs-identifier hs-var">fx</span></a></span><span>
</span><span id="line-165"></span><span>    </span><span class="annot"><a href="#local-6989586621680012891"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#TS"><span class="hs-identifier hs-type">TS</span></a></span><span> </span><span id="local-6989586621680012889"><span class="annot"><span class="annottext">g x
</span><a href="#local-6989586621680012889"><span class="hs-identifier hs-var">gx</span></a></span></span><span> </span><span id="local-6989586621680012888"><span class="annot"><span class="annottext">Telescope g f xs
</span><a href="#local-6989586621680012888"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">g' x -&gt; Telescope g' f' xs -&gt; Telescope g' f' (x : xs)
forall a (g :: a -&gt; *) (x :: a) (f :: a -&gt; *) (xs :: [a]).
g x -&gt; Telescope g f xs -&gt; Telescope g f (x : xs)
</span><a href="Data.SOP.Telescope.html#TS"><span class="hs-identifier hs-var">TS</span></a></span><span> </span><span class="annot"><span class="annottext">(g' x -&gt; Telescope g' f' xs -&gt; Telescope g' f' (x : xs))
-&gt; m (g' x) -&gt; m (Telescope g' f' xs -&gt; Telescope g' f' (x : xs))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">g x -&gt; m (g' x)
forall (x :: k). c x =&gt; g x -&gt; m (g' x)
</span><a href="#local-6989586621680012893"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">g x
</span><a href="#local-6989586621680012889"><span class="hs-identifier hs-var">gx</span></a></span><span> </span><span class="annot"><span class="annottext">m (Telescope g' f' xs -&gt; Telescope g' f' (x : xs))
-&gt; m (Telescope g' f' xs) -&gt; m (Telescope g' f' (x : xs))
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope g f xs -&gt; m (Telescope g' f' xs)
forall (xs' :: [k]).
All c xs' =&gt;
Telescope g f xs' -&gt; m (Telescope g' f' xs')
</span><a href="#local-6989586621680012891"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope g f xs
</span><a href="#local-6989586621680012888"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-166"></span><span>
</span><span id="line-167"></span><span class="hs-comment">-- | Bifunctor analogue of 'htraverse''</span><span>
</span><span id="line-168"></span><span id="local-6989586621680013602"><span id="local-6989586621680013604"><span id="local-6989586621680013605"><span id="local-6989586621680013606"><span id="local-6989586621680013607"><span id="local-6989586621680013608"><span class="annot"><a href="Data.SOP.Telescope.html#bihtraverse%27"><span class="hs-identifier hs-type">bihtraverse'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SListI</span></span><span> </span><span class="annot"><a href="#local-6989586621680013608"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Applicative</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013607"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span>             </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680013610"><span class="annot"><a href="#local-6989586621680013610"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621680013606"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013610"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680013607"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680013605"><span class="hs-identifier hs-type">g'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013610"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-170"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680013603"><span class="annot"><a href="#local-6989586621680013603"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621680013604"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013603"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680013607"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680013602"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013603"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013606"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013604"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013608"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680013607"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013605"><span class="hs-identifier hs-type">g'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013602"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013608"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-172"></span><span id="bihtraverse%27"><span class="annot"><span class="annottext">bihtraverse' :: (forall (x :: k). g x -&gt; m (g' x))
-&gt; (forall (x :: k). f x -&gt; m (f' x))
-&gt; Telescope g f xs
-&gt; m (Telescope g' f' xs)
</span><a href="Data.SOP.Telescope.html#bihtraverse%27"><span class="hs-identifier hs-var hs-var">bihtraverse'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy Top
-&gt; (forall (x :: k). Top x =&gt; g x -&gt; m (g' x))
-&gt; (forall (x :: k). Top x =&gt; f x -&gt; m (f' x))
-&gt; Telescope g f xs
-&gt; m (Telescope g' f' xs)
forall k (proxy :: (k -&gt; Constraint) -&gt; *) (c :: k -&gt; Constraint)
       (m :: * -&gt; *) (g :: k -&gt; *) (g' :: k -&gt; *) (f :: k -&gt; *)
       (f' :: k -&gt; *) (xs :: [k]).
(All c xs, Applicative m) =&gt;
proxy c
-&gt; (forall (x :: k). c x =&gt; g x -&gt; m (g' x))
-&gt; (forall (x :: k). c x =&gt; f x -&gt; m (f' x))
-&gt; Telescope g f xs
-&gt; m (Telescope g' f' xs)
</span><a href="Data.SOP.Telescope.html#bihctraverse%27"><span class="hs-identifier hs-var">bihctraverse'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy Top
forall k (t :: k). Proxy t
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Top</span></span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span class="hs-comment">-- | Bifunctor analogue of 'hsequence''</span><span>
</span><span id="line-175"></span><span class="annot"><a href="Data.SOP.Telescope.html#bihsequence%27"><span class="hs-identifier hs-type">bihsequence'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680013652"><span class="annot"><a href="#local-6989586621680013652"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621680013651"><span class="annot"><a href="#local-6989586621680013651"><span class="hs-identifier hs-type">g</span></a></span></span><span> </span><span id="local-6989586621680013650"><span class="annot"><a href="#local-6989586621680013650"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621680013653"><span class="annot"><a href="#local-6989586621680013653"><span class="hs-identifier hs-type">xs</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SListI</span></span><span> </span><span class="annot"><a href="#local-6989586621680013653"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Applicative</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013652"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-176"></span><span>             </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680013652"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:.:</span></span><span> </span><span class="annot"><a href="#local-6989586621680013651"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680013652"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:.:</span></span><span> </span><span class="annot"><a href="#local-6989586621680013650"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680013653"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680013652"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013651"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013650"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013653"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span id="bihsequence%27"><span class="annot"><span class="annottext">bihsequence' :: Telescope (m :.: g) (m :.: f) xs -&gt; m (Telescope g f xs)
</span><a href="Data.SOP.Telescope.html#bihsequence%27"><span class="hs-identifier hs-var hs-var">bihsequence'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall (x :: k). (:.:) m g x -&gt; m (g x))
-&gt; (forall (x :: k). (:.:) m f x -&gt; m (f x))
-&gt; Telescope (m :.: g) (m :.: f) xs
-&gt; m (Telescope g f xs)
forall k (xs :: [k]) (m :: * -&gt; *) (g :: k -&gt; *) (g' :: k -&gt; *)
       (f :: k -&gt; *) (f' :: k -&gt; *).
(SListI xs, Applicative m) =&gt;
(forall (x :: k). g x -&gt; m (g' x))
-&gt; (forall (x :: k). f x -&gt; m (f' x))
-&gt; Telescope g f xs
-&gt; m (Telescope g' f' xs)
</span><a href="Data.SOP.Telescope.html#bihtraverse%27"><span class="hs-identifier hs-var">bihtraverse'</span></a></span><span> </span><span class="annot"><span class="annottext">forall (x :: k). (:.:) m g x -&gt; m (g x)
forall l k (f :: l -&gt; *) (g :: k -&gt; l) (p :: k).
(:.:) f g p -&gt; f (g p)
</span><span class="hs-identifier hs-var">unComp</span></span><span> </span><span class="annot"><span class="annottext">forall (x :: k). (:.:) m f x -&gt; m (f x)
forall l k (f :: l -&gt; *) (g :: k -&gt; l) (p :: k).
(:.:) f g p -&gt; f (g p)
</span><span class="hs-identifier hs-var">unComp</span></span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span class="hs-comment">-- | Bifunctor analogue of 'hctraverse_'</span><span>
</span><span id="line-180"></span><span class="annot"><a href="Data.SOP.Telescope.html#bihctraverse_"><span class="hs-identifier hs-type">bihctraverse_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680013698"><span class="annot"><a href="#local-6989586621680013698"><span class="hs-identifier hs-type">proxy</span></a></span></span><span> </span><span id="local-6989586621680013702"><span class="annot"><a href="#local-6989586621680013702"><span class="hs-identifier hs-type">c</span></a></span></span><span> </span><span id="local-6989586621680013701"><span class="annot"><a href="#local-6989586621680013701"><span class="hs-identifier hs-type">xs</span></a></span></span><span> </span><span id="local-6989586621680013699"><span class="annot"><a href="#local-6989586621680013699"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621680013697"><span class="annot"><a href="#local-6989586621680013697"><span class="hs-identifier hs-type">g</span></a></span></span><span> </span><span id="local-6989586621680013695"><span class="annot"><a href="#local-6989586621680013695"><span class="hs-identifier hs-type">f</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">All</span></span><span> </span><span class="annot"><a href="#local-6989586621680013702"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013701"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Applicative</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013699"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-181"></span><span>              </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680013698"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013702"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-182"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680013704"><span class="annot"><a href="#local-6989586621680013704"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621680013702"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013704"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680013697"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013704"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680013699"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680013696"><span class="annot"><a href="#local-6989586621680013696"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621680013702"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013696"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680013695"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013696"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680013699"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-184"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013697"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013695"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013701"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680013699"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span id="bihctraverse_"><span class="annot"><span class="annottext">bihctraverse_ :: proxy c
-&gt; (forall (x :: k). c x =&gt; g x -&gt; m ())
-&gt; (forall (x :: k). c x =&gt; f x -&gt; m ())
-&gt; Telescope g f xs
-&gt; m ()
</span><a href="Data.SOP.Telescope.html#bihctraverse_"><span class="hs-identifier hs-var hs-var">bihctraverse_</span></a></span></span><span> </span><span class="annot"><span class="annottext">proxy c
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680012885"><span class="annot"><span class="annottext">forall (x :: k). c x =&gt; g x -&gt; m ()
</span><a href="#local-6989586621680012885"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621680012884"><span class="annot"><span class="annottext">forall (x :: k). c x =&gt; f x -&gt; m ()
</span><a href="#local-6989586621680012884"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Telescope g f xs -&gt; m ()
forall (xs' :: [k]). All c xs' =&gt; Telescope g f xs' -&gt; m ()
</span><a href="#local-6989586621680012883"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-186"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-187"></span><span>    </span><span id="local-6989586621680013514"><span class="annot"><a href="#local-6989586621680012883"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">All</span></span><span> </span><span class="annot"><a href="#local-6989586621680013702"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013514"><span class="hs-identifier hs-type">xs'</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013697"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013695"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013514"><span class="hs-identifier hs-type">xs'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680013699"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-188"></span><span>    </span><span id="local-6989586621680012883"><span class="annot"><span class="annottext">go :: Telescope g f xs' -&gt; m ()
</span><a href="#local-6989586621680012883"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#TZ"><span class="hs-identifier hs-type">TZ</span></a></span><span> </span><span id="local-6989586621680012882"><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621680012882"><span class="hs-identifier hs-var">fx</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f x -&gt; m ()
forall (x :: k). c x =&gt; f x -&gt; m ()
</span><a href="#local-6989586621680012884"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621680012882"><span class="hs-identifier hs-var">fx</span></a></span><span>
</span><span id="line-189"></span><span>    </span><span class="annot"><a href="#local-6989586621680012883"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#TS"><span class="hs-identifier hs-type">TS</span></a></span><span> </span><span id="local-6989586621680012881"><span class="annot"><span class="annottext">g x
</span><a href="#local-6989586621680012881"><span class="hs-identifier hs-var">gx</span></a></span></span><span> </span><span id="local-6989586621680012880"><span class="annot"><span class="annottext">Telescope g f xs
</span><a href="#local-6989586621680012880"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">g x -&gt; m ()
forall (x :: k). c x =&gt; g x -&gt; m ()
</span><a href="#local-6989586621680012885"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">g x
</span><a href="#local-6989586621680012881"><span class="hs-identifier hs-var">gx</span></a></span><span> </span><span class="annot"><span class="annottext">m () -&gt; m () -&gt; m ()
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope g f xs -&gt; m ()
forall (xs' :: [k]). All c xs' =&gt; Telescope g f xs' -&gt; m ()
</span><a href="#local-6989586621680012883"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope g f xs
</span><a href="#local-6989586621680012880"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-190"></span><span>
</span><span id="line-191"></span><span id="local-6989586621680013682"><span id="local-6989586621680013683"><span id="local-6989586621680013684"><span id="local-6989586621680013686"><span class="annot"><a href="Data.SOP.Telescope.html#bihtraverse_"><span class="hs-identifier hs-type">bihtraverse_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SListI</span></span><span> </span><span class="annot"><a href="#local-6989586621680013686"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Applicative</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013684"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-192"></span><span>             </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680013688"><span class="annot"><a href="#local-6989586621680013688"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621680013683"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013688"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680013684"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-193"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680013681"><span class="annot"><a href="#local-6989586621680013681"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621680013682"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013681"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680013684"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-194"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013683"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013682"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013686"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680013684"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-195"></span><span id="bihtraverse_"><span class="annot"><span class="annottext">bihtraverse_ :: (forall (x :: k). g x -&gt; m ())
-&gt; (forall (x :: k). f x -&gt; m ()) -&gt; Telescope g f xs -&gt; m ()
</span><a href="Data.SOP.Telescope.html#bihtraverse_"><span class="hs-identifier hs-var hs-var">bihtraverse_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy Top
-&gt; (forall (x :: k). Top x =&gt; g x -&gt; m ())
-&gt; (forall (x :: k). Top x =&gt; f x -&gt; m ())
-&gt; Telescope g f xs
-&gt; m ()
forall k (proxy :: (k -&gt; Constraint) -&gt; *) (c :: k -&gt; Constraint)
       (xs :: [k]) (m :: * -&gt; *) (g :: k -&gt; *) (f :: k -&gt; *).
(All c xs, Applicative m) =&gt;
proxy c
-&gt; (forall (x :: k). c x =&gt; g x -&gt; m ())
-&gt; (forall (x :: k). c x =&gt; f x -&gt; m ())
-&gt; Telescope g f xs
-&gt; m ()
</span><a href="Data.SOP.Telescope.html#bihctraverse_"><span class="hs-identifier hs-var">bihctraverse_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy Top
forall k (t :: k). Proxy t
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Top</span></span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Bifunctor analogues of derived functions
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span class="hs-comment">-- | Bifunctor analogue of 'hmap'</span><span>
</span><span id="line-202"></span><span id="local-6989586621680013639"><span id="local-6989586621680013640"><span id="local-6989586621680013641"><span id="local-6989586621680013642"><span id="local-6989586621680013643"><span class="annot"><a href="Data.SOP.Telescope.html#bihmap"><span class="hs-identifier hs-type">bihmap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SListI</span></span><span> </span><span class="annot"><a href="#local-6989586621680013643"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-203"></span><span>       </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680013646"><span class="annot"><a href="#local-6989586621680013646"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621680013642"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013646"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680013641"><span class="hs-identifier hs-type">g'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013646"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-204"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680013645"><span class="annot"><a href="#local-6989586621680013645"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621680013640"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013645"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680013639"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013645"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-205"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013642"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013640"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013643"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013641"><span class="hs-identifier hs-type">g'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013639"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013643"><span class="hs-identifier hs-type">xs</span></a></span></span></span></span></span></span><span>
</span><span id="line-206"></span><span id="bihmap"><span class="annot"><span class="annottext">bihmap :: (forall (x :: k). g x -&gt; g' x)
-&gt; (forall (x :: k). f x -&gt; f' x)
-&gt; Telescope g f xs
-&gt; Telescope g' f' xs
</span><a href="Data.SOP.Telescope.html#bihmap"><span class="hs-identifier hs-var hs-var">bihmap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy Top
-&gt; (forall (x :: k). Top x =&gt; g x -&gt; g' x)
-&gt; (forall (x :: k). Top x =&gt; f x -&gt; f' x)
-&gt; Telescope g f xs
-&gt; Telescope g' f' xs
forall k (c :: k -&gt; Constraint) (xs :: [k])
       (proxy :: (k -&gt; Constraint) -&gt; *) (g :: k -&gt; *) (g' :: k -&gt; *)
       (f :: k -&gt; *) (f' :: k -&gt; *).
All c xs =&gt;
proxy c
-&gt; (forall (x :: k). c x =&gt; g x -&gt; g' x)
-&gt; (forall (x :: k). c x =&gt; f x -&gt; f' x)
-&gt; Telescope g f xs
-&gt; Telescope g' f' xs
</span><a href="Data.SOP.Telescope.html#bihcmap"><span class="hs-identifier hs-var">bihcmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy Top
forall k (t :: k). Proxy t
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Top</span></span><span class="hs-special">)</span><span>
</span><span id="line-207"></span><span>
</span><span id="line-208"></span><span class="hs-comment">-- | Bifunctor analogue of 'hcmap'</span><span>
</span><span id="line-209"></span><span id="local-6989586621680013487"><span id="local-6989586621680013488"><span id="local-6989586621680013489"><span id="local-6989586621680013490"><span id="local-6989586621680013491"><span id="local-6989586621680013492"><span id="local-6989586621680013493"><span class="annot"><a href="Data.SOP.Telescope.html#bihcmap"><span class="hs-identifier hs-type">bihcmap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">All</span></span><span> </span><span class="annot"><a href="#local-6989586621680013493"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013492"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-210"></span><span>        </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680013491"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013493"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-211"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680013496"><span class="annot"><a href="#local-6989586621680013496"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621680013493"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013496"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680013490"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013496"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680013489"><span class="hs-identifier hs-type">g'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013496"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-212"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680013495"><span class="annot"><a href="#local-6989586621680013495"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621680013493"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013495"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680013488"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013495"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680013487"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013495"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-213"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013490"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013488"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013492"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013489"><span class="hs-identifier hs-type">g'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013487"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013492"><span class="hs-identifier hs-type">xs</span></a></span></span></span></span></span></span></span></span><span>
</span><span id="line-214"></span><span id="bihcmap"><span class="annot"><span class="annottext">bihcmap :: proxy c
-&gt; (forall (x :: k). c x =&gt; g x -&gt; g' x)
-&gt; (forall (x :: k). c x =&gt; f x -&gt; f' x)
-&gt; Telescope g f xs
-&gt; Telescope g' f' xs
</span><a href="Data.SOP.Telescope.html#bihcmap"><span class="hs-identifier hs-var hs-var">bihcmap</span></a></span></span><span> </span><span id="local-6989586621680012878"><span class="annot"><span class="annottext">proxy c
</span><a href="#local-6989586621680012878"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621680012877"><span class="annot"><span class="annottext">forall (x :: k). c x =&gt; g x -&gt; g' x
</span><a href="#local-6989586621680012877"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621680012876"><span class="annot"><span class="annottext">forall (x :: k). c x =&gt; f x -&gt; f' x
</span><a href="#local-6989586621680012876"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NP (g -.-&gt; g') xs
-&gt; NP (f -.-&gt; f') xs -&gt; Telescope g f xs -&gt; Telescope g' f' xs
forall k (g :: k -&gt; *) (g' :: k -&gt; *) (xs :: [k]) (f :: k -&gt; *)
       (f' :: k -&gt; *).
NP (g -.-&gt; g') xs
-&gt; NP (f -.-&gt; f') xs -&gt; Telescope g f xs -&gt; Telescope g' f' xs
</span><a href="Data.SOP.Telescope.html#bihap"><span class="hs-identifier hs-var">bihap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">proxy c
-&gt; (forall (a :: k). c a =&gt; (-.-&gt;) g g' a) -&gt; NP (g -.-&gt; g') xs
forall k l (h :: (k -&gt; *) -&gt; l -&gt; *) (c :: k -&gt; Constraint)
       (xs :: l) (proxy :: (k -&gt; Constraint) -&gt; *) (f :: k -&gt; *).
(HPure h, AllN h c xs) =&gt;
proxy c -&gt; (forall (a :: k). c a =&gt; f a) -&gt; h f xs
</span><span class="hs-identifier hs-var">hcpure</span></span><span> </span><span class="annot"><span class="annottext">proxy c
</span><a href="#local-6989586621680012878"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(g a -&gt; g' a) -&gt; (-.-&gt;) g g' a
forall k (f :: k -&gt; *) (a :: k) (f' :: k -&gt; *).
(f a -&gt; f' a) -&gt; (-.-&gt;) f f' a
</span><span class="hs-identifier hs-var">fn</span></span><span> </span><span class="annot"><span class="annottext">g a -&gt; g' a
forall (x :: k). c x =&gt; g x -&gt; g' x
</span><a href="#local-6989586621680012877"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">proxy c
-&gt; (forall (a :: k). c a =&gt; (-.-&gt;) f f' a) -&gt; NP (f -.-&gt; f') xs
forall k l (h :: (k -&gt; *) -&gt; l -&gt; *) (c :: k -&gt; Constraint)
       (xs :: l) (proxy :: (k -&gt; Constraint) -&gt; *) (f :: k -&gt; *).
(HPure h, AllN h c xs) =&gt;
proxy c -&gt; (forall (a :: k). c a =&gt; f a) -&gt; h f xs
</span><span class="hs-identifier hs-var">hcpure</span></span><span> </span><span class="annot"><span class="annottext">proxy c
</span><a href="#local-6989586621680012878"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(f a -&gt; f' a) -&gt; (-.-&gt;) f f' a
forall k (f :: k -&gt; *) (a :: k) (f' :: k -&gt; *).
(f a -&gt; f' a) -&gt; (-.-&gt;) f f' a
</span><span class="hs-identifier hs-var">fn</span></span><span> </span><span class="annot"><span class="annottext">f a -&gt; f' a
forall (x :: k). c x =&gt; f x -&gt; f' x
</span><a href="#local-6989586621680012876"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-215"></span><span>
</span><span id="line-216"></span><span class="hs-comment">-- | Bifunctor equivalent of 'hzipWith'</span><span>
</span><span id="line-217"></span><span id="local-6989586621680012868"><span id="local-6989586621680012869"><span id="local-6989586621680012870"><span id="local-6989586621680012871"><span id="local-6989586621680012872"><span id="local-6989586621680012873"><span class="annot"><a href="Data.SOP.Telescope.html#bihzipWith"><span class="hs-identifier hs-type">bihzipWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SListI</span></span><span> </span><span class="annot"><a href="#local-6989586621680012873"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-218"></span><span>           </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680013456"><span class="annot"><a href="#local-6989586621680013456"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621680012872"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013456"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680012871"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013456"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680012870"><span class="hs-identifier hs-type">g'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013456"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-219"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680013453"><span class="annot"><a href="#local-6989586621680013453"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621680012872"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013453"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680012869"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013453"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680012868"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013453"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-220"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#NP"><span class="hs-identifier hs-type">NP</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012872"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012873"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012871"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012869"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012873"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012870"><span class="hs-identifier hs-type">g'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012868"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012873"><span class="hs-identifier hs-type">xs</span></a></span></span></span></span></span></span></span><span>
</span><span id="line-221"></span><span id="bihzipWith"><span class="annot"><span class="annottext">bihzipWith :: (forall (x :: k). h x -&gt; g x -&gt; g' x)
-&gt; (forall (x :: k). h x -&gt; f x -&gt; f' x)
-&gt; NP h xs
-&gt; Telescope g f xs
-&gt; Telescope g' f' xs
</span><a href="Data.SOP.Telescope.html#bihzipWith"><span class="hs-identifier hs-var hs-var">bihzipWith</span></a></span></span><span> </span><span id="local-6989586621680012867"><span class="annot"><span class="annottext">forall (x :: k). h x -&gt; g x -&gt; g' x
</span><a href="#local-6989586621680012867"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621680012866"><span class="annot"><span class="annottext">forall (x :: k). h x -&gt; f x -&gt; f' x
</span><a href="#local-6989586621680012866"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680012865"><span class="annot"><span class="annottext">NP h xs
</span><a href="#local-6989586621680012865"><span class="hs-identifier hs-var">ns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NP (g -.-&gt; g') xs
-&gt; NP (f -.-&gt; f') xs -&gt; Telescope g f xs -&gt; Telescope g' f' xs
forall k (g :: k -&gt; *) (g' :: k -&gt; *) (xs :: [k]) (f :: k -&gt; *)
       (f' :: k -&gt; *).
NP (g -.-&gt; g') xs
-&gt; NP (f -.-&gt; f') xs -&gt; Telescope g f xs -&gt; Telescope g' f' xs
</span><a href="Data.SOP.Telescope.html#bihap"><span class="hs-identifier hs-var">bihap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall (a :: k). h a -&gt; (-.-&gt;) g g' a)
-&gt; NP h xs -&gt; NP (g -.-&gt; g') xs
forall k l (h :: (k -&gt; *) -&gt; l -&gt; *) (xs :: l) (f :: k -&gt; *)
       (f' :: k -&gt; *).
(SListIN (Prod h) xs, HAp h) =&gt;
(forall (a :: k). f a -&gt; f' a) -&gt; h f xs -&gt; h f' xs
</span><span class="hs-identifier hs-var">hmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(g a -&gt; g' a) -&gt; (-.-&gt;) g g' a
forall k (f :: k -&gt; *) (a :: k) (f' :: k -&gt; *).
(f a -&gt; f' a) -&gt; (-.-&gt;) f f' a
</span><span class="hs-identifier hs-var">fn</span></span><span> </span><span class="annot"><span class="annottext">((g a -&gt; g' a) -&gt; (-.-&gt;) g g' a)
-&gt; (h a -&gt; g a -&gt; g' a) -&gt; h a -&gt; (-.-&gt;) g g' a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">h a -&gt; g a -&gt; g' a
forall (x :: k). h x -&gt; g x -&gt; g' x
</span><a href="#local-6989586621680012867"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NP h xs
</span><a href="#local-6989586621680012865"><span class="hs-identifier hs-var">ns</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall (a :: k). h a -&gt; (-.-&gt;) f f' a)
-&gt; NP h xs -&gt; NP (f -.-&gt; f') xs
forall k l (h :: (k -&gt; *) -&gt; l -&gt; *) (xs :: l) (f :: k -&gt; *)
       (f' :: k -&gt; *).
(SListIN (Prod h) xs, HAp h) =&gt;
(forall (a :: k). f a -&gt; f' a) -&gt; h f xs -&gt; h f' xs
</span><span class="hs-identifier hs-var">hmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(f a -&gt; f' a) -&gt; (-.-&gt;) f f' a
forall k (f :: k -&gt; *) (a :: k) (f' :: k -&gt; *).
(f a -&gt; f' a) -&gt; (-.-&gt;) f f' a
</span><span class="hs-identifier hs-var">fn</span></span><span> </span><span class="annot"><span class="annottext">((f a -&gt; f' a) -&gt; (-.-&gt;) f f' a)
-&gt; (h a -&gt; f a -&gt; f' a) -&gt; h a -&gt; (-.-&gt;) f f' a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">h a -&gt; f a -&gt; f' a
forall (x :: k). h x -&gt; f x -&gt; f' x
</span><a href="#local-6989586621680012866"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NP h xs
</span><a href="#local-6989586621680012865"><span class="hs-identifier hs-var">ns</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-222"></span><span>
</span><span id="line-223"></span><span class="hs-comment">-- | Bifunctor equivalent of 'hczipWith'</span><span>
</span><span id="line-224"></span><span id="local-6989586621680012856"><span id="local-6989586621680012857"><span id="local-6989586621680012858"><span id="local-6989586621680012859"><span id="local-6989586621680012860"><span id="local-6989586621680012861"><span id="local-6989586621680012862"><span id="local-6989586621680012863"><span class="annot"><a href="Data.SOP.Telescope.html#bihczipWith"><span class="hs-identifier hs-type">bihczipWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">All</span></span><span> </span><span class="annot"><a href="#local-6989586621680012863"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012862"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-225"></span><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680012861"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012863"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-226"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680013437"><span class="annot"><a href="#local-6989586621680013437"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621680012863"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013437"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680012860"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013437"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680012859"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013437"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680012858"><span class="hs-identifier hs-type">g'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013437"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-227"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680013433"><span class="annot"><a href="#local-6989586621680013433"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621680012863"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013433"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680012860"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013433"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680012857"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013433"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680012856"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013433"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-228"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#NP"><span class="hs-identifier hs-type">NP</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012860"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012862"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012859"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012857"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012862"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012858"><span class="hs-identifier hs-type">g'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012856"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012862"><span class="hs-identifier hs-type">xs</span></a></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-229"></span><span id="bihczipWith"><span class="annot"><span class="annottext">bihczipWith :: proxy c
-&gt; (forall (x :: k). c x =&gt; h x -&gt; g x -&gt; g' x)
-&gt; (forall (x :: k). c x =&gt; h x -&gt; f x -&gt; f' x)
-&gt; NP h xs
-&gt; Telescope g f xs
-&gt; Telescope g' f' xs
</span><a href="Data.SOP.Telescope.html#bihczipWith"><span class="hs-identifier hs-var hs-var">bihczipWith</span></a></span></span><span> </span><span id="local-6989586621680012855"><span class="annot"><span class="annottext">proxy c
</span><a href="#local-6989586621680012855"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621680012854"><span class="annot"><span class="annottext">forall (x :: k). c x =&gt; h x -&gt; g x -&gt; g' x
</span><a href="#local-6989586621680012854"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621680012853"><span class="annot"><span class="annottext">forall (x :: k). c x =&gt; h x -&gt; f x -&gt; f' x
</span><a href="#local-6989586621680012853"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680012852"><span class="annot"><span class="annottext">NP h xs
</span><a href="#local-6989586621680012852"><span class="hs-identifier hs-var">ns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NP (g -.-&gt; g') xs
-&gt; NP (f -.-&gt; f') xs -&gt; Telescope g f xs -&gt; Telescope g' f' xs
forall k (g :: k -&gt; *) (g' :: k -&gt; *) (xs :: [k]) (f :: k -&gt; *)
       (f' :: k -&gt; *).
NP (g -.-&gt; g') xs
-&gt; NP (f -.-&gt; f') xs -&gt; Telescope g f xs -&gt; Telescope g' f' xs
</span><a href="Data.SOP.Telescope.html#bihap"><span class="hs-identifier hs-var">bihap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">proxy c
-&gt; (forall (a :: k). c a =&gt; h a -&gt; (-.-&gt;) g g' a)
-&gt; NP h xs
-&gt; NP (g -.-&gt; g') xs
forall k l (h :: (k -&gt; *) -&gt; l -&gt; *) (c :: k -&gt; Constraint)
       (xs :: l) (proxy :: (k -&gt; Constraint) -&gt; *) (f :: k -&gt; *)
       (f' :: k -&gt; *).
(AllN (Prod h) c xs, HAp h) =&gt;
proxy c
-&gt; (forall (a :: k). c a =&gt; f a -&gt; f' a) -&gt; h f xs -&gt; h f' xs
</span><span class="hs-identifier hs-var">hcmap</span></span><span> </span><span class="annot"><span class="annottext">proxy c
</span><a href="#local-6989586621680012855"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(g a -&gt; g' a) -&gt; (-.-&gt;) g g' a
forall k (f :: k -&gt; *) (a :: k) (f' :: k -&gt; *).
(f a -&gt; f' a) -&gt; (-.-&gt;) f f' a
</span><span class="hs-identifier hs-var">fn</span></span><span> </span><span class="annot"><span class="annottext">((g a -&gt; g' a) -&gt; (-.-&gt;) g g' a)
-&gt; (h a -&gt; g a -&gt; g' a) -&gt; h a -&gt; (-.-&gt;) g g' a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">h a -&gt; g a -&gt; g' a
forall (x :: k). c x =&gt; h x -&gt; g x -&gt; g' x
</span><a href="#local-6989586621680012854"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NP h xs
</span><a href="#local-6989586621680012852"><span class="hs-identifier hs-var">ns</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">proxy c
-&gt; (forall (a :: k). c a =&gt; h a -&gt; (-.-&gt;) f f' a)
-&gt; NP h xs
-&gt; NP (f -.-&gt; f') xs
forall k l (h :: (k -&gt; *) -&gt; l -&gt; *) (c :: k -&gt; Constraint)
       (xs :: l) (proxy :: (k -&gt; Constraint) -&gt; *) (f :: k -&gt; *)
       (f' :: k -&gt; *).
(AllN (Prod h) c xs, HAp h) =&gt;
proxy c
-&gt; (forall (a :: k). c a =&gt; f a -&gt; f' a) -&gt; h f xs -&gt; h f' xs
</span><span class="hs-identifier hs-var">hcmap</span></span><span> </span><span class="annot"><span class="annottext">proxy c
</span><a href="#local-6989586621680012855"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(f a -&gt; f' a) -&gt; (-.-&gt;) f f' a
forall k (f :: k -&gt; *) (a :: k) (f' :: k -&gt; *).
(f a -&gt; f' a) -&gt; (-.-&gt;) f f' a
</span><span class="hs-identifier hs-var">fn</span></span><span> </span><span class="annot"><span class="annottext">((f a -&gt; f' a) -&gt; (-.-&gt;) f f' a)
-&gt; (h a -&gt; f a -&gt; f' a) -&gt; h a -&gt; (-.-&gt;) f f' a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">h a -&gt; f a -&gt; f' a
forall (x :: k). c x =&gt; h x -&gt; f x -&gt; f' x
</span><a href="#local-6989586621680012853"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NP h xs
</span><a href="#local-6989586621680012852"><span class="hs-identifier hs-var">ns</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-230"></span><span>
</span><span id="line-231"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Simple telescope

  This is an internal type that is useful primarily useful as a sanity check
  of our bifunctor generalizations.
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span class="hs-comment">-- | 'Telescope' with both functors set to the same @f@</span><span>
</span><span id="line-239"></span><span class="hs-keyword">newtype</span><span> </span><span id="SimpleTelescope"><span class="annot"><a href="Data.SOP.Telescope.html#SimpleTelescope"><span class="hs-identifier hs-var">SimpleTelescope</span></a></span></span><span> </span><span id="local-6989586621680013409"><span class="annot"><a href="#local-6989586621680013409"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621680013408"><span class="annot"><a href="#local-6989586621680013408"><span class="hs-identifier hs-type">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="SimpleTelescope"><span class="annot"><a href="Data.SOP.Telescope.html#SimpleTelescope"><span class="hs-identifier hs-var">SimpleTelescope</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-240"></span><span>      </span><span id="getSimpleTelescope"><span class="annot"><span class="annottext">SimpleTelescope f xs -&gt; Telescope f f xs
</span><a href="Data.SOP.Telescope.html#getSimpleTelescope"><span class="hs-identifier hs-var hs-var">getSimpleTelescope</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013409"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013409"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013408"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-241"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-242"></span><span>
</span><span id="line-243"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="Prod"><span class="annot"><span class="hs-identifier hs-var">Prod</span></span></span><span>       </span><span class="annot"><a href="Data.SOP.Telescope.html#SimpleTelescope"><span class="hs-identifier hs-type">SimpleTelescope</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#NP"><span class="hs-identifier hs-type">NP</span></a></span><span>
</span><span id="line-244"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="SListIN"><span class="annot"><span class="hs-identifier hs-var">SListIN</span></span></span><span>    </span><span class="annot"><a href="Data.SOP.Telescope.html#SimpleTelescope"><span class="hs-identifier hs-type">SimpleTelescope</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SListI</span></span><span>
</span><span id="line-245"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="AllN"><span class="annot"><span class="hs-identifier hs-var">AllN</span></span></span><span>       </span><span class="annot"><a href="Data.SOP.Telescope.html#SimpleTelescope"><span class="hs-identifier hs-type">SimpleTelescope</span></a></span><span> </span><span id="local-6989586621680012848"><span class="annot"><a href="#local-6989586621680012848"><span class="hs-identifier hs-type hs-type">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">All</span></span><span> </span><span class="annot"><a href="#local-6989586621680012848"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-246"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="CollapseTo"><span class="annot"><span class="hs-identifier hs-var">CollapseTo</span></span></span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#SimpleTelescope"><span class="hs-identifier hs-type">SimpleTelescope</span></a></span><span> </span><span id="local-6989586621680012847"><span class="annot"><a href="#local-6989586621680012847"><span class="hs-identifier hs-type hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621680012847"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-247"></span><span>
</span><span id="line-248"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HAp</span></span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#SimpleTelescope"><span class="hs-identifier hs-type">SimpleTelescope</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-249"></span><span>  </span><span id="local-6989586621680012843"><span class="annot"><span class="annottext">hap :: Prod SimpleTelescope (f -.-&gt; g) xs
-&gt; SimpleTelescope f xs -&gt; SimpleTelescope g xs
</span><a href="#local-6989586621680012843"><span class="hs-identifier hs-var hs-var hs-var hs-var">hap</span></a></span></span><span> </span><span id="local-6989586621680012842"><span class="annot"><span class="annottext">Prod SimpleTelescope (f -.-&gt; g) xs
</span><a href="#local-6989586621680012842"><span class="hs-identifier hs-var">fs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Telescope g g xs -&gt; SimpleTelescope g xs
forall k (f :: k -&gt; *) (xs :: [k]).
Telescope f f xs -&gt; SimpleTelescope f xs
</span><a href="Data.SOP.Telescope.html#SimpleTelescope"><span class="hs-identifier hs-var">SimpleTelescope</span></a></span><span> </span><span class="annot"><span class="annottext">(Telescope g g xs -&gt; SimpleTelescope g xs)
-&gt; (SimpleTelescope f xs -&gt; Telescope g g xs)
-&gt; SimpleTelescope f xs
-&gt; SimpleTelescope g xs
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">NP (f -.-&gt; g) xs
-&gt; NP (f -.-&gt; g) xs -&gt; Telescope f f xs -&gt; Telescope g g xs
forall k (g :: k -&gt; *) (g' :: k -&gt; *) (xs :: [k]) (f :: k -&gt; *)
       (f' :: k -&gt; *).
NP (g -.-&gt; g') xs
-&gt; NP (f -.-&gt; f') xs -&gt; Telescope g f xs -&gt; Telescope g' f' xs
</span><a href="Data.SOP.Telescope.html#bihap"><span class="hs-identifier hs-var">bihap</span></a></span><span> </span><span class="annot"><span class="annottext">Prod SimpleTelescope (f -.-&gt; g) xs
NP (f -.-&gt; g) xs
</span><a href="#local-6989586621680012842"><span class="hs-identifier hs-var">fs</span></a></span><span> </span><span class="annot"><span class="annottext">Prod SimpleTelescope (f -.-&gt; g) xs
NP (f -.-&gt; g) xs
</span><a href="#local-6989586621680012842"><span class="hs-identifier hs-var">fs</span></a></span><span> </span><span class="annot"><span class="annottext">(Telescope f f xs -&gt; Telescope g g xs)
-&gt; (SimpleTelescope f xs -&gt; Telescope f f xs)
-&gt; SimpleTelescope f xs
-&gt; Telescope g g xs
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">SimpleTelescope f xs -&gt; Telescope f f xs
forall k (f :: k -&gt; *) (xs :: [k]).
SimpleTelescope f xs -&gt; Telescope f f xs
</span><a href="Data.SOP.Telescope.html#getSimpleTelescope"><span class="hs-identifier hs-var hs-var">getSimpleTelescope</span></a></span><span>
</span><span id="line-250"></span><span>
</span><span id="line-251"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HTraverse_</span></span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#SimpleTelescope"><span class="hs-identifier hs-type">SimpleTelescope</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-252"></span><span>  </span><span id="local-6989586621680012839"><span class="annot"><span class="annottext">hctraverse_ :: proxy c
-&gt; (forall (a :: k). c a =&gt; f a -&gt; g ())
-&gt; SimpleTelescope f xs
-&gt; g ()
</span><a href="#local-6989586621680012839"><span class="hs-identifier hs-var hs-var hs-var hs-var">hctraverse_</span></a></span></span><span> </span><span id="local-6989586621680012838"><span class="annot"><span class="annottext">proxy c
</span><a href="#local-6989586621680012838"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621680012837"><span class="annot"><span class="annottext">forall (a :: k). c a =&gt; f a -&gt; g ()
</span><a href="#local-6989586621680012837"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">proxy c
-&gt; (forall (a :: k). c a =&gt; f a -&gt; g ())
-&gt; (forall (a :: k). c a =&gt; f a -&gt; g ())
-&gt; Telescope f f xs
-&gt; g ()
forall k (proxy :: (k -&gt; Constraint) -&gt; *) (c :: k -&gt; Constraint)
       (xs :: [k]) (m :: * -&gt; *) (g :: k -&gt; *) (f :: k -&gt; *).
(All c xs, Applicative m) =&gt;
proxy c
-&gt; (forall (x :: k). c x =&gt; g x -&gt; m ())
-&gt; (forall (x :: k). c x =&gt; f x -&gt; m ())
-&gt; Telescope g f xs
-&gt; m ()
</span><a href="Data.SOP.Telescope.html#bihctraverse_"><span class="hs-identifier hs-var">bihctraverse_</span></a></span><span> </span><span class="annot"><span class="annottext">proxy c
</span><a href="#local-6989586621680012838"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall (a :: k). c a =&gt; f a -&gt; g ()
</span><a href="#local-6989586621680012837"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">forall (a :: k). c a =&gt; f a -&gt; g ()
</span><a href="#local-6989586621680012837"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Telescope f f xs -&gt; g ())
-&gt; (SimpleTelescope f xs -&gt; Telescope f f xs)
-&gt; SimpleTelescope f xs
-&gt; g ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">SimpleTelescope f xs -&gt; Telescope f f xs
forall k (f :: k -&gt; *) (xs :: [k]).
SimpleTelescope f xs -&gt; Telescope f f xs
</span><a href="Data.SOP.Telescope.html#getSimpleTelescope"><span class="hs-identifier hs-var hs-var">getSimpleTelescope</span></a></span><span>
</span><span id="line-253"></span><span>  </span><span id="local-6989586621680012836"><span class="annot"><span class="annottext">htraverse_ :: (forall (a :: k). f a -&gt; g ()) -&gt; SimpleTelescope f xs -&gt; g ()
</span><a href="#local-6989586621680012836"><span class="hs-identifier hs-var hs-var hs-var hs-var">htraverse_</span></a></span></span><span>    </span><span id="local-6989586621680012835"><span class="annot"><span class="annottext">forall (a :: k). f a -&gt; g ()
</span><a href="#local-6989586621680012835"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall (a :: k). f a -&gt; g ())
-&gt; (forall (a :: k). f a -&gt; g ()) -&gt; Telescope f f xs -&gt; g ()
forall k (xs :: [k]) (m :: * -&gt; *) (g :: k -&gt; *) (f :: k -&gt; *).
(SListI xs, Applicative m) =&gt;
(forall (x :: k). g x -&gt; m ())
-&gt; (forall (x :: k). f x -&gt; m ()) -&gt; Telescope g f xs -&gt; m ()
</span><a href="Data.SOP.Telescope.html#bihtraverse_"><span class="hs-identifier hs-var">bihtraverse_</span></a></span><span>    </span><span class="annot"><span class="annottext">forall (a :: k). f a -&gt; g ()
</span><a href="#local-6989586621680012835"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">forall (a :: k). f a -&gt; g ()
</span><a href="#local-6989586621680012835"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Telescope f f xs -&gt; g ())
-&gt; (SimpleTelescope f xs -&gt; Telescope f f xs)
-&gt; SimpleTelescope f xs
-&gt; g ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">SimpleTelescope f xs -&gt; Telescope f f xs
forall k (f :: k -&gt; *) (xs :: [k]).
SimpleTelescope f xs -&gt; Telescope f f xs
</span><a href="Data.SOP.Telescope.html#getSimpleTelescope"><span class="hs-identifier hs-var hs-var">getSimpleTelescope</span></a></span><span>
</span><span id="line-254"></span><span>
</span><span id="line-255"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HSequence</span></span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#SimpleTelescope"><span class="hs-identifier hs-type">SimpleTelescope</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-256"></span><span>  </span><span id="local-6989586621680012830"><span class="annot"><span class="annottext">hsequence' :: SimpleTelescope (f :.: g) xs -&gt; f (SimpleTelescope g xs)
</span><a href="#local-6989586621680012830"><span class="hs-identifier hs-var hs-var hs-var hs-var">hsequence'</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Telescope g g xs -&gt; SimpleTelescope g xs)
-&gt; f (Telescope g g xs) -&gt; f (SimpleTelescope g xs)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope g g xs -&gt; SimpleTelescope g xs
forall k (f :: k -&gt; *) (xs :: [k]).
Telescope f f xs -&gt; SimpleTelescope f xs
</span><a href="Data.SOP.Telescope.html#SimpleTelescope"><span class="hs-identifier hs-var">SimpleTelescope</span></a></span><span> </span><span class="annot"><span class="annottext">(f (Telescope g g xs) -&gt; f (SimpleTelescope g xs))
-&gt; (SimpleTelescope (f :.: g) xs -&gt; f (Telescope g g xs))
-&gt; SimpleTelescope (f :.: g) xs
-&gt; f (SimpleTelescope g xs)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope (f :.: g) (f :.: g) xs -&gt; f (Telescope g g xs)
forall k (m :: * -&gt; *) (g :: k -&gt; *) (f :: k -&gt; *) (xs :: [k]).
(SListI xs, Applicative m) =&gt;
Telescope (m :.: g) (m :.: f) xs -&gt; m (Telescope g f xs)
</span><a href="Data.SOP.Telescope.html#bihsequence%27"><span class="hs-identifier hs-var">bihsequence'</span></a></span><span>        </span><span class="annot"><span class="annottext">(Telescope (f :.: g) (f :.: g) xs -&gt; f (Telescope g g xs))
-&gt; (SimpleTelescope (f :.: g) xs
    -&gt; Telescope (f :.: g) (f :.: g) xs)
-&gt; SimpleTelescope (f :.: g) xs
-&gt; f (Telescope g g xs)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">SimpleTelescope (f :.: g) xs -&gt; Telescope (f :.: g) (f :.: g) xs
forall k (f :: k -&gt; *) (xs :: [k]).
SimpleTelescope f xs -&gt; Telescope f f xs
</span><a href="Data.SOP.Telescope.html#getSimpleTelescope"><span class="hs-identifier hs-var hs-var">getSimpleTelescope</span></a></span><span>
</span><span id="line-257"></span><span>  </span><span id="local-6989586621680012829"><span class="annot"><span class="annottext">hctraverse' :: proxy c
-&gt; (forall (a :: k). c a =&gt; f a -&gt; g (f' a))
-&gt; SimpleTelescope f xs
-&gt; g (SimpleTelescope f' xs)
</span><a href="#local-6989586621680012829"><span class="hs-identifier hs-var hs-var hs-var hs-var">hctraverse'</span></a></span></span><span> </span><span id="local-6989586621680012828"><span class="annot"><span class="annottext">proxy c
</span><a href="#local-6989586621680012828"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621680012827"><span class="annot"><span class="annottext">forall (a :: k). c a =&gt; f a -&gt; g (f' a)
</span><a href="#local-6989586621680012827"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Telescope f' f' xs -&gt; SimpleTelescope f' xs)
-&gt; g (Telescope f' f' xs) -&gt; g (SimpleTelescope f' xs)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope f' f' xs -&gt; SimpleTelescope f' xs
forall k (f :: k -&gt; *) (xs :: [k]).
Telescope f f xs -&gt; SimpleTelescope f xs
</span><a href="Data.SOP.Telescope.html#SimpleTelescope"><span class="hs-identifier hs-var">SimpleTelescope</span></a></span><span> </span><span class="annot"><span class="annottext">(g (Telescope f' f' xs) -&gt; g (SimpleTelescope f' xs))
-&gt; (SimpleTelescope f xs -&gt; g (Telescope f' f' xs))
-&gt; SimpleTelescope f xs
-&gt; g (SimpleTelescope f' xs)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">proxy c
-&gt; (forall (a :: k). c a =&gt; f a -&gt; g (f' a))
-&gt; (forall (a :: k). c a =&gt; f a -&gt; g (f' a))
-&gt; Telescope f f xs
-&gt; g (Telescope f' f' xs)
forall k (proxy :: (k -&gt; Constraint) -&gt; *) (c :: k -&gt; Constraint)
       (m :: * -&gt; *) (g :: k -&gt; *) (g' :: k -&gt; *) (f :: k -&gt; *)
       (f' :: k -&gt; *) (xs :: [k]).
(All c xs, Applicative m) =&gt;
proxy c
-&gt; (forall (x :: k). c x =&gt; g x -&gt; m (g' x))
-&gt; (forall (x :: k). c x =&gt; f x -&gt; m (f' x))
-&gt; Telescope g f xs
-&gt; m (Telescope g' f' xs)
</span><a href="Data.SOP.Telescope.html#bihctraverse%27"><span class="hs-identifier hs-var">bihctraverse'</span></a></span><span> </span><span class="annot"><span class="annottext">proxy c
</span><a href="#local-6989586621680012828"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall (a :: k). c a =&gt; f a -&gt; g (f' a)
</span><a href="#local-6989586621680012827"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">forall (a :: k). c a =&gt; f a -&gt; g (f' a)
</span><a href="#local-6989586621680012827"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Telescope f f xs -&gt; g (Telescope f' f' xs))
-&gt; (SimpleTelescope f xs -&gt; Telescope f f xs)
-&gt; SimpleTelescope f xs
-&gt; g (Telescope f' f' xs)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">SimpleTelescope f xs -&gt; Telescope f f xs
forall k (f :: k -&gt; *) (xs :: [k]).
SimpleTelescope f xs -&gt; Telescope f f xs
</span><a href="Data.SOP.Telescope.html#getSimpleTelescope"><span class="hs-identifier hs-var hs-var">getSimpleTelescope</span></a></span><span>
</span><span id="line-258"></span><span>  </span><span id="local-6989586621680012826"><span class="annot"><span class="annottext">htraverse' :: (forall (a :: k). f a -&gt; g (f' a))
-&gt; SimpleTelescope f xs -&gt; g (SimpleTelescope f' xs)
</span><a href="#local-6989586621680012826"><span class="hs-identifier hs-var hs-var hs-var hs-var">htraverse'</span></a></span></span><span>    </span><span id="local-6989586621680012825"><span class="annot"><span class="annottext">forall (a :: k). f a -&gt; g (f' a)
</span><a href="#local-6989586621680012825"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Telescope f' f' xs -&gt; SimpleTelescope f' xs)
-&gt; g (Telescope f' f' xs) -&gt; g (SimpleTelescope f' xs)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope f' f' xs -&gt; SimpleTelescope f' xs
forall k (f :: k -&gt; *) (xs :: [k]).
Telescope f f xs -&gt; SimpleTelescope f xs
</span><a href="Data.SOP.Telescope.html#SimpleTelescope"><span class="hs-identifier hs-var">SimpleTelescope</span></a></span><span> </span><span class="annot"><span class="annottext">(g (Telescope f' f' xs) -&gt; g (SimpleTelescope f' xs))
-&gt; (SimpleTelescope f xs -&gt; g (Telescope f' f' xs))
-&gt; SimpleTelescope f xs
-&gt; g (SimpleTelescope f' xs)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(forall (a :: k). f a -&gt; g (f' a))
-&gt; (forall (a :: k). f a -&gt; g (f' a))
-&gt; Telescope f f xs
-&gt; g (Telescope f' f' xs)
forall k (xs :: [k]) (m :: * -&gt; *) (g :: k -&gt; *) (g' :: k -&gt; *)
       (f :: k -&gt; *) (f' :: k -&gt; *).
(SListI xs, Applicative m) =&gt;
(forall (x :: k). g x -&gt; m (g' x))
-&gt; (forall (x :: k). f x -&gt; m (f' x))
-&gt; Telescope g f xs
-&gt; m (Telescope g' f' xs)
</span><a href="Data.SOP.Telescope.html#bihtraverse%27"><span class="hs-identifier hs-var">bihtraverse'</span></a></span><span>    </span><span class="annot"><span class="annottext">forall (a :: k). f a -&gt; g (f' a)
</span><a href="#local-6989586621680012825"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">forall (a :: k). f a -&gt; g (f' a)
</span><a href="#local-6989586621680012825"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Telescope f f xs -&gt; g (Telescope f' f' xs))
-&gt; (SimpleTelescope f xs -&gt; Telescope f f xs)
-&gt; SimpleTelescope f xs
-&gt; g (Telescope f' f' xs)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">SimpleTelescope f xs -&gt; Telescope f f xs
forall k (f :: k -&gt; *) (xs :: [k]).
SimpleTelescope f xs -&gt; Telescope f f xs
</span><a href="Data.SOP.Telescope.html#getSimpleTelescope"><span class="hs-identifier hs-var hs-var">getSimpleTelescope</span></a></span><span>
</span><span id="line-259"></span><span>
</span><span id="line-260"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HCollapse</span></span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#SimpleTelescope"><span class="hs-identifier hs-type">SimpleTelescope</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-261"></span><span>  </span><span id="local-6989586621680012822"><span class="annot"><span class="annottext">hcollapse :: SimpleTelescope (K a) xs -&gt; CollapseTo SimpleTelescope a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">hcollapse</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#SimpleTelescope"><span class="hs-identifier hs-type">SimpleTelescope</span></a></span><span> </span><span id="local-6989586621680012820"><span class="annot"><span class="annottext">Telescope (K a) (K a) xs
</span><a href="#local-6989586621680012820"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Telescope (K a) (K a) xs -&gt; [a]
forall k a (xs :: [k]). Telescope (K a) (K a) xs -&gt; [a]
</span><a href="#local-6989586621680012819"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope (K a) (K a) xs
</span><a href="#local-6989586621680012820"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-262"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-263"></span><span>      </span><span id="local-6989586621680013368"><span id="local-6989586621680013369"><span class="annot"><a href="#local-6989586621680012819"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">K</span></span><span> </span><span class="annot"><a href="#local-6989586621680013369"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">K</span></span><span> </span><span class="annot"><a href="#local-6989586621680013369"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680013368"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621680013369"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-264"></span><span>      </span><span id="local-6989586621680012819"><span class="annot"><span class="annottext">go :: Telescope (K a) (K a) xs -&gt; [a]
</span><a href="#local-6989586621680012819"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#TZ"><span class="hs-identifier hs-type">TZ</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">K</span></span><span> </span><span id="local-6989586621680012817"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680012817"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680012817"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-265"></span><span>      </span><span class="annot"><a href="#local-6989586621680012819"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#TS"><span class="hs-identifier hs-type">TS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">K</span></span><span> </span><span id="local-6989586621680012816"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680012816"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680012815"><span class="annot"><span class="annottext">Telescope (K a) (K a) xs
</span><a href="#local-6989586621680012815"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680012816"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope (K a) (K a) xs -&gt; [a]
forall k a (xs :: [k]). Telescope (K a) (K a) xs -&gt; [a]
</span><a href="#local-6989586621680012819"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope (K a) (K a) xs
</span><a href="#local-6989586621680012815"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-266"></span><span>
</span><span id="line-267"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Utilities
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-270"></span><span>
</span><span id="line-271"></span><span id="local-6989586621680013340"><span id="local-6989586621680013341"><span id="local-6989586621680013342"><span class="annot"><a href="Data.SOP.Telescope.html#tip"><span class="hs-identifier hs-type">tip</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013342"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013341"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013340"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#NS"><span class="hs-identifier hs-type">NS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013341"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013340"><span class="hs-identifier hs-type">xs</span></a></span></span></span></span><span>
</span><span id="line-272"></span><span id="tip"><span class="annot"><span class="annottext">tip :: Telescope g f xs -&gt; NS f xs
</span><a href="Data.SOP.Telescope.html#tip"><span class="hs-identifier hs-var hs-var">tip</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#TZ"><span class="hs-identifier hs-type">TZ</span></a></span><span>   </span><span id="local-6989586621680012814"><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621680012814"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f x -&gt; NS f (x : xs)
forall a (f :: a -&gt; *) (x :: a) (xs :: [a]). f x -&gt; NS f (x : xs)
</span><a href="Data.SOP.Strict.html#Z"><span class="hs-identifier hs-var">Z</span></a></span><span> </span><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621680012814"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-273"></span><span class="annot"><a href="Data.SOP.Telescope.html#tip"><span class="hs-identifier hs-var">tip</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#TS"><span class="hs-identifier hs-type">TS</span></a></span><span> </span><span class="annot"><span class="annottext">g x
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680012812"><span class="annot"><span class="annottext">Telescope g f xs
</span><a href="#local-6989586621680012812"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NS f xs -&gt; NS f (x : xs)
forall a (f :: a -&gt; *) (xs :: [a]) (x :: a).
NS f xs -&gt; NS f (x : xs)
</span><a href="Data.SOP.Strict.html#S"><span class="hs-identifier hs-var">S</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Telescope g f xs -&gt; NS f xs
forall k (g :: k -&gt; *) (f :: k -&gt; *) (xs :: [k]).
Telescope g f xs -&gt; NS f xs
</span><a href="Data.SOP.Telescope.html#tip"><span class="hs-identifier hs-var">tip</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope g f xs
</span><a href="#local-6989586621680012812"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-274"></span><span>
</span><span id="line-275"></span><span id="local-6989586621680013327"><span id="local-6989586621680013328"><span class="annot"><a href="Data.SOP.Telescope.html#fromTip"><span class="hs-identifier hs-type">fromTip</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#NS"><span class="hs-identifier hs-type">NS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013328"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013327"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">K</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680013328"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013327"><span class="hs-identifier hs-type">xs</span></a></span></span></span><span>
</span><span id="line-276"></span><span id="fromTip"><span class="annot"><span class="annottext">fromTip :: NS f xs -&gt; Telescope (K ()) f xs
</span><a href="Data.SOP.Telescope.html#fromTip"><span class="hs-identifier hs-var hs-var">fromTip</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Strict.html#Z"><span class="hs-identifier hs-type">Z</span></a></span><span> </span><span id="local-6989586621680012810"><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621680012810"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f x -&gt; Telescope (K ()) f (x : xs)
forall a (f :: a -&gt; *) (x :: a) (g :: a -&gt; *) (xs :: [a]).
f x -&gt; Telescope g f (x : xs)
</span><a href="Data.SOP.Telescope.html#TZ"><span class="hs-identifier hs-var">TZ</span></a></span><span> </span><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621680012810"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-277"></span><span class="annot"><a href="Data.SOP.Telescope.html#fromTip"><span class="hs-identifier hs-var">fromTip</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Strict.html#S"><span class="hs-identifier hs-type">S</span></a></span><span> </span><span id="local-6989586621680012809"><span class="annot"><span class="annottext">NS f xs
</span><a href="#local-6989586621680012809"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">K () x -&gt; Telescope (K ()) f xs -&gt; Telescope (K ()) f (x : xs)
forall a (g :: a -&gt; *) (x :: a) (f :: a -&gt; *) (xs :: [a]).
g x -&gt; Telescope g f xs -&gt; Telescope g f (x : xs)
</span><a href="Data.SOP.Telescope.html#TS"><span class="hs-identifier hs-var">TS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; K () x
forall k a (b :: k). a -&gt; K a b
</span><span class="hs-identifier hs-var">K</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NS f xs -&gt; Telescope (K ()) f xs
forall k (f :: k -&gt; *) (xs :: [k]).
NS f xs -&gt; Telescope (K ()) f xs
</span><a href="Data.SOP.Telescope.html#fromTip"><span class="hs-identifier hs-var">fromTip</span></a></span><span> </span><span class="annot"><span class="annottext">NS f xs
</span><a href="#local-6989586621680012809"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-278"></span><span>
</span><span id="line-279"></span><span id="local-6989586621680012807"><span id="local-6989586621680012808"><span class="annot"><a href="Data.SOP.Telescope.html#toAtMost"><span class="hs-identifier hs-type">toAtMost</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">K</span></span><span> </span><span class="annot"><a href="#local-6989586621680012808"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">K</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012808"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680012807"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Counting.html#AtMost"><span class="hs-identifier hs-type">AtMost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012807"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012808"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-280"></span><span id="toAtMost"><span class="annot"><span class="annottext">toAtMost :: Telescope (K a) (K (Maybe a)) xs -&gt; AtMost xs a
</span><a href="Data.SOP.Telescope.html#toAtMost"><span class="hs-identifier hs-var hs-var">toAtMost</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Telescope (K a) (K (Maybe a)) xs -&gt; AtMost xs a
forall a (xs :: [*]).
Telescope (K a) (K (Maybe a)) xs -&gt; AtMost xs a
</span><a href="#local-6989586621680012806"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-281"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-282"></span><span>    </span><span id="local-6989586621680013322"><span id="local-6989586621680013323"><span class="annot"><a href="#local-6989586621680012806"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">K</span></span><span> </span><span class="annot"><a href="#local-6989586621680013323"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">K</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013323"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680013322"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Counting.html#AtMost"><span class="hs-identifier hs-type">AtMost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013322"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013323"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-283"></span><span>    </span><span id="local-6989586621680012806"><span class="annot"><span class="annottext">go :: Telescope (K a) (K (Maybe a)) xs -&gt; AtMost xs a
</span><a href="#local-6989586621680012806"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#TZ"><span class="hs-identifier hs-type">TZ</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">K</span></span><span> </span><span id="local-6989586621680012805"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621680012805"><span class="hs-identifier hs-var">ma</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AtMost (x : xs) a
-&gt; (a -&gt; AtMost (x : xs) a) -&gt; Maybe a -&gt; AtMost (x : xs) a
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">AtMost (x : xs) a
forall (xs :: [*]) a. AtMost xs a
</span><a href="Data.SOP.Counting.html#AtMostNil"><span class="hs-identifier hs-var">AtMostNil</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; AtMost (x : xs) a
forall a x (xs :: [*]). a -&gt; AtMost (x : xs) a
</span><a href="Data.SOP.Counting.html#atMostOne"><span class="hs-identifier hs-var">atMostOne</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621680012805"><span class="hs-identifier hs-var">ma</span></a></span><span>
</span><span id="line-284"></span><span>    </span><span class="annot"><a href="#local-6989586621680012806"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#TS"><span class="hs-identifier hs-type">TS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">K</span></span><span> </span><span id="local-6989586621680012801"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680012801"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680012800"><span class="annot"><span class="annottext">Telescope (K a) (K (Maybe a)) xs
</span><a href="#local-6989586621680012800"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; AtMost xs a -&gt; AtMost (x : xs) a
forall a (xs :: [*]) x. a -&gt; AtMost xs a -&gt; AtMost (x : xs) a
</span><a href="Data.SOP.Counting.html#AtMostCons"><span class="hs-identifier hs-var">AtMostCons</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680012801"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Telescope (K a) (K (Maybe a)) xs -&gt; AtMost xs a
forall a (xs :: [*]).
Telescope (K a) (K (Maybe a)) xs -&gt; AtMost xs a
</span><a href="#local-6989586621680012806"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope (K a) (K (Maybe a)) xs
</span><a href="#local-6989586621680012800"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-285"></span><span>
</span><span id="line-286"></span><span id="local-6989586621680012796"><span id="local-6989586621680012797"><span id="local-6989586621680012798"><span class="annot"><a href="Data.SOP.Telescope.html#fromTZ"><span class="hs-identifier hs-type">fromTZ</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012798"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012797"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621680012796"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680012797"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012796"><span class="hs-identifier hs-type">x</span></a></span></span></span></span><span>
</span><span id="line-287"></span><span id="fromTZ"><span class="annot"><span class="annottext">fromTZ :: Telescope g f '[x] -&gt; f x
</span><a href="Data.SOP.Telescope.html#fromTZ"><span class="hs-identifier hs-var hs-var">fromTZ</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#TZ"><span class="hs-identifier hs-type">TZ</span></a></span><span> </span><span id="local-6989586621680012795"><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621680012795"><span class="hs-identifier hs-var">fx</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f x
f x
</span><a href="#local-6989586621680012795"><span class="hs-identifier hs-var">fx</span></a></span><span>
</span><span id="line-288"></span><span>
</span><span id="line-289"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Extension and retraction
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-292"></span><span>
</span><span id="line-293"></span><span class="hs-keyword">newtype</span><span> </span><span id="Extend"><span class="annot"><a href="Data.SOP.Telescope.html#Extend"><span class="hs-identifier hs-var">Extend</span></a></span></span><span> </span><span id="local-6989586621680013270"><span class="annot"><a href="#local-6989586621680013270"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621680013269"><span class="annot"><a href="#local-6989586621680013269"><span class="hs-identifier hs-type">g</span></a></span></span><span> </span><span id="local-6989586621680013268"><span class="annot"><a href="#local-6989586621680013268"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621680013267"><span class="annot"><a href="#local-6989586621680013267"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span id="local-6989586621680013266"><span class="annot"><a href="#local-6989586621680013266"><span class="hs-identifier hs-type">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Extend"><span class="annot"><a href="Data.SOP.Telescope.html#Extend"><span class="hs-identifier hs-var">Extend</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="extendWith"><span class="annot"><span class="annottext">Extend m g f x y -&gt; f x -&gt; m (g x, f y)
</span><a href="Data.SOP.Telescope.html#extendWith"><span class="hs-identifier hs-var hs-var">extendWith</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621680013268"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013267"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680013270"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680013269"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013267"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680013268"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013266"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-294"></span><span>
</span><span id="line-295"></span><span class="hs-comment">-- | Extend the telescope</span><span>
</span><span id="line-296"></span><span class="hs-comment">--</span><span>
</span><span id="line-297"></span><span class="hs-comment">-- We will not attempt to extend the telescope past its final segment.</span><span>
</span><span id="line-298"></span><span class="hs-comment">--</span><span>
</span><span id="line-299"></span><span class="hs-comment">-- Blockchain intuition: suppose we have a telescope containing the ledger</span><span>
</span><span id="line-300"></span><span class="hs-comment">-- state. The &quot;how to extend&quot; argument would take, say, the final Byron</span><span>
</span><span id="line-301"></span><span class="hs-comment">-- state to the initial Shelley state; and &quot;where to extend from&quot; argument</span><span>
</span><span id="line-302"></span><span class="hs-comment">-- would indicate when we want to extend: when the current slot number has</span><span>
</span><span id="line-303"></span><span class="hs-comment">-- gone past the end of the Byron era.</span><span>
</span><span id="line-304"></span><span class="annot"><a href="Data.SOP.Telescope.html#extend"><span class="hs-identifier hs-type">extend</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680013146"><span class="annot"><a href="#local-6989586621680013146"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621680013145"><span class="annot"><a href="#local-6989586621680013145"><span class="hs-identifier hs-type">h</span></a></span></span><span> </span><span id="local-6989586621680013144"><span class="annot"><a href="#local-6989586621680013144"><span class="hs-identifier hs-type">g</span></a></span></span><span> </span><span id="local-6989586621680013143"><span class="annot"><a href="#local-6989586621680013143"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621680013142"><span class="annot"><a href="#local-6989586621680013142"><span class="hs-identifier hs-type">xs</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013146"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-305"></span><span>       </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SOP.InPairs.html#InPairs"><span class="hs-identifier hs-type">InPairs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.InPairs.html#Requiring"><span class="hs-identifier hs-type">Requiring</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013145"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Extend"><span class="hs-identifier hs-type">Extend</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013146"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013144"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013143"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680013142"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-comment">-- ^ How to extend</span><span>
</span><span id="line-306"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#NP"><span class="hs-identifier hs-type">NP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680013143"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">-.-&gt;</span></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:.:</span></span><span> </span><span class="annot"><a href="#local-6989586621680013145"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680013142"><span class="hs-identifier hs-type">xs</span></a></span><span>              </span><span class="hs-comment">-- ^ Where to extend /from/</span><span>
</span><span id="line-307"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013144"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013143"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013142"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680013146"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013144"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013143"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013142"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-308"></span><span id="extend"><span class="annot"><span class="annottext">extend :: InPairs (Requiring h (Extend m g f)) xs
-&gt; NP (f -.-&gt; (Maybe :.: h)) xs
-&gt; Telescope g f xs
-&gt; m (Telescope g f xs)
</span><a href="Data.SOP.Telescope.html#extend"><span class="hs-identifier hs-var hs-var">extend</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InPairs (Requiring h (Extend m g f)) xs
-&gt; NP (f -.-&gt; (Maybe :.: h)) xs
-&gt; Telescope g f xs
-&gt; m (Telescope g f xs)
forall (xs' :: [k]).
InPairs (Requiring h (Extend m g f)) xs'
-&gt; NP (f -.-&gt; (Maybe :.: h)) xs'
-&gt; Telescope g f xs'
-&gt; m (Telescope g f xs')
</span><a href="#local-6989586621680012792"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-309"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-310"></span><span>    </span><span id="local-6989586621680013285"><span class="annot"><a href="#local-6989586621680012792"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.SOP.InPairs.html#InPairs"><span class="hs-identifier hs-type">InPairs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.InPairs.html#Requiring"><span class="hs-identifier hs-type">Requiring</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013145"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Extend"><span class="hs-identifier hs-type">Extend</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013146"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013144"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013143"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680013285"><span class="hs-identifier hs-type">xs'</span></a></span><span>
</span><span id="line-311"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#NP"><span class="hs-identifier hs-type">NP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680013143"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">-.-&gt;</span></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:.:</span></span><span> </span><span class="annot"><a href="#local-6989586621680013145"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680013285"><span class="hs-identifier hs-type">xs'</span></a></span><span>
</span><span id="line-312"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013144"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013143"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013285"><span class="hs-identifier hs-type">xs'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680013146"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013144"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013143"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013285"><span class="hs-identifier hs-type">xs'</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-313"></span><span>    </span><span id="local-6989586621680012792"><span class="annot"><span class="annottext">go :: InPairs (Requiring h (Extend m g f)) xs'
-&gt; NP (f -.-&gt; (Maybe :.: h)) xs'
-&gt; Telescope g f xs'
-&gt; m (Telescope g f xs')
</span><a href="#local-6989586621680012792"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><span class="annottext">InPairs (Requiring h (Extend m g f)) xs'
</span><a href="Data.SOP.InPairs.html#PNil"><span class="hs-identifier hs-var">PNil</span></a></span><span> </span><span class="annot"><span class="annottext">NP (f -.-&gt; (Maybe :.: h)) xs'
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#TZ"><span class="hs-identifier hs-type">TZ</span></a></span><span> </span><span id="local-6989586621680012790"><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621680012790"><span class="hs-identifier hs-var">fx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-314"></span><span>        </span><span class="annot"><span class="annottext">Telescope g f '[x] -&gt; m (Telescope g f '[x])
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f x -&gt; Telescope g f '[x]
forall a (f :: a -&gt; *) (x :: a) (g :: a -&gt; *) (xs :: [a]).
f x -&gt; Telescope g f (x : xs)
</span><a href="Data.SOP.Telescope.html#TZ"><span class="hs-identifier hs-var">TZ</span></a></span><span> </span><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621680012790"><span class="hs-identifier hs-var">fx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-315"></span><span>    </span><span class="annot"><a href="#local-6989586621680012792"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.InPairs.html#PCons"><span class="hs-identifier hs-type">PCons</span></a></span><span> </span><span id="local-6989586621680012788"><span class="annot"><span class="annottext">Requiring h (Extend m g f) x y
</span><a href="#local-6989586621680012788"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621680012787"><span class="annot"><span class="annottext">InPairs (Requiring h (Extend m g f)) (y : zs)
</span><a href="#local-6989586621680012787"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680012786"><span class="annot"><span class="annottext">(-.-&gt;) f (Maybe :.: h) x
</span><a href="#local-6989586621680012786"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#%3A%2A"><span class="hs-operator hs-type">:*</span></a></span><span> </span><span id="local-6989586621680012785"><span class="annot"><span class="annottext">NP (f -.-&gt; (Maybe :.: h)) xs
</span><a href="#local-6989586621680012785"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#TZ"><span class="hs-identifier hs-type">TZ</span></a></span><span> </span><span id="local-6989586621680012784"><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621680012784"><span class="hs-identifier hs-var">fx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-316"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(:.:) Maybe h x -&gt; Maybe (h x)
forall l k (f :: l -&gt; *) (g :: k -&gt; l) (p :: k).
(:.:) f g p -&gt; f (g p)
</span><span class="hs-identifier hs-var">unComp</span></span><span> </span><span class="annot"><span class="annottext">((:.:) Maybe h x -&gt; Maybe (h x)) -&gt; (:.:) Maybe h x -&gt; Maybe (h x)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(-.-&gt;) f (Maybe :.: h) x -&gt; f x -&gt; (:.:) Maybe h x
forall k (f :: k -&gt; *) (g :: k -&gt; *) (a :: k).
(-.-&gt;) f g a -&gt; f a -&gt; g a
</span><span class="hs-identifier hs-var hs-var">apFn</span></span><span> </span><span class="annot"><span class="annottext">(-.-&gt;) f (Maybe :.: h) x
</span><a href="#local-6989586621680012786"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">f x
f x
</span><a href="#local-6989586621680012784"><span class="hs-identifier hs-var">fx</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-317"></span><span>          </span><span class="annot"><span class="annottext">Maybe (h x)
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-318"></span><span>            </span><span class="annot"><span class="annottext">Telescope g f (x : y : zs) -&gt; m (Telescope g f (x : y : zs))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f x -&gt; Telescope g f (x : y : zs)
forall a (f :: a -&gt; *) (x :: a) (g :: a -&gt; *) (xs :: [a]).
f x -&gt; Telescope g f (x : xs)
</span><a href="Data.SOP.Telescope.html#TZ"><span class="hs-identifier hs-var">TZ</span></a></span><span> </span><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621680012784"><span class="hs-identifier hs-var">fx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-319"></span><span>          </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680012783"><span class="annot"><span class="annottext">h x
</span><a href="#local-6989586621680012783"><span class="hs-identifier hs-var">hx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-320"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621680012782"><span class="annot"><span class="annottext">g x
</span><a href="#local-6989586621680012782"><span class="hs-identifier hs-var">gx</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680012781"><span class="annot"><span class="annottext">f y
</span><a href="#local-6989586621680012781"><span class="hs-identifier hs-var">fy</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Extend m g f x y -&gt; f x -&gt; m (g x, f y)
forall (m :: * -&gt; *) k (g :: k -&gt; *) (f :: k -&gt; *) (x :: k)
       (y :: k).
Extend m g f x y -&gt; f x -&gt; m (g x, f y)
</span><a href="Data.SOP.Telescope.html#extendWith"><span class="hs-identifier hs-var hs-var">extendWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Requiring h (Extend m g f) x y -&gt; h x -&gt; Extend m g f x y
forall k1 (h :: k1 -&gt; *) k2 (f :: k1 -&gt; k2 -&gt; *) (x :: k1)
       (y :: k2).
Requiring h f x y -&gt; h x -&gt; f x y
</span><a href="Data.SOP.InPairs.html#provide"><span class="hs-identifier hs-var hs-var">provide</span></a></span><span> </span><span class="annot"><span class="annottext">Requiring h (Extend m g f) x y
</span><a href="#local-6989586621680012788"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">h x
h x
</span><a href="#local-6989586621680012783"><span class="hs-identifier hs-var">hx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">f x
f x
</span><a href="#local-6989586621680012784"><span class="hs-identifier hs-var">fx</span></a></span><span>
</span><span id="line-321"></span><span>            </span><span class="annot"><span class="annottext">g x -&gt; Telescope g f (y : zs) -&gt; Telescope g f (x : y : zs)
forall a (g :: a -&gt; *) (x :: a) (f :: a -&gt; *) (xs :: [a]).
g x -&gt; Telescope g f xs -&gt; Telescope g f (x : xs)
</span><a href="Data.SOP.Telescope.html#TS"><span class="hs-identifier hs-var">TS</span></a></span><span> </span><span class="annot"><span class="annottext">g x
</span><a href="#local-6989586621680012782"><span class="hs-identifier hs-var">gx</span></a></span><span> </span><span class="annot"><span class="annottext">(Telescope g f (y : zs) -&gt; Telescope g f (x : y : zs))
-&gt; m (Telescope g f (y : zs)) -&gt; m (Telescope g f (x : y : zs))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">InPairs (Requiring h (Extend m g f)) (y : zs)
-&gt; NP (f -.-&gt; (Maybe :.: h)) (y : zs)
-&gt; Telescope g f (y : zs)
-&gt; m (Telescope g f (y : zs))
forall (xs' :: [k]).
InPairs (Requiring h (Extend m g f)) xs'
-&gt; NP (f -.-&gt; (Maybe :.: h)) xs'
-&gt; Telescope g f xs'
-&gt; m (Telescope g f xs')
</span><a href="#local-6989586621680012792"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">InPairs (Requiring h (Extend m g f)) (y : zs)
</span><a href="#local-6989586621680012787"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">NP (f -.-&gt; (Maybe :.: h)) xs
NP (f -.-&gt; (Maybe :.: h)) (y : zs)
</span><a href="#local-6989586621680012785"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f y -&gt; Telescope g f (y : zs)
forall a (f :: a -&gt; *) (x :: a) (g :: a -&gt; *) (xs :: [a]).
f x -&gt; Telescope g f (x : xs)
</span><a href="Data.SOP.Telescope.html#TZ"><span class="hs-identifier hs-var">TZ</span></a></span><span> </span><span class="annot"><span class="annottext">f y
</span><a href="#local-6989586621680012781"><span class="hs-identifier hs-var">fy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-322"></span><span>    </span><span class="annot"><a href="#local-6989586621680012792"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.InPairs.html#PCons"><span class="hs-identifier hs-type">PCons</span></a></span><span> </span><span class="annot"><span class="annottext">Requiring h (Extend m g f) x y
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680012779"><span class="annot"><span class="annottext">InPairs (Requiring h (Extend m g f)) (y : zs)
</span><a href="#local-6989586621680012779"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(-.-&gt;) f (Maybe :.: h) x
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#%3A%2A"><span class="hs-operator hs-type">:*</span></a></span><span> </span><span id="local-6989586621680012778"><span class="annot"><span class="annottext">NP (f -.-&gt; (Maybe :.: h)) xs
</span><a href="#local-6989586621680012778"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#TS"><span class="hs-identifier hs-type">TS</span></a></span><span> </span><span id="local-6989586621680012777"><span class="annot"><span class="annottext">g x
</span><a href="#local-6989586621680012777"><span class="hs-identifier hs-var">gx</span></a></span></span><span> </span><span id="local-6989586621680012776"><span class="annot"><span class="annottext">Telescope g f xs
</span><a href="#local-6989586621680012776"><span class="hs-identifier hs-var">fx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-323"></span><span>        </span><span class="annot"><span class="annottext">g x -&gt; Telescope g f (y : zs) -&gt; Telescope g f (x : y : zs)
forall a (g :: a -&gt; *) (x :: a) (f :: a -&gt; *) (xs :: [a]).
g x -&gt; Telescope g f xs -&gt; Telescope g f (x : xs)
</span><a href="Data.SOP.Telescope.html#TS"><span class="hs-identifier hs-var">TS</span></a></span><span> </span><span class="annot"><span class="annottext">g x
</span><a href="#local-6989586621680012777"><span class="hs-identifier hs-var">gx</span></a></span><span> </span><span class="annot"><span class="annottext">(Telescope g f (y : zs) -&gt; Telescope g f (x : y : zs))
-&gt; m (Telescope g f (y : zs)) -&gt; m (Telescope g f (x : y : zs))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">InPairs (Requiring h (Extend m g f)) (y : zs)
-&gt; NP (f -.-&gt; (Maybe :.: h)) (y : zs)
-&gt; Telescope g f (y : zs)
-&gt; m (Telescope g f (y : zs))
forall (xs' :: [k]).
InPairs (Requiring h (Extend m g f)) xs'
-&gt; NP (f -.-&gt; (Maybe :.: h)) xs'
-&gt; Telescope g f xs'
-&gt; m (Telescope g f xs')
</span><a href="#local-6989586621680012792"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">InPairs (Requiring h (Extend m g f)) (y : zs)
</span><a href="#local-6989586621680012779"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">NP (f -.-&gt; (Maybe :.: h)) xs
NP (f -.-&gt; (Maybe :.: h)) (y : zs)
</span><a href="#local-6989586621680012778"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope g f xs
Telescope g f (y : zs)
</span><a href="#local-6989586621680012776"><span class="hs-identifier hs-var">fx</span></a></span><span>
</span><span id="line-324"></span><span>
</span><span id="line-325"></span><span class="hs-keyword">newtype</span><span> </span><span id="Retract"><span class="annot"><a href="Data.SOP.Telescope.html#Retract"><span class="hs-identifier hs-var">Retract</span></a></span></span><span> </span><span id="local-6989586621680013200"><span class="annot"><a href="#local-6989586621680013200"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621680013199"><span class="annot"><a href="#local-6989586621680013199"><span class="hs-identifier hs-type">g</span></a></span></span><span> </span><span id="local-6989586621680013198"><span class="annot"><a href="#local-6989586621680013198"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621680013197"><span class="annot"><a href="#local-6989586621680013197"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span id="local-6989586621680013196"><span class="annot"><a href="#local-6989586621680013196"><span class="hs-identifier hs-type">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Retract"><span class="annot"><a href="Data.SOP.Telescope.html#Retract"><span class="hs-identifier hs-var">Retract</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="retractWith"><span class="annot"><span class="annottext">Retract m g f x y -&gt; g x -&gt; f y -&gt; m (f x)
</span><a href="Data.SOP.Telescope.html#retractWith"><span class="hs-identifier hs-var hs-var">retractWith</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621680013199"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013197"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680013198"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013196"><span class="hs-identifier hs-type">y</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680013200"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680013198"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013197"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-326"></span><span>
</span><span id="line-327"></span><span class="hs-comment">-- | Retract a telescope</span><span>
</span><span id="line-328"></span><span class="hs-comment">--</span><span>
</span><span id="line-329"></span><span class="hs-comment">-- Blockchain intuition: suppose we have a telescope containing the consensus</span><span>
</span><span id="line-330"></span><span class="hs-comment">-- state. When we rewind the consensus state, we might cross a hard fork</span><span>
</span><span id="line-331"></span><span class="hs-comment">-- transition point. So we first /retract/ the telescope /to/ the era containing</span><span>
</span><span id="line-332"></span><span class="hs-comment">-- the slot number that we want to rewind to, and only then call</span><span>
</span><span id="line-333"></span><span class="hs-comment">-- 'rewindChainDepState' on that era. Of course, retraction may fail (we</span><span>
</span><span id="line-334"></span><span class="hs-comment">-- might not /have/ past consensus state to rewind to anymore); this failure</span><span>
</span><span id="line-335"></span><span class="hs-comment">-- would require a choice for a particular monad @m@.</span><span>
</span><span id="line-336"></span><span class="annot"><a href="Data.SOP.Telescope.html#retract"><span class="hs-identifier hs-type">retract</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680013122"><span class="annot"><a href="#local-6989586621680013122"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621680013121"><span class="annot"><a href="#local-6989586621680013121"><span class="hs-identifier hs-type">h</span></a></span></span><span> </span><span id="local-6989586621680013120"><span class="annot"><a href="#local-6989586621680013120"><span class="hs-identifier hs-type">g</span></a></span></span><span> </span><span id="local-6989586621680013119"><span class="annot"><a href="#local-6989586621680013119"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621680013118"><span class="annot"><a href="#local-6989586621680013118"><span class="hs-identifier hs-type">xs</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013122"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-337"></span><span>        </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Tails.html#Tails"><span class="hs-identifier hs-type">Tails</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.InPairs.html#Requiring"><span class="hs-identifier hs-type">Requiring</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013121"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Retract"><span class="hs-identifier hs-type">Retract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013122"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013120"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013119"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680013118"><span class="hs-identifier hs-type">xs</span></a></span><span>  </span><span class="hs-comment">-- ^ How to retract</span><span>
</span><span id="line-338"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#NP"><span class="hs-identifier hs-type">NP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680013120"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">-.-&gt;</span></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:.:</span></span><span> </span><span class="annot"><a href="#local-6989586621680013121"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680013118"><span class="hs-identifier hs-type">xs</span></a></span><span>              </span><span class="hs-comment">-- ^ Where to retract /to/</span><span>
</span><span id="line-339"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013120"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013119"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013118"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680013122"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013120"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013119"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013118"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-340"></span><span id="retract"><span class="annot"><span class="annottext">retract :: Tails (Requiring h (Retract m g f)) xs
-&gt; NP (g -.-&gt; (Maybe :.: h)) xs
-&gt; Telescope g f xs
-&gt; m (Telescope g f xs)
</span><a href="Data.SOP.Telescope.html#retract"><span class="hs-identifier hs-var hs-var">retract</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-341"></span><span>    </span><span class="hs-glyph">\</span><span id="local-6989586621680012773"><span class="annot"><span class="annottext">Tails (Requiring h (Retract m g f)) xs
</span><a href="#local-6989586621680012773"><span class="hs-identifier hs-var">tails</span></a></span></span><span> </span><span id="local-6989586621680012772"><span class="annot"><span class="annottext">NP (g -.-&gt; (Maybe :.: h)) xs
</span><a href="#local-6989586621680012772"><span class="hs-identifier hs-var">np</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-342"></span><span>       </span><span class="annot"><span class="annottext">NP (g -.-&gt; (Maybe :.: h)) xs
-&gt; (SListI xs =&gt; Telescope g f xs -&gt; m (Telescope g f xs))
-&gt; Telescope g f xs
-&gt; m (Telescope g f xs)
forall k (a :: k -&gt; *) (xs :: [k]) r.
NP a xs -&gt; (SListI xs =&gt; r) -&gt; r
</span><a href="Data.SOP.Strict.html#npToSListI"><span class="hs-identifier hs-var">npToSListI</span></a></span><span> </span><span class="annot"><span class="annottext">NP (g -.-&gt; (Maybe :.: h)) xs
</span><a href="#local-6989586621680012772"><span class="hs-identifier hs-var">np</span></a></span><span> </span><span class="annot"><span class="annottext">((SListI xs =&gt; Telescope g f xs -&gt; m (Telescope g f xs))
 -&gt; Telescope g f xs -&gt; m (Telescope g f xs))
-&gt; (SListI xs =&gt; Telescope g f xs -&gt; m (Telescope g f xs))
-&gt; Telescope g f xs
-&gt; m (Telescope g f xs)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Tails (Requiring h (Retract m g f)) xs
-&gt; NP (g -.-&gt; (Maybe :.: h)) xs
-&gt; Telescope g f xs
-&gt; m (Telescope g f xs)
forall (xs' :: [k]).
SListI xs' =&gt;
Tails (Requiring h (Retract m g f)) xs'
-&gt; NP (g -.-&gt; (Maybe :.: h)) xs'
-&gt; Telescope g f xs'
-&gt; m (Telescope g f xs')
</span><a href="#local-6989586621680012770"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Tails (Requiring h (Retract m g f)) xs
</span><a href="#local-6989586621680012773"><span class="hs-identifier hs-var">tails</span></a></span><span> </span><span class="annot"><span class="annottext">NP (g -.-&gt; (Maybe :.: h)) xs
</span><a href="#local-6989586621680012772"><span class="hs-identifier hs-var">np</span></a></span><span>
</span><span id="line-343"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-344"></span><span>    </span><span id="local-6989586621680013234"><span class="annot"><a href="#local-6989586621680012770"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SListI</span></span><span> </span><span class="annot"><a href="#local-6989586621680013234"><span class="hs-identifier hs-type">xs'</span></a></span><span>
</span><span id="line-345"></span><span>       </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Tails.html#Tails"><span class="hs-identifier hs-type">Tails</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.InPairs.html#Requiring"><span class="hs-identifier hs-type">Requiring</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013121"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Retract"><span class="hs-identifier hs-type">Retract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013122"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013120"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013119"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680013234"><span class="hs-identifier hs-type">xs'</span></a></span><span>
</span><span id="line-346"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#NP"><span class="hs-identifier hs-type">NP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680013120"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">-.-&gt;</span></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:.:</span></span><span> </span><span class="annot"><a href="#local-6989586621680013121"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680013234"><span class="hs-identifier hs-type">xs'</span></a></span><span>
</span><span id="line-347"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013120"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013119"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013234"><span class="hs-identifier hs-type">xs'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680013122"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013120"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013119"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013234"><span class="hs-identifier hs-type">xs'</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-348"></span><span>    </span><span id="local-6989586621680012770"><span class="annot"><span class="annottext">go :: Tails (Requiring h (Retract m g f)) xs'
-&gt; NP (g -.-&gt; (Maybe :.: h)) xs'
-&gt; Telescope g f xs'
-&gt; m (Telescope g f xs')
</span><a href="#local-6989586621680012770"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><span class="annottext">Tails (Requiring h (Retract m g f)) xs'
</span><span class="hs-identifier">_</span></span><span>            </span><span class="annot"><span class="annottext">NP (g -.-&gt; (Maybe :.: h)) xs'
</span><span class="hs-identifier">_</span></span><span>         </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#TZ"><span class="hs-identifier hs-type">TZ</span></a></span><span> </span><span id="local-6989586621680012769"><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621680012769"><span class="hs-identifier hs-var">fx</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Telescope g f (x : xs) -&gt; m (Telescope g f (x : xs))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Telescope g f (x : xs) -&gt; m (Telescope g f (x : xs)))
-&gt; Telescope g f (x : xs) -&gt; m (Telescope g f (x : xs))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">f x -&gt; Telescope g f (x : xs)
forall a (f :: a -&gt; *) (x :: a) (g :: a -&gt; *) (xs :: [a]).
f x -&gt; Telescope g f (x : xs)
</span><a href="Data.SOP.Telescope.html#TZ"><span class="hs-identifier hs-var">TZ</span></a></span><span> </span><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621680012769"><span class="hs-identifier hs-var">fx</span></a></span><span>
</span><span id="line-349"></span><span>    </span><span class="annot"><a href="#local-6989586621680012770"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Tails.html#TCons"><span class="hs-identifier hs-type">TCons</span></a></span><span> </span><span id="local-6989586621680012767"><span class="annot"><span class="annottext">NP (Requiring h (Retract m g f) x) xs
</span><a href="#local-6989586621680012767"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621680012766"><span class="annot"><span class="annottext">Tails (Requiring h (Retract m g f)) xs
</span><a href="#local-6989586621680012766"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680012765"><span class="annot"><span class="annottext">(-.-&gt;) g (Maybe :.: h) x
</span><a href="#local-6989586621680012765"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#%3A%2A"><span class="hs-operator hs-type">:*</span></a></span><span> </span><span id="local-6989586621680012764"><span class="annot"><span class="annottext">NP (g -.-&gt; (Maybe :.: h)) xs
</span><a href="#local-6989586621680012764"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#TS"><span class="hs-identifier hs-type">TS</span></a></span><span> </span><span id="local-6989586621680012763"><span class="annot"><span class="annottext">g x
</span><a href="#local-6989586621680012763"><span class="hs-identifier hs-var">gx</span></a></span></span><span> </span><span id="local-6989586621680012762"><span class="annot"><span class="annottext">Telescope g f xs
</span><a href="#local-6989586621680012762"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-350"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(:.:) Maybe h x -&gt; Maybe (h x)
forall l k (f :: l -&gt; *) (g :: k -&gt; l) (p :: k).
(:.:) f g p -&gt; f (g p)
</span><span class="hs-identifier hs-var">unComp</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(-.-&gt;) g (Maybe :.: h) x -&gt; g x -&gt; (:.:) Maybe h x
forall k (f :: k -&gt; *) (g :: k -&gt; *) (a :: k).
(-.-&gt;) f g a -&gt; f a -&gt; g a
</span><span class="hs-identifier hs-var hs-var">apFn</span></span><span> </span><span class="annot"><span class="annottext">(-.-&gt;) g (Maybe :.: h) x
</span><a href="#local-6989586621680012765"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">g x
g x
</span><a href="#local-6989586621680012763"><span class="hs-identifier hs-var">gx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-351"></span><span>          </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680012761"><span class="annot"><span class="annottext">h x
</span><a href="#local-6989586621680012761"><span class="hs-identifier hs-var">hx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-352"></span><span>            </span><span class="annot"><span class="annottext">(NS (K (f x)) xs -&gt; Telescope g f (x : xs))
-&gt; m (NS (K (f x)) xs) -&gt; m (Telescope g f (x : xs))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f x -&gt; Telescope g f (x : xs)
forall a (f :: a -&gt; *) (x :: a) (g :: a -&gt; *) (xs :: [a]).
f x -&gt; Telescope g f (x : xs)
</span><a href="Data.SOP.Telescope.html#TZ"><span class="hs-identifier hs-var">TZ</span></a></span><span> </span><span class="annot"><span class="annottext">(f x -&gt; Telescope g f (x : xs))
-&gt; (NS (K (f x)) xs -&gt; f x)
-&gt; NS (K (f x)) xs
-&gt; Telescope g f (x : xs)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">NS (K (f x)) xs -&gt; f x
forall k l (h :: (k -&gt; *) -&gt; l -&gt; *) (xs :: l) a.
(HCollapse h, SListIN h xs) =&gt;
h (K a) xs -&gt; CollapseTo h a
</span><span class="hs-identifier hs-var">hcollapse</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m (NS (K (f x)) xs) -&gt; m (Telescope g f (x : xs)))
-&gt; m (NS (K (f x)) xs) -&gt; m (Telescope g f (x : xs))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">NS (m :.: K (f x)) xs -&gt; m (NS (K (f x)) xs)
forall k l (h :: (k -&gt; *) -&gt; l -&gt; *) (xs :: l) (f :: * -&gt; *)
       (g :: k -&gt; *).
(HSequence h, SListIN h xs, Applicative f) =&gt;
h (f :.: g) xs -&gt; f (h g xs)
</span><span class="hs-identifier hs-var">hsequence'</span></span><span> </span><span class="annot"><span class="annottext">(NS (m :.: K (f x)) xs -&gt; m (NS (K (f x)) xs))
-&gt; NS (m :.: K (f x)) xs -&gt; m (NS (K (f x)) xs)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-353"></span><span>              </span><span class="annot"><span class="annottext">(forall (a :: k).
 Requiring h (Retract m g f) x a -&gt; f a -&gt; (:.:) m (K (f x)) a)
-&gt; Prod NS (Requiring h (Retract m g f) x) xs
-&gt; NS f xs
-&gt; NS (m :.: K (f x)) xs
forall k l (h :: (k -&gt; *) -&gt; l -&gt; *) (xs :: l) (f :: k -&gt; *)
       (f' :: k -&gt; *) (f'' :: k -&gt; *).
(SListIN (Prod h) xs, HAp h, HAp (Prod h)) =&gt;
(forall (a :: k). f a -&gt; f' a -&gt; f'' a)
-&gt; Prod h f xs -&gt; h f' xs -&gt; h f'' xs
</span><span class="hs-identifier hs-var">hzipWith</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">h x
-&gt; g x
-&gt; Requiring h (Retract m g f) x a
-&gt; f a
-&gt; (:.:) m (K (f x)) a
forall k (m :: * -&gt; *) (h :: k -&gt; *) (x :: k) (g :: k -&gt; *)
       (f :: k -&gt; *) (z :: k).
Functor m =&gt;
h x
-&gt; g x
-&gt; Requiring h (Retract m g f) x z
-&gt; f z
-&gt; (:.:) m (K (f x)) z
</span><a href="Data.SOP.Telescope.html#retractAux"><span class="hs-identifier hs-var">retractAux</span></a></span><span> </span><span class="annot"><span class="annottext">h x
</span><a href="#local-6989586621680012761"><span class="hs-identifier hs-var">hx</span></a></span><span> </span><span class="annot"><span class="annottext">g x
g x
</span><a href="#local-6989586621680012763"><span class="hs-identifier hs-var">gx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Prod NS (Requiring h (Retract m g f) x) xs
NP (Requiring h (Retract m g f) x) xs
</span><a href="#local-6989586621680012767"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Telescope g f xs -&gt; NS f xs
forall k (g :: k -&gt; *) (f :: k -&gt; *) (xs :: [k]).
Telescope g f xs -&gt; NS f xs
</span><a href="Data.SOP.Telescope.html#tip"><span class="hs-identifier hs-var">tip</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope g f xs
</span><a href="#local-6989586621680012762"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-354"></span><span>          </span><span class="annot"><span class="annottext">Maybe (h x)
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-355"></span><span>            </span><span class="annot"><span class="annottext">g x -&gt; Telescope g f xs -&gt; Telescope g f (x : xs)
forall a (g :: a -&gt; *) (x :: a) (f :: a -&gt; *) (xs :: [a]).
g x -&gt; Telescope g f xs -&gt; Telescope g f (x : xs)
</span><a href="Data.SOP.Telescope.html#TS"><span class="hs-identifier hs-var">TS</span></a></span><span> </span><span class="annot"><span class="annottext">g x
</span><a href="#local-6989586621680012763"><span class="hs-identifier hs-var">gx</span></a></span><span> </span><span class="annot"><span class="annottext">(Telescope g f xs -&gt; Telescope g f (x : xs))
-&gt; m (Telescope g f xs) -&gt; m (Telescope g f (x : xs))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Tails (Requiring h (Retract m g f)) xs
-&gt; NP (g -.-&gt; (Maybe :.: h)) xs
-&gt; Telescope g f xs
-&gt; m (Telescope g f xs)
forall (xs' :: [k]).
SListI xs' =&gt;
Tails (Requiring h (Retract m g f)) xs'
-&gt; NP (g -.-&gt; (Maybe :.: h)) xs'
-&gt; Telescope g f xs'
-&gt; m (Telescope g f xs')
</span><a href="#local-6989586621680012770"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Tails (Requiring h (Retract m g f)) xs
</span><a href="#local-6989586621680012766"><span class="hs-identifier hs-var">rs</span></a></span><span> </span><span class="annot"><span class="annottext">NP (g -.-&gt; (Maybe :.: h)) xs
NP (g -.-&gt; (Maybe :.: h)) xs
</span><a href="#local-6989586621680012764"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope g f xs
Telescope g f xs
</span><a href="#local-6989586621680012762"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-356"></span><span>
</span><span id="line-357"></span><span class="hs-comment">-- | Internal auxiliary to 'retract' and 'alignWith'</span><span>
</span><span id="line-358"></span><span id="local-6989586621680013209"><span id="local-6989586621680013210"><span id="local-6989586621680013211"><span id="local-6989586621680013212"><span id="local-6989586621680013213"><span id="local-6989586621680013214"><span class="annot"><a href="Data.SOP.Telescope.html#retractAux"><span class="hs-identifier hs-type">retractAux</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Functor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013214"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-359"></span><span>           </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680013213"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013212"><span class="hs-identifier hs-type">x</span></a></span><span>  </span><span class="hs-comment">-- Proof that we need to retract</span><span>
</span><span id="line-360"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680013211"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013212"><span class="hs-identifier hs-type">x</span></a></span><span>  </span><span class="hs-comment">-- Era we are retracting to</span><span>
</span><span id="line-361"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.InPairs.html#Requiring"><span class="hs-identifier hs-type">Requiring</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013213"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Retract"><span class="hs-identifier hs-type">Retract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013214"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013211"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013210"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680013212"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013209"><span class="hs-identifier hs-type">z</span></a></span><span>
</span><span id="line-362"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680013210"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013209"><span class="hs-identifier hs-type">z</span></a></span><span>  </span><span class="hs-comment">-- Current tip (what we are retracting from)</span><span>
</span><span id="line-363"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680013214"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:.:</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">K</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680013210"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013212"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680013209"><span class="hs-identifier hs-type">z</span></a></span></span></span></span></span></span></span><span>
</span><span id="line-364"></span><span id="retractAux"><span class="annot"><span class="annottext">retractAux :: h x
-&gt; g x
-&gt; Requiring h (Retract m g f) x z
-&gt; f z
-&gt; (:.:) m (K (f x)) z
</span><a href="Data.SOP.Telescope.html#retractAux"><span class="hs-identifier hs-var hs-var">retractAux</span></a></span></span><span> </span><span id="local-6989586621680012758"><span class="annot"><span class="annottext">h x
</span><a href="#local-6989586621680012758"><span class="hs-identifier hs-var">hx</span></a></span></span><span> </span><span id="local-6989586621680012757"><span class="annot"><span class="annottext">g x
</span><a href="#local-6989586621680012757"><span class="hs-identifier hs-var">gx</span></a></span></span><span> </span><span id="local-6989586621680012756"><span class="annot"><span class="annottext">Requiring h (Retract m g f) x z
</span><a href="#local-6989586621680012756"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621680012755"><span class="annot"><span class="annottext">f z
</span><a href="#local-6989586621680012755"><span class="hs-identifier hs-var">fz</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (K (f x) z) -&gt; (:.:) m (K (f x)) z
forall l k (f :: l -&gt; *) (g :: k -&gt; l) (p :: k).
f (g p) -&gt; (:.:) f g p
</span><span class="hs-identifier hs-var">Comp</span></span><span> </span><span class="annot"><span class="annottext">(m (K (f x) z) -&gt; (:.:) m (K (f x)) z)
-&gt; m (K (f x) z) -&gt; (:.:) m (K (f x)) z
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">f x -&gt; K (f x) z
forall k a (b :: k). a -&gt; K a b
</span><span class="hs-identifier hs-var">K</span></span><span> </span><span class="annot"><span class="annottext">(f x -&gt; K (f x) z) -&gt; m (f x) -&gt; m (K (f x) z)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Retract m g f x z -&gt; g x -&gt; f z -&gt; m (f x)
forall (m :: * -&gt; *) k (g :: k -&gt; *) (f :: k -&gt; *) (x :: k)
       (y :: k).
Retract m g f x y -&gt; g x -&gt; f y -&gt; m (f x)
</span><a href="Data.SOP.Telescope.html#retractWith"><span class="hs-identifier hs-var hs-var">retractWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Requiring h (Retract m g f) x z -&gt; h x -&gt; Retract m g f x z
forall k1 (h :: k1 -&gt; *) k2 (f :: k1 -&gt; k2 -&gt; *) (x :: k1)
       (y :: k2).
Requiring h f x y -&gt; h x -&gt; f x y
</span><a href="Data.SOP.InPairs.html#provide"><span class="hs-identifier hs-var hs-var">provide</span></a></span><span> </span><span class="annot"><span class="annottext">Requiring h (Retract m g f) x z
</span><a href="#local-6989586621680012756"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">h x
</span><a href="#local-6989586621680012758"><span class="hs-identifier hs-var">hx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">g x
</span><a href="#local-6989586621680012757"><span class="hs-identifier hs-var">gx</span></a></span><span> </span><span class="annot"><span class="annottext">f z
</span><a href="#local-6989586621680012755"><span class="hs-identifier hs-var">fz</span></a></span><span>
</span><span id="line-365"></span><span>
</span><span id="line-366"></span><span class="hs-comment">-- | Align a telescope with another, then apply a function to the tips</span><span>
</span><span id="line-367"></span><span class="hs-comment">--</span><span>
</span><span id="line-368"></span><span class="hs-comment">-- Aligning is a combination of extension and retraction, extending or</span><span>
</span><span id="line-369"></span><span class="hs-comment">-- retracting the telescope as required to match up with the other telescope.</span><span>
</span><span id="line-370"></span><span class="hs-comment">--</span><span>
</span><span id="line-371"></span><span class="hs-comment">-- Blockchain intuition: suppose we have one telescope containing the</span><span>
</span><span id="line-372"></span><span class="hs-comment">-- already-ticked ledger state, and another telescope containing the consensus</span><span>
</span><span id="line-373"></span><span class="hs-comment">-- state. Since the ledger state has already been ticked, it might have been</span><span>
</span><span id="line-374"></span><span class="hs-comment">-- advanced to the next era. If this happens, we should then align the</span><span>
</span><span id="line-375"></span><span class="hs-comment">-- consensus state with the ledger state, moving /it/ also to the next era,</span><span>
</span><span id="line-376"></span><span class="hs-comment">-- before we can do the consensus header validation check. Note that in this</span><span>
</span><span id="line-377"></span><span class="hs-comment">-- particular example, the ledger state will always be ahead of the consensus</span><span>
</span><span id="line-378"></span><span class="hs-comment">-- state, never behind; 'alignExtend' can be used in this case.</span><span>
</span><span id="line-379"></span><span class="annot"><a href="Data.SOP.Telescope.html#align"><span class="hs-identifier hs-type">align</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680013099"><span class="annot"><a href="#local-6989586621680013099"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621680013098"><span class="annot"><a href="#local-6989586621680013098"><span class="hs-identifier hs-type">g'</span></a></span></span><span> </span><span id="local-6989586621680013097"><span class="annot"><a href="#local-6989586621680013097"><span class="hs-identifier hs-type">g</span></a></span></span><span> </span><span id="local-6989586621680013094"><span class="annot"><a href="#local-6989586621680013094"><span class="hs-identifier hs-type">f'</span></a></span></span><span> </span><span id="local-6989586621680013096"><span class="annot"><a href="#local-6989586621680013096"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621680013093"><span class="annot"><a href="#local-6989586621680013093"><span class="hs-identifier hs-type">f''</span></a></span></span><span> </span><span id="local-6989586621680013095"><span class="annot"><a href="#local-6989586621680013095"><span class="hs-identifier hs-type">xs</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013099"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-380"></span><span>      </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SOP.InPairs.html#InPairs"><span class="hs-identifier hs-type">InPairs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.InPairs.html#Requiring"><span class="hs-identifier hs-type">Requiring</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013098"><span class="hs-identifier hs-type">g'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Extend"><span class="hs-identifier hs-type">Extend</span></a></span><span>  </span><span class="annot"><a href="#local-6989586621680013099"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013097"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013096"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680013095"><span class="hs-identifier hs-type">xs</span></a></span><span>  </span><span class="hs-comment">-- ^ How to extend</span><span>
</span><span id="line-381"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Tails.html#Tails"><span class="hs-identifier hs-type">Tails</span></a></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.InPairs.html#Requiring"><span class="hs-identifier hs-type">Requiring</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013094"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Retract"><span class="hs-identifier hs-type">Retract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013099"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013097"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013096"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680013095"><span class="hs-identifier hs-type">xs</span></a></span><span>  </span><span class="hs-comment">-- ^ How to retract</span><span>
</span><span id="line-382"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#NP"><span class="hs-identifier hs-type">NP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680013094"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">-.-&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680013096"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">-.-&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680013093"><span class="hs-identifier hs-type">f''</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680013095"><span class="hs-identifier hs-type">xs</span></a></span><span>  </span><span class="hs-comment">-- ^ Function to apply at the tip</span><span>
</span><span id="line-383"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013098"><span class="hs-identifier hs-type">g'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013094"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013095"><span class="hs-identifier hs-type">xs</span></a></span><span>          </span><span class="hs-comment">-- ^ Telescope we are aligning with</span><span>
</span><span id="line-384"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013097"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013096"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013095"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680013099"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013097"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013093"><span class="hs-identifier hs-type">f''</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013095"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-385"></span><span id="align"><span class="annot"><span class="annottext">align :: InPairs (Requiring g' (Extend m g f)) xs
-&gt; Tails (Requiring f' (Retract m g f)) xs
-&gt; NP (f' -.-&gt; (f -.-&gt; f'')) xs
-&gt; Telescope g' f' xs
-&gt; Telescope g f xs
-&gt; m (Telescope g f'' xs)
</span><a href="Data.SOP.Telescope.html#align"><span class="hs-identifier hs-var hs-var">align</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680012754"><span class="annot"><span class="annottext">InPairs (Requiring g' (Extend m g f)) xs
</span><a href="#local-6989586621680012754"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span id="local-6989586621680012753"><span class="annot"><span class="annottext">Tails (Requiring f' (Retract m g f)) xs
</span><a href="#local-6989586621680012753"><span class="hs-identifier hs-var">rs</span></a></span></span><span> </span><span id="local-6989586621680012752"><span class="annot"><span class="annottext">NP (f' -.-&gt; (f -.-&gt; f'')) xs
</span><a href="#local-6989586621680012752"><span class="hs-identifier hs-var">atTip</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-386"></span><span>    </span><span class="annot"><span class="annottext">NP (f' -.-&gt; (f -.-&gt; f'')) xs
-&gt; (SListI xs =&gt;
    Telescope g' f' xs -&gt; Telescope g f xs -&gt; m (Telescope g f'' xs))
-&gt; Telescope g' f' xs
-&gt; Telescope g f xs
-&gt; m (Telescope g f'' xs)
forall k (a :: k -&gt; *) (xs :: [k]) r.
NP a xs -&gt; (SListI xs =&gt; r) -&gt; r
</span><a href="Data.SOP.Strict.html#npToSListI"><span class="hs-identifier hs-var">npToSListI</span></a></span><span> </span><span class="annot"><span class="annottext">NP (f' -.-&gt; (f -.-&gt; f'')) xs
</span><a href="#local-6989586621680012752"><span class="hs-identifier hs-var">atTip</span></a></span><span> </span><span class="annot"><span class="annottext">((SListI xs =&gt;
  Telescope g' f' xs -&gt; Telescope g f xs -&gt; m (Telescope g f'' xs))
 -&gt; Telescope g' f' xs
 -&gt; Telescope g f xs
 -&gt; m (Telescope g f'' xs))
-&gt; (SListI xs =&gt;
    Telescope g' f' xs -&gt; Telescope g f xs -&gt; m (Telescope g f'' xs))
-&gt; Telescope g' f' xs
-&gt; Telescope g f xs
-&gt; m (Telescope g f'' xs)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">InPairs (Requiring g' (Extend m g f)) xs
-&gt; Tails (Requiring f' (Retract m g f)) xs
-&gt; NP (f' -.-&gt; (f -.-&gt; f'')) xs
-&gt; Telescope g' f' xs
-&gt; Telescope g f xs
-&gt; m (Telescope g f'' xs)
forall (xs' :: [k]).
SListI xs' =&gt;
InPairs (Requiring g' (Extend m g f)) xs'
-&gt; Tails (Requiring f' (Retract m g f)) xs'
-&gt; NP (f' -.-&gt; (f -.-&gt; f'')) xs'
-&gt; Telescope g' f' xs'
-&gt; Telescope g f xs'
-&gt; m (Telescope g f'' xs')
</span><a href="#local-6989586621680012751"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">InPairs (Requiring g' (Extend m g f)) xs
</span><a href="#local-6989586621680012754"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">Tails (Requiring f' (Retract m g f)) xs
</span><a href="#local-6989586621680012753"><span class="hs-identifier hs-var">rs</span></a></span><span> </span><span class="annot"><span class="annottext">NP (f' -.-&gt; (f -.-&gt; f'')) xs
</span><a href="#local-6989586621680012752"><span class="hs-identifier hs-var">atTip</span></a></span><span>
</span><span id="line-387"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-388"></span><span>    </span><span id="local-6989586621680013187"><span class="annot"><a href="#local-6989586621680012751"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SListI</span></span><span> </span><span class="annot"><a href="#local-6989586621680013187"><span class="hs-identifier hs-type">xs'</span></a></span><span>
</span><span id="line-389"></span><span>       </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SOP.InPairs.html#InPairs"><span class="hs-identifier hs-type">InPairs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.InPairs.html#Requiring"><span class="hs-identifier hs-type">Requiring</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013098"><span class="hs-identifier hs-type">g'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Extend"><span class="hs-identifier hs-type">Extend</span></a></span><span>  </span><span class="annot"><a href="#local-6989586621680013099"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013097"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013096"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680013187"><span class="hs-identifier hs-type">xs'</span></a></span><span>
</span><span id="line-390"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Tails.html#Tails"><span class="hs-identifier hs-type">Tails</span></a></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.InPairs.html#Requiring"><span class="hs-identifier hs-type">Requiring</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013094"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Retract"><span class="hs-identifier hs-type">Retract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013099"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013097"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013096"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680013187"><span class="hs-identifier hs-type">xs'</span></a></span><span>
</span><span id="line-391"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#NP"><span class="hs-identifier hs-type">NP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680013094"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">-.-&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680013096"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">-.-&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680013093"><span class="hs-identifier hs-type">f''</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680013187"><span class="hs-identifier hs-type">xs'</span></a></span><span>
</span><span id="line-392"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013098"><span class="hs-identifier hs-type">g'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013094"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013187"><span class="hs-identifier hs-type">xs'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013097"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013096"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013187"><span class="hs-identifier hs-type">xs'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680013099"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013097"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013093"><span class="hs-identifier hs-type">f''</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013187"><span class="hs-identifier hs-type">xs'</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-393"></span><span>    </span><span id="local-6989586621680012751"><span class="annot"><span class="annottext">go :: InPairs (Requiring g' (Extend m g f)) xs'
-&gt; Tails (Requiring f' (Retract m g f)) xs'
-&gt; NP (f' -.-&gt; (f -.-&gt; f'')) xs'
-&gt; Telescope g' f' xs'
-&gt; Telescope g f xs'
-&gt; m (Telescope g f'' xs')
</span><a href="#local-6989586621680012751"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><span class="annottext">InPairs (Requiring g' (Extend m g f)) xs'
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Tails (Requiring f' (Retract m g f)) xs'
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680012750"><span class="annot"><span class="annottext">(-.-&gt;) f' (f -.-&gt; f'') x
</span><a href="#local-6989586621680012750"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#%3A%2A"><span class="hs-operator hs-type">:*</span></a></span><span> </span><span class="annot"><span class="annottext">NP (f' -.-&gt; (f -.-&gt; f'')) xs
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#TZ"><span class="hs-identifier hs-type">TZ</span></a></span><span> </span><span id="local-6989586621680012749"><span class="annot"><span class="annottext">f' x
</span><a href="#local-6989586621680012749"><span class="hs-identifier hs-var">f'x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#TZ"><span class="hs-identifier hs-type">TZ</span></a></span><span> </span><span id="local-6989586621680012748"><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621680012748"><span class="hs-identifier hs-var">fx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-394"></span><span>        </span><span class="annot"><span class="annottext">Telescope g f'' (x : xs) -&gt; m (Telescope g f'' (x : xs))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Telescope g f'' (x : xs) -&gt; m (Telescope g f'' (x : xs)))
-&gt; Telescope g f'' (x : xs) -&gt; m (Telescope g f'' (x : xs))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">f'' x -&gt; Telescope g f'' (x : xs)
forall a (f :: a -&gt; *) (x :: a) (g :: a -&gt; *) (xs :: [a]).
f x -&gt; Telescope g f (x : xs)
</span><a href="Data.SOP.Telescope.html#TZ"><span class="hs-identifier hs-var">TZ</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(-.-&gt;) f' (f -.-&gt; f'') x
</span><a href="#local-6989586621680012750"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(-.-&gt;) f' (f -.-&gt; f'') x -&gt; f' x -&gt; (-.-&gt;) f f'' x
forall k (f :: k -&gt; *) (g :: k -&gt; *) (a :: k).
(-.-&gt;) f g a -&gt; f a -&gt; g a
</span><span class="hs-operator hs-var hs-var">`apFn`</span></span><span> </span><span class="annot"><span class="annottext">f' x
f' x
</span><a href="#local-6989586621680012749"><span class="hs-identifier hs-var">f'x</span></a></span><span> </span><span class="annot"><span class="annottext">(-.-&gt;) f f'' x -&gt; f x -&gt; f'' x
forall k (f :: k -&gt; *) (g :: k -&gt; *) (a :: k).
(-.-&gt;) f g a -&gt; f a -&gt; g a
</span><span class="hs-operator hs-var hs-var">`apFn`</span></span><span> </span><span class="annot"><span class="annottext">f x
f x
</span><a href="#local-6989586621680012748"><span class="hs-identifier hs-var">fx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-395"></span><span>    </span><span class="annot"><a href="#local-6989586621680012751"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.InPairs.html#PCons"><span class="hs-identifier hs-type">PCons</span></a></span><span> </span><span class="annot"><span class="annottext">Requiring g' (Extend m g f) x y
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680012747"><span class="annot"><span class="annottext">InPairs (Requiring g' (Extend m g f)) (y : zs)
</span><a href="#local-6989586621680012747"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Tails.html#TCons"><span class="hs-identifier hs-type">TCons</span></a></span><span> </span><span class="annot"><span class="annottext">NP (Requiring f' (Retract m g f) x) xs
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680012746"><span class="annot"><span class="annottext">Tails (Requiring f' (Retract m g f)) xs
</span><a href="#local-6989586621680012746"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(-.-&gt;) f' (f -.-&gt; f'') x
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#%3A%2A"><span class="hs-operator hs-type">:*</span></a></span><span> </span><span id="local-6989586621680012745"><span class="annot"><span class="annottext">NP (f' -.-&gt; (f -.-&gt; f'')) xs
</span><a href="#local-6989586621680012745"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#TS"><span class="hs-identifier hs-type">TS</span></a></span><span> </span><span class="annot"><span class="annottext">g' x
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680012744"><span class="annot"><span class="annottext">Telescope g' f' xs
</span><a href="#local-6989586621680012744"><span class="hs-identifier hs-var">f'x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#TS"><span class="hs-identifier hs-type">TS</span></a></span><span> </span><span id="local-6989586621680012743"><span class="annot"><span class="annottext">g x
</span><a href="#local-6989586621680012743"><span class="hs-identifier hs-var">gx</span></a></span></span><span> </span><span id="local-6989586621680012742"><span class="annot"><span class="annottext">Telescope g f xs
</span><a href="#local-6989586621680012742"><span class="hs-identifier hs-var">fx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-396"></span><span>        </span><span class="annot"><span class="annottext">g x -&gt; Telescope g f'' (y : zs) -&gt; Telescope g f'' (x : y : zs)
forall a (g :: a -&gt; *) (x :: a) (f :: a -&gt; *) (xs :: [a]).
g x -&gt; Telescope g f xs -&gt; Telescope g f (x : xs)
</span><a href="Data.SOP.Telescope.html#TS"><span class="hs-identifier hs-var">TS</span></a></span><span> </span><span class="annot"><span class="annottext">g x
</span><a href="#local-6989586621680012743"><span class="hs-identifier hs-var">gx</span></a></span><span> </span><span class="annot"><span class="annottext">(Telescope g f'' (y : zs) -&gt; Telescope g f'' (x : y : zs))
-&gt; m (Telescope g f'' (y : zs)) -&gt; m (Telescope g f'' (x : y : zs))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">InPairs (Requiring g' (Extend m g f)) (y : zs)
-&gt; Tails (Requiring f' (Retract m g f)) (y : zs)
-&gt; NP (f' -.-&gt; (f -.-&gt; f'')) (y : zs)
-&gt; Telescope g' f' (y : zs)
-&gt; Telescope g f (y : zs)
-&gt; m (Telescope g f'' (y : zs))
forall (xs' :: [k]).
SListI xs' =&gt;
InPairs (Requiring g' (Extend m g f)) xs'
-&gt; Tails (Requiring f' (Retract m g f)) xs'
-&gt; NP (f' -.-&gt; (f -.-&gt; f'')) xs'
-&gt; Telescope g' f' xs'
-&gt; Telescope g f xs'
-&gt; m (Telescope g f'' xs')
</span><a href="#local-6989586621680012751"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">InPairs (Requiring g' (Extend m g f)) (y : zs)
</span><a href="#local-6989586621680012747"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">Tails (Requiring f' (Retract m g f)) xs
Tails (Requiring f' (Retract m g f)) (y : zs)
</span><a href="#local-6989586621680012746"><span class="hs-identifier hs-var">rs</span></a></span><span> </span><span class="annot"><span class="annottext">NP (f' -.-&gt; (f -.-&gt; f'')) xs
NP (f' -.-&gt; (f -.-&gt; f'')) (y : zs)
</span><a href="#local-6989586621680012745"><span class="hs-identifier hs-var">fs</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope g' f' xs
Telescope g' f' (y : zs)
</span><a href="#local-6989586621680012744"><span class="hs-identifier hs-var">f'x</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope g f xs
Telescope g f (y : zs)
</span><a href="#local-6989586621680012742"><span class="hs-identifier hs-var">fx</span></a></span><span>
</span><span id="line-397"></span><span>    </span><span class="annot"><a href="#local-6989586621680012751"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">InPairs (Requiring g' (Extend m g f)) xs'
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Tails.html#TCons"><span class="hs-identifier hs-type">TCons</span></a></span><span> </span><span id="local-6989586621680012741"><span class="annot"><span class="annottext">NP (Requiring f' (Retract m g f) x) xs
</span><a href="#local-6989586621680012741"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="annot"><span class="annottext">Tails (Requiring f' (Retract m g f)) xs
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680012740"><span class="annot"><span class="annottext">(-.-&gt;) f' (f -.-&gt; f'') x
</span><a href="#local-6989586621680012740"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#%3A%2A"><span class="hs-operator hs-type">:*</span></a></span><span> </span><span class="annot"><span class="annottext">NP (f' -.-&gt; (f -.-&gt; f'')) xs
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#TZ"><span class="hs-identifier hs-type">TZ</span></a></span><span> </span><span id="local-6989586621680012739"><span class="annot"><span class="annottext">f' x
</span><a href="#local-6989586621680012739"><span class="hs-identifier hs-var">f'x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#TS"><span class="hs-identifier hs-type">TS</span></a></span><span> </span><span id="local-6989586621680012738"><span class="annot"><span class="annottext">g x
</span><a href="#local-6989586621680012738"><span class="hs-identifier hs-var">gx</span></a></span></span><span> </span><span id="local-6989586621680012737"><span class="annot"><span class="annottext">Telescope g f xs
</span><a href="#local-6989586621680012737"><span class="hs-identifier hs-var">fx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-398"></span><span>        </span><span class="annot"><span class="annottext">(NS (K (f x)) xs -&gt; Telescope g f'' (x : xs))
-&gt; m (NS (K (f x)) xs) -&gt; m (Telescope g f'' (x : xs))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f'' x -&gt; Telescope g f'' (x : xs)
forall a (f :: a -&gt; *) (x :: a) (g :: a -&gt; *) (xs :: [a]).
f x -&gt; Telescope g f (x : xs)
</span><a href="Data.SOP.Telescope.html#TZ"><span class="hs-identifier hs-var">TZ</span></a></span><span> </span><span class="annot"><span class="annottext">(f'' x -&gt; Telescope g f'' (x : xs))
-&gt; (NS (K (f x)) xs -&gt; f'' x)
-&gt; NS (K (f x)) xs
-&gt; Telescope g f'' (x : xs)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680012736"><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621680012736"><span class="hs-identifier hs-var">fx'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(-.-&gt;) f' (f -.-&gt; f'') x
</span><a href="#local-6989586621680012740"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(-.-&gt;) f' (f -.-&gt; f'') x -&gt; f' x -&gt; (-.-&gt;) f f'' x
forall k (f :: k -&gt; *) (g :: k -&gt; *) (a :: k).
(-.-&gt;) f g a -&gt; f a -&gt; g a
</span><span class="hs-operator hs-var hs-var">`apFn`</span></span><span> </span><span class="annot"><span class="annottext">f' x
f' x
</span><a href="#local-6989586621680012739"><span class="hs-identifier hs-var">f'x</span></a></span><span> </span><span class="annot"><span class="annottext">(-.-&gt;) f f'' x -&gt; f x -&gt; f'' x
forall k (f :: k -&gt; *) (g :: k -&gt; *) (a :: k).
(-.-&gt;) f g a -&gt; f a -&gt; g a
</span><span class="hs-operator hs-var hs-var">`apFn`</span></span><span> </span><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621680012736"><span class="hs-identifier hs-var">fx'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(f x -&gt; f'' x)
-&gt; (NS (K (f x)) xs -&gt; f x) -&gt; NS (K (f x)) xs -&gt; f'' x
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">NS (K (f x)) xs -&gt; f x
forall k l (h :: (k -&gt; *) -&gt; l -&gt; *) (xs :: l) a.
(HCollapse h, SListIN h xs) =&gt;
h (K a) xs -&gt; CollapseTo h a
</span><span class="hs-identifier hs-var">hcollapse</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m (NS (K (f x)) xs) -&gt; m (Telescope g f'' (x : xs)))
-&gt; m (NS (K (f x)) xs) -&gt; m (Telescope g f'' (x : xs))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">NS (m :.: K (f x)) xs -&gt; m (NS (K (f x)) xs)
forall k l (h :: (k -&gt; *) -&gt; l -&gt; *) (xs :: l) (f :: * -&gt; *)
       (g :: k -&gt; *).
(HSequence h, SListIN h xs, Applicative f) =&gt;
h (f :.: g) xs -&gt; f (h g xs)
</span><span class="hs-identifier hs-var">hsequence'</span></span><span> </span><span class="annot"><span class="annottext">(NS (m :.: K (f x)) xs -&gt; m (NS (K (f x)) xs))
-&gt; NS (m :.: K (f x)) xs -&gt; m (NS (K (f x)) xs)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-399"></span><span>          </span><span class="annot"><span class="annottext">(forall (a :: k).
 Requiring f' (Retract m g f) x a -&gt; f a -&gt; (:.:) m (K (f x)) a)
-&gt; Prod NS (Requiring f' (Retract m g f) x) xs
-&gt; NS f xs
-&gt; NS (m :.: K (f x)) xs
forall k l (h :: (k -&gt; *) -&gt; l -&gt; *) (xs :: l) (f :: k -&gt; *)
       (f' :: k -&gt; *) (f'' :: k -&gt; *).
(SListIN (Prod h) xs, HAp h, HAp (Prod h)) =&gt;
(forall (a :: k). f a -&gt; f' a -&gt; f'' a)
-&gt; Prod h f xs -&gt; h f' xs -&gt; h f'' xs
</span><span class="hs-identifier hs-var">hzipWith</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f' x
-&gt; g x
-&gt; Requiring f' (Retract m g f) x a
-&gt; f a
-&gt; (:.:) m (K (f x)) a
forall k (m :: * -&gt; *) (h :: k -&gt; *) (x :: k) (g :: k -&gt; *)
       (f :: k -&gt; *) (z :: k).
Functor m =&gt;
h x
-&gt; g x
-&gt; Requiring h (Retract m g f) x z
-&gt; f z
-&gt; (:.:) m (K (f x)) z
</span><a href="Data.SOP.Telescope.html#retractAux"><span class="hs-identifier hs-var">retractAux</span></a></span><span> </span><span class="annot"><span class="annottext">f' x
</span><a href="#local-6989586621680012739"><span class="hs-identifier hs-var">f'x</span></a></span><span> </span><span class="annot"><span class="annottext">g x
g x
</span><a href="#local-6989586621680012738"><span class="hs-identifier hs-var">gx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Prod NS (Requiring f' (Retract m g f) x) xs
NP (Requiring f' (Retract m g f) x) xs
</span><a href="#local-6989586621680012741"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Telescope g f xs -&gt; NS f xs
forall k (g :: k -&gt; *) (f :: k -&gt; *) (xs :: [k]).
Telescope g f xs -&gt; NS f xs
</span><a href="Data.SOP.Telescope.html#tip"><span class="hs-identifier hs-var">tip</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope g f xs
</span><a href="#local-6989586621680012737"><span class="hs-identifier hs-var">fx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-400"></span><span>    </span><span class="annot"><a href="#local-6989586621680012751"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.InPairs.html#PCons"><span class="hs-identifier hs-type">PCons</span></a></span><span> </span><span id="local-6989586621680012735"><span class="annot"><span class="annottext">Requiring g' (Extend m g f) x y
</span><a href="#local-6989586621680012735"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621680012734"><span class="annot"><span class="annottext">InPairs (Requiring g' (Extend m g f)) (y : zs)
</span><a href="#local-6989586621680012734"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Tails.html#TCons"><span class="hs-identifier hs-type">TCons</span></a></span><span> </span><span class="annot"><span class="annottext">NP (Requiring f' (Retract m g f) x) xs
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680012733"><span class="annot"><span class="annottext">Tails (Requiring f' (Retract m g f)) xs
</span><a href="#local-6989586621680012733"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(-.-&gt;) f' (f -.-&gt; f'') x
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#%3A%2A"><span class="hs-operator hs-type">:*</span></a></span><span> </span><span id="local-6989586621680012732"><span class="annot"><span class="annottext">NP (f' -.-&gt; (f -.-&gt; f'')) xs
</span><a href="#local-6989586621680012732"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#TS"><span class="hs-identifier hs-type">TS</span></a></span><span> </span><span id="local-6989586621680012731"><span class="annot"><span class="annottext">g' x
</span><a href="#local-6989586621680012731"><span class="hs-identifier hs-var">g'x</span></a></span></span><span> </span><span id="local-6989586621680012730"><span class="annot"><span class="annottext">Telescope g' f' xs
</span><a href="#local-6989586621680012730"><span class="hs-identifier hs-var">t'x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#TZ"><span class="hs-identifier hs-type">TZ</span></a></span><span> </span><span id="local-6989586621680012729"><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621680012729"><span class="hs-identifier hs-var">fx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-401"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621680012728"><span class="annot"><span class="annottext">g x
</span><a href="#local-6989586621680012728"><span class="hs-identifier hs-var">gx</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680012727"><span class="annot"><span class="annottext">f y
</span><a href="#local-6989586621680012727"><span class="hs-identifier hs-var">fy</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Extend m g f x y -&gt; f x -&gt; m (g x, f y)
forall (m :: * -&gt; *) k (g :: k -&gt; *) (f :: k -&gt; *) (x :: k)
       (y :: k).
Extend m g f x y -&gt; f x -&gt; m (g x, f y)
</span><a href="Data.SOP.Telescope.html#extendWith"><span class="hs-identifier hs-var hs-var">extendWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Requiring g' (Extend m g f) x y -&gt; g' x -&gt; Extend m g f x y
forall k1 (h :: k1 -&gt; *) k2 (f :: k1 -&gt; k2 -&gt; *) (x :: k1)
       (y :: k2).
Requiring h f x y -&gt; h x -&gt; f x y
</span><a href="Data.SOP.InPairs.html#provide"><span class="hs-identifier hs-var hs-var">provide</span></a></span><span> </span><span class="annot"><span class="annottext">Requiring g' (Extend m g f) x y
</span><a href="#local-6989586621680012735"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">g' x
g' x
</span><a href="#local-6989586621680012731"><span class="hs-identifier hs-var">g'x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">f x
f x
</span><a href="#local-6989586621680012729"><span class="hs-identifier hs-var">fx</span></a></span><span>
</span><span id="line-402"></span><span>        </span><span class="annot"><span class="annottext">g x -&gt; Telescope g f'' (y : zs) -&gt; Telescope g f'' (x : y : zs)
forall a (g :: a -&gt; *) (x :: a) (f :: a -&gt; *) (xs :: [a]).
g x -&gt; Telescope g f xs -&gt; Telescope g f (x : xs)
</span><a href="Data.SOP.Telescope.html#TS"><span class="hs-identifier hs-var">TS</span></a></span><span> </span><span class="annot"><span class="annottext">g x
</span><a href="#local-6989586621680012728"><span class="hs-identifier hs-var">gx</span></a></span><span> </span><span class="annot"><span class="annottext">(Telescope g f'' (y : zs) -&gt; Telescope g f'' (x : y : zs))
-&gt; m (Telescope g f'' (y : zs)) -&gt; m (Telescope g f'' (x : y : zs))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">InPairs (Requiring g' (Extend m g f)) (y : zs)
-&gt; Tails (Requiring f' (Retract m g f)) (y : zs)
-&gt; NP (f' -.-&gt; (f -.-&gt; f'')) (y : zs)
-&gt; Telescope g' f' (y : zs)
-&gt; Telescope g f (y : zs)
-&gt; m (Telescope g f'' (y : zs))
forall (xs' :: [k]).
SListI xs' =&gt;
InPairs (Requiring g' (Extend m g f)) xs'
-&gt; Tails (Requiring f' (Retract m g f)) xs'
-&gt; NP (f' -.-&gt; (f -.-&gt; f'')) xs'
-&gt; Telescope g' f' xs'
-&gt; Telescope g f xs'
-&gt; m (Telescope g f'' xs')
</span><a href="#local-6989586621680012751"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">InPairs (Requiring g' (Extend m g f)) (y : zs)
</span><a href="#local-6989586621680012734"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">Tails (Requiring f' (Retract m g f)) xs
Tails (Requiring f' (Retract m g f)) (y : zs)
</span><a href="#local-6989586621680012733"><span class="hs-identifier hs-var">rs</span></a></span><span> </span><span class="annot"><span class="annottext">NP (f' -.-&gt; (f -.-&gt; f'')) xs
NP (f' -.-&gt; (f -.-&gt; f'')) (y : zs)
</span><a href="#local-6989586621680012732"><span class="hs-identifier hs-var">fs</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope g' f' xs
Telescope g' f' (y : zs)
</span><a href="#local-6989586621680012730"><span class="hs-identifier hs-var">t'x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f y -&gt; Telescope g f (y : zs)
forall a (f :: a -&gt; *) (x :: a) (g :: a -&gt; *) (xs :: [a]).
f x -&gt; Telescope g f (x : xs)
</span><a href="Data.SOP.Telescope.html#TZ"><span class="hs-identifier hs-var">TZ</span></a></span><span> </span><span class="annot"><span class="annottext">f y
</span><a href="#local-6989586621680012727"><span class="hs-identifier hs-var">fy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-403"></span><span>
</span><span id="line-404"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Derived API
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-407"></span><span>
</span><span id="line-408"></span><span class="hs-comment">-- | Version of 'extend' where the evidence is a simple 'Bool'</span><span>
</span><span id="line-409"></span><span id="local-6989586621680012723"><span id="local-6989586621680012724"><span id="local-6989586621680012725"><span id="local-6989586621680012726"><span class="annot"><a href="Data.SOP.Telescope.html#extendIf"><span class="hs-identifier hs-type">extendIf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012726"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-410"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SOP.InPairs.html#InPairs"><span class="hs-identifier hs-type">InPairs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Extend"><span class="hs-identifier hs-type">Extend</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012726"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012725"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012724"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680012723"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-comment">-- ^ How to extend</span><span>
</span><span id="line-411"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#NP"><span class="hs-identifier hs-type">NP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680012724"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">-.-&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">K</span></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680012723"><span class="hs-identifier hs-type">xs</span></a></span><span>     </span><span class="hs-comment">-- ^ Where to extend /from/</span><span>
</span><span id="line-412"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012725"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012724"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012723"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680012726"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012725"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012724"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012723"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-413"></span><span id="extendIf"><span class="annot"><span class="annottext">extendIf :: InPairs (Extend m g f) xs
-&gt; NP (f -.-&gt; K Bool) xs
-&gt; Telescope g f xs
-&gt; m (Telescope g f xs)
</span><a href="Data.SOP.Telescope.html#extendIf"><span class="hs-identifier hs-var hs-var">extendIf</span></a></span></span><span> </span><span id="local-6989586621680012722"><span class="annot"><span class="annottext">InPairs (Extend m g f) xs
</span><a href="#local-6989586621680012722"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span id="local-6989586621680012721"><span class="annot"><span class="annottext">NP (f -.-&gt; K Bool) xs
</span><a href="#local-6989586621680012721"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NP (f -.-&gt; K Bool) xs
-&gt; (SListI xs =&gt; Telescope g f xs -&gt; m (Telescope g f xs))
-&gt; Telescope g f xs
-&gt; m (Telescope g f xs)
forall k (a :: k -&gt; *) (xs :: [k]) r.
NP a xs -&gt; (SListI xs =&gt; r) -&gt; r
</span><a href="Data.SOP.Strict.html#npToSListI"><span class="hs-identifier hs-var">npToSListI</span></a></span><span> </span><span class="annot"><span class="annottext">NP (f -.-&gt; K Bool) xs
</span><a href="#local-6989586621680012721"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">((SListI xs =&gt; Telescope g f xs -&gt; m (Telescope g f xs))
 -&gt; Telescope g f xs -&gt; m (Telescope g f xs))
-&gt; (SListI xs =&gt; Telescope g f xs -&gt; m (Telescope g f xs))
-&gt; Telescope g f xs
-&gt; m (Telescope g f xs)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-414"></span><span>    </span><span class="annot"><span class="annottext">InPairs (Requiring (K ()) (Extend m g f)) xs
-&gt; NP (f -.-&gt; (Maybe :.: K ())) xs
-&gt; Telescope g f xs
-&gt; m (Telescope g f xs)
forall k (m :: * -&gt; *) (h :: k -&gt; *) (g :: k -&gt; *) (f :: k -&gt; *)
       (xs :: [k]).
Monad m =&gt;
InPairs (Requiring h (Extend m g f)) xs
-&gt; NP (f -.-&gt; (Maybe :.: h)) xs
-&gt; Telescope g f xs
-&gt; m (Telescope g f xs)
</span><a href="Data.SOP.Telescope.html#extend"><span class="hs-identifier hs-var">extend</span></a></span><span>
</span><span id="line-415"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall (x :: k) (y :: k).
 Extend m g f x y -&gt; Requiring (K ()) (Extend m g f) x y)
-&gt; InPairs (Extend m g f) xs
-&gt; InPairs (Requiring (K ()) (Extend m g f)) xs
forall k (xs :: [k]) (f :: k -&gt; k -&gt; *) (g :: k -&gt; k -&gt; *).
SListI xs =&gt;
(forall (x :: k) (y :: k). f x y -&gt; g x y)
-&gt; InPairs f xs -&gt; InPairs g xs
</span><a href="Data.SOP.InPairs.html#hmap"><span class="hs-identifier hs-var">InPairs.hmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(K () x -&gt; Extend m g f x y) -&gt; Requiring (K ()) (Extend m g f) x y
forall k1 k2 (h :: k1 -&gt; *) (f :: k1 -&gt; k2 -&gt; *) (x :: k1)
       (y :: k2).
(h x -&gt; f x y) -&gt; Requiring h f x y
</span><a href="Data.SOP.InPairs.html#Require"><span class="hs-identifier hs-var">Require</span></a></span><span> </span><span class="annot"><span class="annottext">((K () x -&gt; Extend m g f x y)
 -&gt; Requiring (K ()) (Extend m g f) x y)
-&gt; (Extend m g f x y -&gt; K () x -&gt; Extend m g f x y)
-&gt; Extend m g f x y
-&gt; Requiring (K ()) (Extend m g f) x y
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Extend m g f x y -&gt; K () x -&gt; Extend m g f x y
forall a b. a -&gt; b -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">const</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">InPairs (Extend m g f) xs
</span><a href="#local-6989586621680012722"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-416"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall (a :: k).
 (-.-&gt;) f (K Bool) a -&gt; (-.-&gt;) f (Maybe :.: K ()) a)
-&gt; NP (f -.-&gt; K Bool) xs -&gt; NP (f -.-&gt; (Maybe :.: K ())) xs
forall k l (h :: (k -&gt; *) -&gt; l -&gt; *) (xs :: l) (f :: k -&gt; *)
       (f' :: k -&gt; *).
(SListIN (Prod h) xs, HAp h) =&gt;
(forall (a :: k). f a -&gt; f' a) -&gt; h f xs -&gt; h f' xs
</span><span class="hs-identifier hs-var">hmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680012717"><span class="annot"><span class="annottext">(-.-&gt;) f (K Bool) a
</span><a href="#local-6989586621680012717"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(f a -&gt; (:.:) Maybe (K ()) a) -&gt; (-.-&gt;) f (Maybe :.: K ()) a
forall k (f :: k -&gt; *) (a :: k) (f' :: k -&gt; *).
(f a -&gt; f' a) -&gt; (-.-&gt;) f f' a
</span><span class="hs-identifier hs-var">fn</span></span><span> </span><span class="annot"><span class="annottext">((f a -&gt; (:.:) Maybe (K ()) a) -&gt; (-.-&gt;) f (Maybe :.: K ()) a)
-&gt; (f a -&gt; (:.:) Maybe (K ()) a) -&gt; (-.-&gt;) f (Maybe :.: K ()) a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">K Bool a -&gt; (:.:) Maybe (K ()) a
forall k (x :: k). K Bool x -&gt; (:.:) Maybe (K ()) x
</span><a href="Data.SOP.Telescope.html#fromBool"><span class="hs-identifier hs-var">fromBool</span></a></span><span> </span><span class="annot"><span class="annottext">(K Bool a -&gt; (:.:) Maybe (K ()) a)
-&gt; (f a -&gt; K Bool a) -&gt; f a -&gt; (:.:) Maybe (K ()) a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(-.-&gt;) f (K Bool) a -&gt; f a -&gt; K Bool a
forall k (f :: k -&gt; *) (g :: k -&gt; *) (a :: k).
(-.-&gt;) f g a -&gt; f a -&gt; g a
</span><span class="hs-identifier hs-var hs-var">apFn</span></span><span> </span><span class="annot"><span class="annottext">(-.-&gt;) f (K Bool) a
</span><a href="#local-6989586621680012717"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NP (f -.-&gt; K Bool) xs
</span><a href="#local-6989586621680012721"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-417"></span><span>
</span><span id="line-418"></span><span class="hs-comment">-- | Version of 'retract' where the evidence is a simple 'Bool'</span><span>
</span><span id="line-419"></span><span id="local-6989586621680012712"><span id="local-6989586621680012713"><span id="local-6989586621680012714"><span id="local-6989586621680012715"><span class="annot"><a href="Data.SOP.Telescope.html#retractIf"><span class="hs-identifier hs-type">retractIf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012715"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-420"></span><span>          </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Tails.html#Tails"><span class="hs-identifier hs-type">Tails</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Retract"><span class="hs-identifier hs-type">Retract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012715"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012714"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012713"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680012712"><span class="hs-identifier hs-type">xs</span></a></span><span>  </span><span class="hs-comment">-- ^ How to retract</span><span>
</span><span id="line-421"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#NP"><span class="hs-identifier hs-type">NP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680012714"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">-.-&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">K</span></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680012712"><span class="hs-identifier hs-type">xs</span></a></span><span>     </span><span class="hs-comment">-- ^ Where to retract /to/</span><span>
</span><span id="line-422"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012714"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012713"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012712"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680012715"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012714"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012713"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012712"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-423"></span><span id="retractIf"><span class="annot"><span class="annottext">retractIf :: Tails (Retract m g f) xs
-&gt; NP (g -.-&gt; K Bool) xs
-&gt; Telescope g f xs
-&gt; m (Telescope g f xs)
</span><a href="Data.SOP.Telescope.html#retractIf"><span class="hs-identifier hs-var hs-var">retractIf</span></a></span></span><span> </span><span id="local-6989586621680012711"><span class="annot"><span class="annottext">Tails (Retract m g f) xs
</span><a href="#local-6989586621680012711"><span class="hs-identifier hs-var">rs</span></a></span></span><span> </span><span id="local-6989586621680012710"><span class="annot"><span class="annottext">NP (g -.-&gt; K Bool) xs
</span><a href="#local-6989586621680012710"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NP (g -.-&gt; K Bool) xs
-&gt; (SListI xs =&gt; Telescope g f xs -&gt; m (Telescope g f xs))
-&gt; Telescope g f xs
-&gt; m (Telescope g f xs)
forall k (a :: k -&gt; *) (xs :: [k]) r.
NP a xs -&gt; (SListI xs =&gt; r) -&gt; r
</span><a href="Data.SOP.Strict.html#npToSListI"><span class="hs-identifier hs-var">npToSListI</span></a></span><span> </span><span class="annot"><span class="annottext">NP (g -.-&gt; K Bool) xs
</span><a href="#local-6989586621680012710"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">((SListI xs =&gt; Telescope g f xs -&gt; m (Telescope g f xs))
 -&gt; Telescope g f xs -&gt; m (Telescope g f xs))
-&gt; (SListI xs =&gt; Telescope g f xs -&gt; m (Telescope g f xs))
-&gt; Telescope g f xs
-&gt; m (Telescope g f xs)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-424"></span><span>    </span><span class="annot"><span class="annottext">Tails (Requiring (K ()) (Retract m g f)) xs
-&gt; NP (g -.-&gt; (Maybe :.: K ())) xs
-&gt; Telescope g f xs
-&gt; m (Telescope g f xs)
forall k (m :: * -&gt; *) (h :: k -&gt; *) (g :: k -&gt; *) (f :: k -&gt; *)
       (xs :: [k]).
Monad m =&gt;
Tails (Requiring h (Retract m g f)) xs
-&gt; NP (g -.-&gt; (Maybe :.: h)) xs
-&gt; Telescope g f xs
-&gt; m (Telescope g f xs)
</span><a href="Data.SOP.Telescope.html#retract"><span class="hs-identifier hs-var">retract</span></a></span><span>
</span><span id="line-425"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall (x :: k) (y :: k).
 Retract m g f x y -&gt; Requiring (K ()) (Retract m g f) x y)
-&gt; Tails (Retract m g f) xs
-&gt; Tails (Requiring (K ()) (Retract m g f)) xs
forall k (xs :: [k]) (f :: k -&gt; k -&gt; *) (g :: k -&gt; k -&gt; *).
SListI xs =&gt;
(forall (x :: k) (y :: k). f x y -&gt; g x y)
-&gt; Tails f xs -&gt; Tails g xs
</span><a href="Data.SOP.Tails.html#hmap"><span class="hs-identifier hs-var">Tails.hmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(K () x -&gt; Retract m g f x y)
-&gt; Requiring (K ()) (Retract m g f) x y
forall k1 k2 (h :: k1 -&gt; *) (f :: k1 -&gt; k2 -&gt; *) (x :: k1)
       (y :: k2).
(h x -&gt; f x y) -&gt; Requiring h f x y
</span><a href="Data.SOP.InPairs.html#Require"><span class="hs-identifier hs-var">Require</span></a></span><span> </span><span class="annot"><span class="annottext">((K () x -&gt; Retract m g f x y)
 -&gt; Requiring (K ()) (Retract m g f) x y)
-&gt; (Retract m g f x y -&gt; K () x -&gt; Retract m g f x y)
-&gt; Retract m g f x y
-&gt; Requiring (K ()) (Retract m g f) x y
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Retract m g f x y -&gt; K () x -&gt; Retract m g f x y
forall a b. a -&gt; b -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">const</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Tails (Retract m g f) xs
</span><a href="#local-6989586621680012711"><span class="hs-identifier hs-var">rs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-426"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall (a :: k).
 (-.-&gt;) g (K Bool) a -&gt; (-.-&gt;) g (Maybe :.: K ()) a)
-&gt; NP (g -.-&gt; K Bool) xs -&gt; NP (g -.-&gt; (Maybe :.: K ())) xs
forall k l (h :: (k -&gt; *) -&gt; l -&gt; *) (xs :: l) (f :: k -&gt; *)
       (f' :: k -&gt; *).
(SListIN (Prod h) xs, HAp h) =&gt;
(forall (a :: k). f a -&gt; f' a) -&gt; h f xs -&gt; h f' xs
</span><span class="hs-identifier hs-var">hmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680012708"><span class="annot"><span class="annottext">(-.-&gt;) g (K Bool) a
</span><a href="#local-6989586621680012708"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(g a -&gt; (:.:) Maybe (K ()) a) -&gt; (-.-&gt;) g (Maybe :.: K ()) a
forall k (f :: k -&gt; *) (a :: k) (f' :: k -&gt; *).
(f a -&gt; f' a) -&gt; (-.-&gt;) f f' a
</span><span class="hs-identifier hs-var">fn</span></span><span> </span><span class="annot"><span class="annottext">((g a -&gt; (:.:) Maybe (K ()) a) -&gt; (-.-&gt;) g (Maybe :.: K ()) a)
-&gt; (g a -&gt; (:.:) Maybe (K ()) a) -&gt; (-.-&gt;) g (Maybe :.: K ()) a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">K Bool a -&gt; (:.:) Maybe (K ()) a
forall k (x :: k). K Bool x -&gt; (:.:) Maybe (K ()) x
</span><a href="Data.SOP.Telescope.html#fromBool"><span class="hs-identifier hs-var">fromBool</span></a></span><span> </span><span class="annot"><span class="annottext">(K Bool a -&gt; (:.:) Maybe (K ()) a)
-&gt; (g a -&gt; K Bool a) -&gt; g a -&gt; (:.:) Maybe (K ()) a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(-.-&gt;) g (K Bool) a -&gt; g a -&gt; K Bool a
forall k (f :: k -&gt; *) (g :: k -&gt; *) (a :: k).
(-.-&gt;) f g a -&gt; f a -&gt; g a
</span><span class="hs-identifier hs-var hs-var">apFn</span></span><span> </span><span class="annot"><span class="annottext">(-.-&gt;) g (K Bool) a
</span><a href="#local-6989586621680012708"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NP (g -.-&gt; K Bool) xs
</span><a href="#local-6989586621680012710"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-427"></span><span>
</span><span id="line-428"></span><span class="hs-comment">-- | Version of 'align' that never retracts, only extends</span><span>
</span><span id="line-429"></span><span class="hs-comment">--</span><span>
</span><span id="line-430"></span><span class="hs-comment">-- PRE: The telescope we are aligning with cannot be behind us.</span><span>
</span><span id="line-431"></span><span id="local-6989586621680013068"><span id="local-6989586621680013069"><span id="local-6989586621680013070"><span id="local-6989586621680013071"><span id="local-6989586621680013072"><span id="local-6989586621680013073"><span id="local-6989586621680013074"><span class="annot"><a href="Data.SOP.Telescope.html#alignExtend"><span class="hs-identifier hs-type">alignExtend</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013074"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-432"></span><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SOP.InPairs.html#InPairs"><span class="hs-identifier hs-type">InPairs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.InPairs.html#Requiring"><span class="hs-identifier hs-type">Requiring</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013073"><span class="hs-identifier hs-type">g'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Extend"><span class="hs-identifier hs-type">Extend</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013074"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013072"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013071"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680013070"><span class="hs-identifier hs-type">xs</span></a></span><span>  </span><span class="hs-comment">-- ^ How to extend</span><span>
</span><span id="line-433"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#NP"><span class="hs-identifier hs-type">NP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680013069"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">-.-&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680013071"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">-.-&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680013068"><span class="hs-identifier hs-type">f''</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680013070"><span class="hs-identifier hs-type">xs</span></a></span><span>  </span><span class="hs-comment">-- ^ Function to apply at the tip</span><span>
</span><span id="line-434"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013073"><span class="hs-identifier hs-type">g'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013069"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013070"><span class="hs-identifier hs-type">xs</span></a></span><span>          </span><span class="hs-comment">-- ^ Telescope we are aligning with</span><span>
</span><span id="line-435"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013072"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013071"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013070"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680013074"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013072"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013068"><span class="hs-identifier hs-type">f''</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013070"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span><span>
</span><span id="line-436"></span><span id="alignExtend"><span class="annot"><span class="annottext">alignExtend :: InPairs (Requiring g' (Extend m g f)) xs
-&gt; NP (f' -.-&gt; (f -.-&gt; f'')) xs
-&gt; Telescope g' f' xs
-&gt; Telescope g f xs
-&gt; m (Telescope g f'' xs)
</span><a href="Data.SOP.Telescope.html#alignExtend"><span class="hs-identifier hs-var hs-var">alignExtend</span></a></span></span><span> </span><span id="local-6989586621680012707"><span class="annot"><span class="annottext">InPairs (Requiring g' (Extend m g f)) xs
</span><a href="#local-6989586621680012707"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span id="local-6989586621680012706"><span class="annot"><span class="annottext">NP (f' -.-&gt; (f -.-&gt; f'')) xs
</span><a href="#local-6989586621680012706"><span class="hs-identifier hs-var">atTip</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NP (f' -.-&gt; (f -.-&gt; f'')) xs
-&gt; (SListI xs =&gt;
    Telescope g' f' xs -&gt; Telescope g f xs -&gt; m (Telescope g f'' xs))
-&gt; Telescope g' f' xs
-&gt; Telescope g f xs
-&gt; m (Telescope g f'' xs)
forall k (a :: k -&gt; *) (xs :: [k]) r.
NP a xs -&gt; (SListI xs =&gt; r) -&gt; r
</span><a href="Data.SOP.Strict.html#npToSListI"><span class="hs-identifier hs-var">npToSListI</span></a></span><span> </span><span class="annot"><span class="annottext">NP (f' -.-&gt; (f -.-&gt; f'')) xs
</span><a href="#local-6989586621680012706"><span class="hs-identifier hs-var">atTip</span></a></span><span> </span><span class="annot"><span class="annottext">((SListI xs =&gt;
  Telescope g' f' xs -&gt; Telescope g f xs -&gt; m (Telescope g f'' xs))
 -&gt; Telescope g' f' xs
 -&gt; Telescope g f xs
 -&gt; m (Telescope g f'' xs))
-&gt; (SListI xs =&gt;
    Telescope g' f' xs -&gt; Telescope g f xs -&gt; m (Telescope g f'' xs))
-&gt; Telescope g' f' xs
-&gt; Telescope g f xs
-&gt; m (Telescope g f'' xs)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-437"></span><span>    </span><span class="annot"><span class="annottext">InPairs (Requiring g' (Extend m g f)) xs
-&gt; Tails (Requiring f' (Retract m g f)) xs
-&gt; NP (f' -.-&gt; (f -.-&gt; f'')) xs
-&gt; Telescope g' f' xs
-&gt; Telescope g f xs
-&gt; m (Telescope g f'' xs)
forall k (m :: * -&gt; *) (g' :: k -&gt; *) (g :: k -&gt; *) (f' :: k -&gt; *)
       (f :: k -&gt; *) (f'' :: k -&gt; *) (xs :: [k]).
Monad m =&gt;
InPairs (Requiring g' (Extend m g f)) xs
-&gt; Tails (Requiring f' (Retract m g f)) xs
-&gt; NP (f' -.-&gt; (f -.-&gt; f'')) xs
-&gt; Telescope g' f' xs
-&gt; Telescope g f xs
-&gt; m (Telescope g f'' xs)
</span><a href="Data.SOP.Telescope.html#align"><span class="hs-identifier hs-var">align</span></a></span><span> </span><span class="annot"><span class="annottext">InPairs (Requiring g' (Extend m g f)) xs
</span><a href="#local-6989586621680012707"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall (x :: k) (y :: k). Requiring f' (Retract m g f) x y)
-&gt; Tails (Requiring f' (Retract m g f)) xs
forall k (xs :: [k]) (f :: k -&gt; k -&gt; *).
SListI xs =&gt;
(forall (x :: k) (y :: k). f x y) -&gt; Tails f xs
</span><a href="Data.SOP.Tails.html#hpure"><span class="hs-identifier hs-var">Tails.hpure</span></a></span><span> </span><span class="annot"><span class="annottext">((forall (x :: k) (y :: k). Requiring f' (Retract m g f) x y)
 -&gt; Tails (Requiring f' (Retract m g f)) xs)
-&gt; (forall (x :: k) (y :: k). Requiring f' (Retract m g f) x y)
-&gt; Tails (Requiring f' (Retract m g f)) xs
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(f' x -&gt; Retract m g f x y) -&gt; Requiring f' (Retract m g f) x y
forall k1 k2 (h :: k1 -&gt; *) (f :: k1 -&gt; k2 -&gt; *) (x :: k1)
       (y :: k2).
(h x -&gt; f x y) -&gt; Requiring h f x y
</span><a href="Data.SOP.InPairs.html#Require"><span class="hs-identifier hs-var">Require</span></a></span><span> </span><span class="annot"><span class="annottext">((f' x -&gt; Retract m g f x y) -&gt; Requiring f' (Retract m g f) x y)
-&gt; (f' x -&gt; Retract m g f x y) -&gt; Requiring f' (Retract m g f) x y
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">f' x
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Retract m g f x y
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680012703"><span class="hs-identifier hs-var">precondition</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NP (f' -.-&gt; (f -.-&gt; f'')) xs
</span><a href="#local-6989586621680012706"><span class="hs-identifier hs-var">atTip</span></a></span><span>
</span><span id="line-438"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-439"></span><span>    </span><span class="annot"><a href="#local-6989586621680012703"><span class="hs-identifier hs-type">precondition</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">String</span></a></span><span>
</span><span id="line-440"></span><span>    </span><span id="local-6989586621680012703"><span class="annot"><span class="annottext">precondition :: [Char]
</span><a href="#local-6989586621680012703"><span class="hs-identifier hs-var hs-var">precondition</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;alignExtend: precondition violated&quot;</span></span><span>
</span><span id="line-441"></span><span>
</span><span id="line-442"></span><span class="hs-comment">-- | Version of 'alignExtend' that extends with an NS instead</span><span>
</span><span id="line-443"></span><span id="local-6989586621680012696"><span id="local-6989586621680012697"><span id="local-6989586621680012698"><span id="local-6989586621680012699"><span id="local-6989586621680012700"><span id="local-6989586621680012701"><span class="annot"><a href="Data.SOP.Telescope.html#alignExtendNS"><span class="hs-identifier hs-type">alignExtendNS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012701"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-444"></span><span>              </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SOP.InPairs.html#InPairs"><span class="hs-identifier hs-type">InPairs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Extend"><span class="hs-identifier hs-type">Extend</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012701"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012700"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012699"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680012698"><span class="hs-identifier hs-type">xs</span></a></span><span>   </span><span class="hs-comment">-- ^ How to extend</span><span>
</span><span id="line-445"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#NP"><span class="hs-identifier hs-type">NP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680012697"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">-.-&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680012699"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">-.-&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680012696"><span class="hs-identifier hs-type">f''</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680012698"><span class="hs-identifier hs-type">xs</span></a></span><span>  </span><span class="hs-comment">-- ^ Function to apply at the tip</span><span>
</span><span id="line-446"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Strict.html#NS"><span class="hs-identifier hs-type">NS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012697"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012698"><span class="hs-identifier hs-type">xs</span></a></span><span>                    </span><span class="hs-comment">-- ^ NS we are aligning with</span><span>
</span><span id="line-447"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012700"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012699"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012698"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680012701"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012700"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012696"><span class="hs-identifier hs-type">f''</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012698"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-448"></span><span id="alignExtendNS"><span class="annot"><span class="annottext">alignExtendNS :: InPairs (Extend m g f) xs
-&gt; NP (f' -.-&gt; (f -.-&gt; f'')) xs
-&gt; NS f' xs
-&gt; Telescope g f xs
-&gt; m (Telescope g f'' xs)
</span><a href="Data.SOP.Telescope.html#alignExtendNS"><span class="hs-identifier hs-var hs-var">alignExtendNS</span></a></span></span><span> </span><span id="local-6989586621680012695"><span class="annot"><span class="annottext">InPairs (Extend m g f) xs
</span><a href="#local-6989586621680012695"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span id="local-6989586621680012694"><span class="annot"><span class="annottext">NP (f' -.-&gt; (f -.-&gt; f'')) xs
</span><a href="#local-6989586621680012694"><span class="hs-identifier hs-var">atTip</span></a></span></span><span> </span><span id="local-6989586621680012693"><span class="annot"><span class="annottext">NS f' xs
</span><a href="#local-6989586621680012693"><span class="hs-identifier hs-var">ns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NP (f' -.-&gt; (f -.-&gt; f'')) xs
-&gt; (SListI xs =&gt; Telescope g f xs -&gt; m (Telescope g f'' xs))
-&gt; Telescope g f xs
-&gt; m (Telescope g f'' xs)
forall k (a :: k -&gt; *) (xs :: [k]) r.
NP a xs -&gt; (SListI xs =&gt; r) -&gt; r
</span><a href="Data.SOP.Strict.html#npToSListI"><span class="hs-identifier hs-var">npToSListI</span></a></span><span> </span><span class="annot"><span class="annottext">NP (f' -.-&gt; (f -.-&gt; f'')) xs
</span><a href="#local-6989586621680012694"><span class="hs-identifier hs-var">atTip</span></a></span><span> </span><span class="annot"><span class="annottext">((SListI xs =&gt; Telescope g f xs -&gt; m (Telescope g f'' xs))
 -&gt; Telescope g f xs -&gt; m (Telescope g f'' xs))
-&gt; (SListI xs =&gt; Telescope g f xs -&gt; m (Telescope g f'' xs))
-&gt; Telescope g f xs
-&gt; m (Telescope g f'' xs)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-449"></span><span>   </span><span class="annot"><span class="annottext">InPairs (Requiring (K ()) (Extend m g f)) xs
-&gt; NP (f' -.-&gt; (f -.-&gt; f'')) xs
-&gt; Telescope (K ()) f' xs
-&gt; Telescope g f xs
-&gt; m (Telescope g f'' xs)
forall k (m :: * -&gt; *) (g' :: k -&gt; *) (g :: k -&gt; *) (f :: k -&gt; *)
       (xs :: [k]) (f' :: k -&gt; *) (f'' :: k -&gt; *).
(Monad m, HasCallStack) =&gt;
InPairs (Requiring g' (Extend m g f)) xs
-&gt; NP (f' -.-&gt; (f -.-&gt; f'')) xs
-&gt; Telescope g' f' xs
-&gt; Telescope g f xs
-&gt; m (Telescope g f'' xs)
</span><a href="Data.SOP.Telescope.html#alignExtend"><span class="hs-identifier hs-var">alignExtend</span></a></span><span>
</span><span id="line-450"></span><span>     </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall (x :: k) (y :: k).
 Extend m g f x y -&gt; Requiring (K ()) (Extend m g f) x y)
-&gt; InPairs (Extend m g f) xs
-&gt; InPairs (Requiring (K ()) (Extend m g f)) xs
forall k (xs :: [k]) (f :: k -&gt; k -&gt; *) (g :: k -&gt; k -&gt; *).
SListI xs =&gt;
(forall (x :: k) (y :: k). f x y -&gt; g x y)
-&gt; InPairs f xs -&gt; InPairs g xs
</span><a href="Data.SOP.InPairs.html#hmap"><span class="hs-identifier hs-var">InPairs.hmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(K () x -&gt; Extend m g f x y) -&gt; Requiring (K ()) (Extend m g f) x y
forall k1 k2 (h :: k1 -&gt; *) (f :: k1 -&gt; k2 -&gt; *) (x :: k1)
       (y :: k2).
(h x -&gt; f x y) -&gt; Requiring h f x y
</span><a href="Data.SOP.InPairs.html#Require"><span class="hs-identifier hs-var">Require</span></a></span><span> </span><span class="annot"><span class="annottext">((K () x -&gt; Extend m g f x y)
 -&gt; Requiring (K ()) (Extend m g f) x y)
-&gt; (Extend m g f x y -&gt; K () x -&gt; Extend m g f x y)
-&gt; Extend m g f x y
-&gt; Requiring (K ()) (Extend m g f) x y
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Extend m g f x y -&gt; K () x -&gt; Extend m g f x y
forall a b. a -&gt; b -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">const</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">InPairs (Extend m g f) xs
</span><a href="#local-6989586621680012695"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-451"></span><span>     </span><span class="annot"><span class="annottext">NP (f' -.-&gt; (f -.-&gt; f'')) xs
</span><a href="#local-6989586621680012694"><span class="hs-identifier hs-var">atTip</span></a></span><span>
</span><span id="line-452"></span><span>     </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NS f' xs -&gt; Telescope (K ()) f' xs
forall k (f :: k -&gt; *) (xs :: [k]).
NS f xs -&gt; Telescope (K ()) f xs
</span><a href="Data.SOP.Telescope.html#fromTip"><span class="hs-identifier hs-var">fromTip</span></a></span><span> </span><span class="annot"><span class="annottext">NS f' xs
</span><a href="#local-6989586621680012693"><span class="hs-identifier hs-var">ns</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-453"></span><span>
</span><span id="line-454"></span><span class="hs-comment">-- | Internal auxiliary to 'extendIf' and 'retractIf'</span><span>
</span><span id="line-455"></span><span id="local-6989586621680013129"><span class="annot"><a href="Data.SOP.Telescope.html#fromBool"><span class="hs-identifier hs-type">fromBool</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">K</span></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013129"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:.:</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">K</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680013129"><span class="hs-identifier hs-type">x</span></a></span></span><span>
</span><span id="line-456"></span><span id="fromBool"><span class="annot"><span class="annottext">fromBool :: K Bool x -&gt; (:.:) Maybe (K ()) x
</span><a href="Data.SOP.Telescope.html#fromBool"><span class="hs-identifier hs-var hs-var">fromBool</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">K</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">True</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (K () x) -&gt; (:.:) Maybe (K ()) x
forall l k (f :: l -&gt; *) (g :: k -&gt; l) (p :: k).
f (g p) -&gt; (:.:) f g p
</span><span class="hs-identifier hs-var">Comp</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (K () x) -&gt; (:.:) Maybe (K ()) x)
-&gt; Maybe (K () x) -&gt; (:.:) Maybe (K ()) x
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">K () x -&gt; Maybe (K () x)
forall a. a -&gt; Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">(K () x -&gt; Maybe (K () x)) -&gt; K () x -&gt; Maybe (K () x)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">() -&gt; K () x
forall k a (b :: k). a -&gt; K a b
</span><span class="hs-identifier hs-var">K</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-457"></span><span class="annot"><a href="Data.SOP.Telescope.html#fromBool"><span class="hs-identifier hs-var">fromBool</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">K</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">False</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (K () x) -&gt; (:.:) Maybe (K ()) x
forall l k (f :: l -&gt; *) (g :: k -&gt; l) (p :: k).
f (g p) -&gt; (:.:) f g p
</span><span class="hs-identifier hs-var">Comp</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (K () x) -&gt; (:.:) Maybe (K ()) x)
-&gt; Maybe (K () x) -&gt; (:.:) Maybe (K ()) x
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (K () x)
forall a. Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-458"></span><span>
</span><span id="line-459"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Additional API
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-462"></span><span>
</span><span id="line-463"></span><span class="hs-keyword">newtype</span><span> </span><span id="ScanNext"><span class="annot"><a href="Data.SOP.Telescope.html#ScanNext"><span class="hs-identifier hs-var">ScanNext</span></a></span></span><span> </span><span id="local-6989586621680013027"><span class="annot"><a href="#local-6989586621680013027"><span class="hs-identifier hs-type">h</span></a></span></span><span> </span><span id="local-6989586621680013026"><span class="annot"><a href="#local-6989586621680013026"><span class="hs-identifier hs-type">g</span></a></span></span><span> </span><span id="local-6989586621680013025"><span class="annot"><a href="#local-6989586621680013025"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span id="local-6989586621680013024"><span class="annot"><a href="#local-6989586621680013024"><span class="hs-identifier hs-type">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ScanNext"><span class="annot"><a href="Data.SOP.Telescope.html#ScanNext"><span class="hs-identifier hs-var">ScanNext</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="getNext"><span class="annot"><span class="annottext">ScanNext h g x y -&gt; h x -&gt; g x -&gt; h y
</span><a href="Data.SOP.Telescope.html#getNext"><span class="hs-identifier hs-var hs-var">getNext</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621680013027"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013025"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680013026"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013025"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680013027"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013024"><span class="hs-identifier hs-type">y</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-464"></span><span>
</span><span id="line-465"></span><span class="hs-comment">-- | Telescope analogue of 'scanl' on lists</span><span>
</span><span id="line-466"></span><span class="hs-comment">--</span><span>
</span><span id="line-467"></span><span class="hs-comment">-- This function is modelled on</span><span>
</span><span id="line-468"></span><span class="hs-comment">--</span><span>
</span><span id="line-469"></span><span class="hs-comment">-- &gt; scanl :: (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; [b]</span><span>
</span><span id="line-470"></span><span class="hs-comment">--</span><span>
</span><span id="line-471"></span><span class="hs-comment">-- but there are a few differences:</span><span>
</span><span id="line-472"></span><span class="hs-comment">--</span><span>
</span><span id="line-473"></span><span class="hs-comment">-- * Since every seed has a different type, we must be given a function</span><span>
</span><span id="line-474"></span><span class="hs-comment">--   for each transition.</span><span>
</span><span id="line-475"></span><span class="hs-comment">-- * Unlike 'scanl', we preserve the length of the telescope</span><span>
</span><span id="line-476"></span><span class="hs-comment">--   ('scanl' prepends the initial seed)</span><span>
</span><span id="line-477"></span><span class="hs-comment">-- * Instead of generating a telescope containing only the seeds, we</span><span>
</span><span id="line-478"></span><span class="hs-comment">--   instead pair the seeds with the elements.</span><span>
</span><span id="line-479"></span><span id="local-6989586621680012686"><span id="local-6989586621680012687"><span id="local-6989586621680012688"><span id="local-6989586621680012689"><span id="local-6989586621680012690"><span class="annot"><a href="Data.SOP.Telescope.html#scanl"><span class="hs-identifier hs-type">scanl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.SOP.InPairs.html#InPairs"><span class="hs-identifier hs-type">InPairs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#ScanNext"><span class="hs-identifier hs-type">ScanNext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012690"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012689"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680012688"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621680012687"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-480"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680012690"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012688"><span class="hs-identifier hs-type">x</span></a></span><span>
</span><span id="line-481"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012689"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012686"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680012688"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621680012687"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-482"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Product</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012690"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012689"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Product</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012690"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012686"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680012688"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621680012687"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-483"></span><span id="scanl"><span class="annot"><span class="annottext">scanl :: InPairs (ScanNext h g) (x : xs)
-&gt; h x
-&gt; Telescope g f (x : xs)
-&gt; Telescope (Product h g) (Product h f) (x : xs)
</span><a href="Data.SOP.Telescope.html#scanl"><span class="hs-identifier hs-var hs-var">scanl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InPairs (ScanNext h g) (x : xs)
-&gt; h x
-&gt; Telescope g f (x : xs)
-&gt; Telescope (Product h g) (Product h f) (x : xs)
forall a (h :: a -&gt; *) (g :: a -&gt; *) (x' :: a) (xs' :: [a])
       (f :: a -&gt; *).
InPairs (ScanNext h g) (x' : xs')
-&gt; h x'
-&gt; Telescope g f (x' : xs')
-&gt; Telescope (Product h g) (Product h f) (x' : xs')
</span><a href="#local-6989586621680012685"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-484"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-485"></span><span>    </span><span id="local-6989586621680013045"><span id="local-6989586621680013046"><span id="local-6989586621680013047"><span id="local-6989586621680013048"><span id="local-6989586621680013049"><span class="annot"><a href="#local-6989586621680012685"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.SOP.InPairs.html#InPairs"><span class="hs-identifier hs-type">InPairs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#ScanNext"><span class="hs-identifier hs-type">ScanNext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013049"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013048"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680013047"><span class="hs-identifier hs-type">x'</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621680013046"><span class="hs-identifier hs-type">xs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-486"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680013049"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013047"><span class="hs-identifier hs-type">x'</span></a></span><span>
</span><span id="line-487"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013048"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013045"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680013047"><span class="hs-identifier hs-type">x'</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621680013046"><span class="hs-identifier hs-type">xs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-488"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Product</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013049"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013048"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Product</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013049"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680013045"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680013047"><span class="hs-identifier hs-type">x'</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621680013046"><span class="hs-identifier hs-type">xs'</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-489"></span><span>    </span><span id="local-6989586621680012685"><span class="annot"><span class="annottext">go :: InPairs (ScanNext h g) (x' : xs')
-&gt; h x'
-&gt; Telescope g f (x' : xs')
-&gt; Telescope (Product h g) (Product h f) (x' : xs')
</span><a href="#local-6989586621680012685"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><span class="annottext">InPairs (ScanNext h g) (x' : xs')
</span><span class="hs-identifier">_</span></span><span>            </span><span id="local-6989586621680012684"><span class="annot"><span class="annottext">h x'
</span><a href="#local-6989586621680012684"><span class="hs-identifier hs-var">hx</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#TZ"><span class="hs-identifier hs-type">TZ</span></a></span><span> </span><span id="local-6989586621680012683"><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621680012683"><span class="hs-identifier hs-var">fx</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Product h f x' -&gt; Telescope (Product h g) (Product h f) (x' : xs')
forall a (f :: a -&gt; *) (x :: a) (g :: a -&gt; *) (xs :: [a]).
f x -&gt; Telescope g f (x : xs)
</span><a href="Data.SOP.Telescope.html#TZ"><span class="hs-identifier hs-var">TZ</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">h x' -&gt; f x' -&gt; Product h f x'
forall k (f :: k -&gt; *) (g :: k -&gt; *) (a :: k).
f a -&gt; g a -&gt; Product f g a
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Pair</span></a></span><span> </span><span class="annot"><span class="annottext">h x'
</span><a href="#local-6989586621680012684"><span class="hs-identifier hs-var">hx</span></a></span><span> </span><span class="annot"><span class="annottext">f x'
f x
</span><a href="#local-6989586621680012683"><span class="hs-identifier hs-var">fx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-490"></span><span>    </span><span class="annot"><a href="#local-6989586621680012685"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.InPairs.html#PCons"><span class="hs-identifier hs-type">PCons</span></a></span><span> </span><span id="local-6989586621680012681"><span class="annot"><span class="annottext">ScanNext h g x y
</span><a href="#local-6989586621680012681"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680012680"><span class="annot"><span class="annottext">InPairs (ScanNext h g) (y : zs)
</span><a href="#local-6989586621680012680"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680012679"><span class="annot"><span class="annottext">h x'
</span><a href="#local-6989586621680012679"><span class="hs-identifier hs-var">hx</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#TS"><span class="hs-identifier hs-type">TS</span></a></span><span> </span><span id="local-6989586621680012678"><span class="annot"><span class="annottext">g x
</span><a href="#local-6989586621680012678"><span class="hs-identifier hs-var">gx</span></a></span></span><span> </span><span id="local-6989586621680012677"><span class="annot"><span class="annottext">Telescope g f xs
</span><a href="#local-6989586621680012677"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Product h g x'
-&gt; Telescope (Product h g) (Product h f) (y : zs)
-&gt; Telescope (Product h g) (Product h f) (x' : y : zs)
forall a (g :: a -&gt; *) (x :: a) (f :: a -&gt; *) (xs :: [a]).
g x -&gt; Telescope g f xs -&gt; Telescope g f (x : xs)
</span><a href="Data.SOP.Telescope.html#TS"><span class="hs-identifier hs-var">TS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">h x' -&gt; g x' -&gt; Product h g x'
forall k (f :: k -&gt; *) (g :: k -&gt; *) (a :: k).
f a -&gt; g a -&gt; Product f g a
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Pair</span></a></span><span> </span><span class="annot"><span class="annottext">h x'
</span><a href="#local-6989586621680012679"><span class="hs-identifier hs-var">hx</span></a></span><span> </span><span class="annot"><span class="annottext">g x'
g x
</span><a href="#local-6989586621680012678"><span class="hs-identifier hs-var">gx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Telescope (Product h g) (Product h f) (y : zs)
 -&gt; Telescope (Product h g) (Product h f) (x' : y : zs))
-&gt; Telescope (Product h g) (Product h f) (y : zs)
-&gt; Telescope (Product h g) (Product h f) (x' : y : zs)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">InPairs (ScanNext h g) (y : zs)
-&gt; h y
-&gt; Telescope g f (y : zs)
-&gt; Telescope (Product h g) (Product h f) (y : zs)
forall a (h :: a -&gt; *) (g :: a -&gt; *) (x' :: a) (xs' :: [a])
       (f :: a -&gt; *).
InPairs (ScanNext h g) (x' : xs')
-&gt; h x'
-&gt; Telescope g f (x' : xs')
-&gt; Telescope (Product h g) (Product h f) (x' : xs')
</span><a href="#local-6989586621680012685"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">InPairs (ScanNext h g) (y : zs)
</span><a href="#local-6989586621680012680"><span class="hs-identifier hs-var">fs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ScanNext h g x y -&gt; h x -&gt; g x -&gt; h y
forall k (h :: k -&gt; *) (g :: k -&gt; *) (x :: k) (y :: k).
ScanNext h g x y -&gt; h x -&gt; g x -&gt; h y
</span><a href="Data.SOP.Telescope.html#getNext"><span class="hs-identifier hs-var hs-var">getNext</span></a></span><span> </span><span class="annot"><span class="annottext">ScanNext h g x y
</span><a href="#local-6989586621680012681"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">h x'
h x
</span><a href="#local-6989586621680012679"><span class="hs-identifier hs-var">hx</span></a></span><span> </span><span class="annot"><span class="annottext">g x
g x
</span><a href="#local-6989586621680012678"><span class="hs-identifier hs-var">gx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Telescope g f xs
Telescope g f (y : zs)
</span><a href="#local-6989586621680012677"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-491"></span><span>
</span><span id="line-492"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Standard type class instances
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-495"></span><span>
</span><span id="line-496"></span><span id="local-6989586621680012670"><span id="local-6989586621680012672"><span id="local-6989586621680012674"><span id="local-6989586621680012675"><span id="local-6989586621680012676"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">All</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Compose</span></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012676"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680012675"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-497"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">All</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Compose</span></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012674"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680012675"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-498"></span><span>                  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012676"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012674"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012675"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-499"></span><span>
</span><span id="line-500"></span><span id="local-6989586621680012651"><span id="local-6989586621680012653"><span id="local-6989586621680012655"><span id="local-6989586621680012657"><span id="local-6989586621680012659"><span id="local-6989586621680012661"><span id="local-6989586621680012663"><span id="local-6989586621680012666"><span id="local-6989586621680012667"><span id="local-6989586621680012668"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">All</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Compose</span></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Eq</span></a></span><span>  </span><span class="annot"><a href="#local-6989586621680012668"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680012667"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-501"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">All</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Compose</span></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012668"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680012667"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-502"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">All</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Compose</span></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Eq</span></a></span><span>  </span><span class="annot"><a href="#local-6989586621680012666"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680012667"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-503"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">All</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Compose</span></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012666"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680012667"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-504"></span><span>                  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012668"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012666"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012667"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-505"></span><span>
</span><span id="line-506"></span><span id="local-6989586621680012641"><span id="local-6989586621680012643"><span id="local-6989586621680012645"><span id="local-6989586621680012647"><span id="local-6989586621680012648"><span id="local-6989586621680012649"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">All</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Compose</span></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012649"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680012648"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-507"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">All</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Compose</span></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012647"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680012648"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-508"></span><span>                  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012649"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012647"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012648"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-509"></span><span>
</span><span id="line-510"></span><span id="local-6989586621680012637"><span id="local-6989586621680012638"><span id="local-6989586621680012639"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680012635"><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">All</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Compose</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">NoThunks</span></span><span> </span><span class="annot"><a href="#local-6989586621680012639"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680012638"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-511"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">All</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Compose</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">NoThunks</span></span><span> </span><span class="annot"><a href="#local-6989586621680012637"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680012638"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-512"></span><span>         </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NoThunks</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012639"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012637"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680012638"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-513"></span><span>  </span><span id="local-6989586621680012631"><span class="annot"><span class="annottext">showTypeOf :: Proxy (Telescope g f xs) -&gt; [Char]
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">showTypeOf</span></span></span><span> </span><span class="annot"><span class="annottext">Proxy (Telescope g f xs)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Telescope&quot;</span></span><span>
</span><span id="line-514"></span><span>  </span><span id="local-6989586621680012629"><span class="annot"><span class="annottext">wNoThunks :: Context -&gt; Telescope g f xs -&gt; IO (Maybe ThunkInfo)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">wNoThunks</span></span></span><span> </span><span id="local-6989586621680012627"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621680012627"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-515"></span><span>      </span><span class="annot"><a href="Data.SOP.Telescope.html#TZ"><span class="hs-identifier hs-type">TZ</span></a></span><span> </span><span id="local-6989586621680012626"><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621680012626"><span class="hs-identifier hs-var">f</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Context -&gt; f x -&gt; IO (Maybe ThunkInfo)
forall a. NoThunks a =&gt; Context -&gt; a -&gt; IO (Maybe ThunkInfo)
</span><span class="hs-identifier hs-var">noThunks</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;TZ&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Context -&gt; Context
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621680012627"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621680012626"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-516"></span><span>      </span><span class="annot"><a href="Data.SOP.Telescope.html#TS"><span class="hs-identifier hs-type">TS</span></a></span><span> </span><span id="local-6989586621680012624"><span class="annot"><span class="annottext">g x
</span><a href="#local-6989586621680012624"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621680012623"><span class="annot"><span class="annottext">Telescope g f xs
</span><a href="#local-6989586621680012623"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[IO (Maybe ThunkInfo)] -&gt; IO (Maybe ThunkInfo)
</span><span class="hs-identifier hs-var">allNoThunks</span></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-517"></span><span>                   </span><span class="annot"><span class="annottext">Context -&gt; g x -&gt; IO (Maybe ThunkInfo)
forall a. NoThunks a =&gt; Context -&gt; a -&gt; IO (Maybe ThunkInfo)
</span><span class="hs-identifier hs-var">noThunks</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;g&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Context -&gt; Context
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;TS&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Context -&gt; Context
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621680012627"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">g x
</span><a href="#local-6989586621680012624"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-518"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Context -&gt; Telescope g f xs -&gt; IO (Maybe ThunkInfo)
forall a. NoThunks a =&gt; Context -&gt; a -&gt; IO (Maybe ThunkInfo)
</span><span class="hs-identifier hs-var">noThunks</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;t&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Context -&gt; Context
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;TS&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Context -&gt; Context
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621680012627"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Telescope g f xs
</span><a href="#local-6989586621680012623"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-519"></span><span>                 </span><span class="hs-special">]</span></span></span></span><span>
</span><span id="line-520"></span></pre></body></html>