<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Test.Util.QSM</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-4"></span><span>    </span><span class="annot"><a href="Test.Util.QSM.html#Example"><span class="hs-identifier">Example</span></a></span><span>
</span><span id="line-5"></span><span>    </span><span class="hs-comment">-- opaque</span><span>
</span><span id="line-6"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Util.QSM.html#example"><span class="hs-identifier">example</span></a></span><span>
</span><span id="line-7"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Util.QSM.html#run"><span class="hs-identifier">run</span></a></span><span>
</span><span id="line-8"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Util.QSM.html#run%27"><span class="hs-identifier">run'</span></a></span><span>
</span><span id="line-9"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-10"></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Control.Monad</span></a></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Control.Monad.Fail</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Fail</span></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Typeable</span></a></span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Test.StateMachine.Logic</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Logic</span></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Test.StateMachine.Sequential</span></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Test.StateMachine.Types</span></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Test.StateMachine.Types.Rank2</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Rank2</span></span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span class="hs-keyword">data</span><span> </span><span id="Example"><span class="annot"><a href="Test.Util.QSM.html#Example"><span class="hs-identifier hs-var">Example</span></a></span></span><span> </span><span id="local-6989586621679325363"><span class="annot"><a href="#local-6989586621679325363"><span class="hs-identifier hs-type">cmd</span></a></span></span><span> </span><span id="local-6989586621679325362"><span class="annot"><a href="#local-6989586621679325362"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-21"></span><span>    </span><span id="Done"><span class="annot"><a href="Test.Util.QSM.html#Done"><span class="hs-identifier hs-var">Done</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679325362"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-22"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Run"><span class="annot"><a href="Test.Util.QSM.html#Run"><span class="hs-identifier hs-var">Run</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679325363"><span class="hs-identifier hs-type">cmd</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbolic</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Var</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Util.QSM.html#Example"><span class="hs-identifier hs-type">Example</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679325363"><span class="hs-identifier hs-type">cmd</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679325362"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Fail"><span class="annot"><a href="Test.Util.QSM.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">String</span></a></span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span id="local-6989586621679325278"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679325275"><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Functor</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Util.QSM.html#Example"><span class="hs-identifier hs-type">Example</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679325278"><span class="hs-identifier hs-type">cmd</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-26"></span><span>  </span><span id="local-6989586621679325273"><span class="annot"><span class="annottext">fmap :: (a -&gt; b) -&gt; Example cmd a -&gt; Example cmd b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">fmap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; Example cmd a -&gt; Example cmd b
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftM</span></a></span></span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span id="local-6989586621679325271"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679325262"><span id="local-6989586621679325264"><span id="local-6989586621679325266"><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Applicative</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Util.QSM.html#Example"><span class="hs-identifier hs-type">Example</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679325271"><span class="hs-identifier hs-type">cmd</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-29"></span><span>  </span><span id="local-6989586621679325260"><span class="annot"><span class="annottext">pure :: a -&gt; Example cmd a
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">pure</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Example cmd a
forall (cmd :: (* -&gt; *) -&gt; *) a. a -&gt; Example cmd a
</span><a href="Test.Util.QSM.html#Done"><span class="hs-identifier hs-var">Done</span></a></span><span>
</span><span id="line-30"></span><span>  </span><span id="local-6989586621679325259"><span class="annot"><span class="annottext">&lt;*&gt; :: Example cmd (a -&gt; b) -&gt; Example cmd a -&gt; Example cmd b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var hs-var hs-var hs-var">(&lt;*&gt;)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Example cmd (a -&gt; b) -&gt; Example cmd a -&gt; Example cmd b
forall (m :: * -&gt; *) a b. Monad m =&gt; m (a -&gt; b) -&gt; m a -&gt; m b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">ap</span></a></span></span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span id="local-6989586621679325257"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679325253"><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Util.QSM.html#Example"><span class="hs-identifier hs-type">Example</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679325257"><span class="hs-identifier hs-type">cmd</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-33"></span><span>  </span><span id="local-6989586621679325250"><span class="annot"><span class="annottext">return :: a -&gt; Example cmd a
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">return</span></a></span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Example cmd a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-34"></span><span>  </span><span class="annot"><a href="Test.Util.QSM.html#Done"><span class="hs-identifier hs-type">Done</span></a></span><span> </span><span id="local-6989586621679325249"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679325249"><span class="hs-identifier hs-var">a</span></a></span></span><span>   </span><span id="local-6989586621679325248"><span class="annot"><span class="annottext">&gt;&gt;= :: Example cmd a -&gt; (a -&gt; Example cmd b) -&gt; Example cmd b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var hs-var hs-var hs-var">&gt;&gt;=</span></a></span></span><span> </span><span id="local-6989586621679325247"><span class="annot"><span class="annottext">a -&gt; Example cmd b
</span><a href="#local-6989586621679325247"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Example cmd b
</span><a href="#local-6989586621679325247"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679325249"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-35"></span><span>  </span><span class="annot"><a href="Test.Util.QSM.html#Run"><span class="hs-identifier hs-type">Run</span></a></span><span> </span><span id="local-6989586621679325246"><span class="annot"><span class="annottext">cmd Symbolic
</span><a href="#local-6989586621679325246"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679325245"><span class="annot"><span class="annottext">[Var] -&gt; Example cmd a
</span><a href="#local-6989586621679325245"><span class="hs-identifier hs-var">k</span></a></span></span><span>  </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span id="local-6989586621679325244"><span class="annot"><span class="annottext">a -&gt; Example cmd b
</span><a href="#local-6989586621679325244"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">cmd Symbolic -&gt; ([Var] -&gt; Example cmd b) -&gt; Example cmd b
forall (cmd :: (* -&gt; *) -&gt; *) a.
cmd Symbolic -&gt; ([Var] -&gt; Example cmd a) -&gt; Example cmd a
</span><a href="Test.Util.QSM.html#Run"><span class="hs-identifier hs-var">Run</span></a></span><span> </span><span class="annot"><span class="annottext">cmd Symbolic
</span><a href="#local-6989586621679325246"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Var] -&gt; Example cmd a
</span><a href="#local-6989586621679325245"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">([Var] -&gt; Example cmd a)
-&gt; (a -&gt; Example cmd b) -&gt; [Var] -&gt; Example cmd b
forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;=&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Example cmd b
</span><a href="#local-6989586621679325244"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span>  </span><span class="annot"><a href="Test.Util.QSM.html#Fail"><span class="hs-identifier hs-type">Fail</span></a></span><span> </span><span id="local-6989586621679325242"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679325242"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Example cmd b
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Example cmd b
forall (cmd :: (* -&gt; *) -&gt; *) a. String -&gt; Example cmd a
</span><a href="Test.Util.QSM.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679325242"><span class="hs-identifier hs-var">err</span></a></span></span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span id="local-6989586621679325241"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Fail.MonadFail</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Util.QSM.html#Example"><span class="hs-identifier hs-type">Example</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679325241"><span class="hs-identifier hs-type">cmd</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-39"></span><span>  </span><span id="local-6989586621679325237"><span class="annot"><span class="annottext">fail :: String -&gt; Example cmd a
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">fail</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Example cmd a
forall (cmd :: (* -&gt; *) -&gt; *) a. String -&gt; Example cmd a
</span><a href="Test.Util.QSM.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span></span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="hs-comment">-- | Run a command, and capture its references</span><span>
</span><span id="line-42"></span><span id="local-6989586621679325235"><span id="local-6989586621679325236"><span class="annot"><a href="Test.Util.QSM.html#run"><span class="hs-identifier hs-type">run</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679325236"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679325235"><span class="hs-identifier hs-type">cmd</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbolic</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Util.QSM.html#Example"><span class="hs-identifier hs-type">Example</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679325235"><span class="hs-identifier hs-type">cmd</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Reference</span></span><span> </span><span class="annot"><a href="#local-6989586621679325236"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbolic</span></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-43"></span><span id="run"><span class="annot"><span class="annottext">run :: cmd Symbolic -&gt; Example cmd [Reference a Symbolic]
</span><a href="Test.Util.QSM.html#run"><span class="hs-identifier hs-var hs-var">run</span></a></span></span><span> </span><span id="local-6989586621679325234"><span class="annot"><span class="annottext">cmd Symbolic
</span><a href="#local-6989586621679325234"><span class="hs-identifier hs-var">cmd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">cmd Symbolic
-&gt; ([Var] -&gt; Example cmd [Reference a Symbolic])
-&gt; Example cmd [Reference a Symbolic]
forall (cmd :: (* -&gt; *) -&gt; *) a.
cmd Symbolic -&gt; ([Var] -&gt; Example cmd a) -&gt; Example cmd a
</span><a href="Test.Util.QSM.html#Run"><span class="hs-identifier hs-var">Run</span></a></span><span> </span><span class="annot"><span class="annottext">cmd Symbolic
</span><a href="#local-6989586621679325234"><span class="hs-identifier hs-var">cmd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Reference a Symbolic] -&gt; Example cmd [Reference a Symbolic]
forall (cmd :: (* -&gt; *) -&gt; *) a. a -&gt; Example cmd a
</span><a href="Test.Util.QSM.html#Done"><span class="hs-identifier hs-var">Done</span></a></span><span> </span><span class="annot"><span class="annottext">([Reference a Symbolic] -&gt; Example cmd [Reference a Symbolic])
-&gt; ([Var] -&gt; [Reference a Symbolic])
-&gt; [Var]
-&gt; Example cmd [Reference a Symbolic]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Var -&gt; Reference a Symbolic) -&gt; [Var] -&gt; [Reference a Symbolic]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Symbolic a -&gt; Reference a Symbolic
forall a (r :: * -&gt; *). r a -&gt; Reference a r
</span><span class="hs-identifier hs-var">Reference</span></span><span> </span><span class="annot"><span class="annottext">(Symbolic a -&gt; Reference a Symbolic)
-&gt; (Var -&gt; Symbolic a) -&gt; Var -&gt; Reference a Symbolic
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Symbolic a
forall a. Typeable a =&gt; Var -&gt; Symbolic a
</span><span class="hs-identifier hs-var">Symbolic</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span class="hs-comment">-- | Run a command, ignoring its references</span><span>
</span><span id="line-46"></span><span id="local-6989586621679325230"><span class="annot"><a href="Test.Util.QSM.html#run%27"><span class="hs-identifier hs-type">run'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679325230"><span class="hs-identifier hs-type">cmd</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbolic</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Util.QSM.html#Example"><span class="hs-identifier hs-type">Example</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679325230"><span class="hs-identifier hs-type">cmd</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-47"></span><span id="run%27"><span class="annot"><span class="annottext">run' :: cmd Symbolic -&gt; Example cmd ()
</span><a href="Test.Util.QSM.html#run%27"><span class="hs-identifier hs-var hs-var">run'</span></a></span></span><span> </span><span id="local-6989586621679325229"><span class="annot"><span class="annottext">cmd Symbolic
</span><a href="#local-6989586621679325229"><span class="hs-identifier hs-var">cmd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">cmd Symbolic -&gt; ([Var] -&gt; Example cmd ()) -&gt; Example cmd ()
forall (cmd :: (* -&gt; *) -&gt; *) a.
cmd Symbolic -&gt; ([Var] -&gt; Example cmd a) -&gt; Example cmd a
</span><a href="Test.Util.QSM.html#Run"><span class="hs-identifier hs-var">Run</span></a></span><span> </span><span class="annot"><span class="annottext">cmd Symbolic
</span><a href="#local-6989586621679325229"><span class="hs-identifier hs-var">cmd</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679325228"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621679325228"><span class="hs-identifier hs-var">_vars</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; Example cmd ()
forall (cmd :: (* -&gt; *) -&gt; *) a. a -&gt; Example cmd a
</span><a href="Test.Util.QSM.html#Done"><span class="hs-identifier hs-var">Done</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="annot"><a href="Test.Util.QSM.html#example"><span class="hs-identifier hs-type">example</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679325227"><span class="annot"><a href="#local-6989586621679325227"><span class="hs-identifier hs-type">model</span></a></span></span><span> </span><span id="local-6989586621679325226"><span class="annot"><a href="#local-6989586621679325226"><span class="hs-identifier hs-type">cmd</span></a></span></span><span> </span><span id="local-6989586621679325225"><span class="annot"><a href="#local-6989586621679325225"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679325224"><span class="annot"><a href="#local-6989586621679325224"><span class="hs-identifier hs-type">resp</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Rank2.Foldable</span></span><span> </span><span class="annot"><a href="#local-6989586621679325224"><span class="hs-identifier hs-type">resp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679325226"><span class="hs-identifier hs-type">cmd</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbolic</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span>        </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StateMachine</span></span><span> </span><span class="annot"><a href="#local-6989586621679325227"><span class="hs-identifier hs-type">model</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679325226"><span class="hs-identifier hs-type">cmd</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679325225"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679325224"><span class="hs-identifier hs-type">resp</span></a></span><span>
</span><span id="line-51"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Util.QSM.html#Example"><span class="hs-identifier hs-type">Example</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679325226"><span class="hs-identifier hs-type">cmd</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Commands</span></span><span> </span><span class="annot"><a href="#local-6989586621679325226"><span class="hs-identifier hs-type">cmd</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679325224"><span class="hs-identifier hs-type">resp</span></a></span><span>
</span><span id="line-53"></span><span id="example"><span class="annot"><span class="annottext">example :: StateMachine model cmd m resp
-&gt; Example cmd () -&gt; Commands cmd resp
</span><a href="Test.Util.QSM.html#example"><span class="hs-identifier hs-var hs-var">example</span></a></span></span><span> </span><span id="local-6989586621679325223"><span class="annot"><span class="annottext">StateMachine model cmd m resp
</span><a href="#local-6989586621679325223"><span class="hs-identifier hs-var">sm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-54"></span><span>    </span><span class="annot"><span class="annottext">[Command cmd resp] -&gt; Commands cmd resp
forall (cmd :: (* -&gt; *) -&gt; *) (resp :: (* -&gt; *) -&gt; *).
[Command cmd resp] -&gt; Commands cmd resp
</span><span class="hs-identifier hs-var">Commands</span></span><span> </span><span class="annot"><span class="annottext">([Command cmd resp] -&gt; Commands cmd resp)
-&gt; (Example cmd () -&gt; [Command cmd resp])
-&gt; Example cmd ()
-&gt; Commands cmd resp
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">([Command cmd resp], Counter) -&gt; [Command cmd resp]
forall a b. (a, b) -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">(([Command cmd resp], Counter) -&gt; [Command cmd resp])
-&gt; (Example cmd () -&gt; ([Command cmd resp], Counter))
-&gt; Example cmd ()
-&gt; [Command cmd resp]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(GenSym [Command cmd resp]
 -&gt; Counter -&gt; ([Command cmd resp], Counter))
-&gt; Counter
-&gt; GenSym [Command cmd resp]
-&gt; ([Command cmd resp], Counter)
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">GenSym [Command cmd resp]
-&gt; Counter -&gt; ([Command cmd resp], Counter)
forall a. GenSym a -&gt; Counter -&gt; (a, Counter)
</span><span class="hs-identifier hs-var">runGenSym</span></span><span> </span><span class="annot"><span class="annottext">Counter
</span><span class="hs-identifier hs-var">newCounter</span></span><span> </span><span class="annot"><span class="annottext">(GenSym [Command cmd resp] -&gt; ([Command cmd resp], Counter))
-&gt; (Example cmd () -&gt; GenSym [Command cmd resp])
-&gt; Example cmd ()
-&gt; ([Command cmd resp], Counter)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">model Symbolic -&gt; Example cmd () -&gt; GenSym [Command cmd resp]
</span><a href="#local-6989586621679325218"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateMachine model cmd m resp -&gt; forall (r :: * -&gt; *). model r
forall (model :: (* -&gt; *) -&gt; *) (cmd :: (* -&gt; *) -&gt; *)
       (m :: * -&gt; *) (resp :: (* -&gt; *) -&gt; *).
StateMachine model cmd m resp -&gt; forall (r :: * -&gt; *). model r
</span><span class="hs-identifier hs-var hs-var">initModel</span></span><span> </span><span class="annot"><span class="annottext">StateMachine model cmd m resp
</span><a href="#local-6989586621679325223"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-56"></span><span>    </span><span class="annot"><a href="#local-6989586621679325218"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679325227"><span class="hs-identifier hs-type">model</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbolic</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Util.QSM.html#Example"><span class="hs-identifier hs-type">Example</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679325226"><span class="hs-identifier hs-type">cmd</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GenSym</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Command</span></span><span> </span><span class="annot"><a href="#local-6989586621679325226"><span class="hs-identifier hs-type">cmd</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679325224"><span class="hs-identifier hs-type">resp</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-57"></span><span>    </span><span id="local-6989586621679325218"><span class="annot"><span class="annottext">go :: model Symbolic -&gt; Example cmd () -&gt; GenSym [Command cmd resp]
</span><a href="#local-6989586621679325218"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><span class="annottext">model Symbolic
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Util.QSM.html#Done"><span class="hs-identifier hs-type">Done</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Command cmd resp] -&gt; GenSym [Command cmd resp]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-58"></span><span>    </span><span class="annot"><a href="#local-6989586621679325218"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">model Symbolic
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Util.QSM.html#Fail"><span class="hs-identifier hs-type">Fail</span></a></span><span> </span><span id="local-6989586621679325216"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679325216"><span class="hs-identifier hs-var">err</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; GenSym [Command cmd resp]
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; GenSym [Command cmd resp])
-&gt; String -&gt; GenSym [Command cmd resp]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;example: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679325216"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-59"></span><span>    </span><span class="annot"><a href="#local-6989586621679325218"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679325214"><span class="annot"><span class="annottext">model Symbolic
</span><a href="#local-6989586621679325214"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Util.QSM.html#Run"><span class="hs-identifier hs-type">Run</span></a></span><span> </span><span id="local-6989586621679325213"><span class="annot"><span class="annottext">cmd Symbolic
</span><a href="#local-6989586621679325213"><span class="hs-identifier hs-var">cmd</span></a></span></span><span> </span><span id="local-6989586621679325212"><span class="annot"><span class="annottext">[Var] -&gt; Example cmd ()
</span><a href="#local-6989586621679325212"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-60"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Logic -&gt; Value
</span><span class="hs-identifier hs-var">Logic.logic</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateMachine model cmd m resp
-&gt; model Symbolic -&gt; cmd Symbolic -&gt; Logic
forall (model :: (* -&gt; *) -&gt; *) (cmd :: (* -&gt; *) -&gt; *)
       (m :: * -&gt; *) (resp :: (* -&gt; *) -&gt; *).
StateMachine model cmd m resp
-&gt; model Symbolic -&gt; cmd Symbolic -&gt; Logic
</span><span class="hs-identifier hs-var hs-var">precondition</span></span><span> </span><span class="annot"><span class="annottext">StateMachine model cmd m resp
</span><a href="#local-6989586621679325223"><span class="hs-identifier hs-var">sm</span></a></span><span> </span><span class="annot"><span class="annottext">model Symbolic
</span><a href="#local-6989586621679325214"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">cmd Symbolic
</span><a href="#local-6989586621679325213"><span class="hs-identifier hs-var">cmd</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-61"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Logic.VFalse</span></span><span> </span><span id="local-6989586621679325208"><span class="annot"><span class="annottext">Counterexample
</span><a href="#local-6989586621679325208"><span class="hs-identifier hs-var">counterexample</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-62"></span><span>            </span><span class="annot"><span class="annottext">String -&gt; GenSym [Command cmd resp]
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; GenSym [Command cmd resp])
-&gt; String -&gt; GenSym [Command cmd resp]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Invalid command &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">cmd Symbolic -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">cmd Symbolic
</span><a href="#local-6989586621679325213"><span class="hs-identifier hs-var">cmd</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Counterexample -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Counterexample
</span><a href="#local-6989586621679325208"><span class="hs-identifier hs-var">counterexample</span></a></span><span>
</span><span id="line-63"></span><span>          </span><span class="annot"><span class="annottext">Value
</span><span class="hs-identifier hs-var">Logic.VTrue</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-64"></span><span>            </span><span id="local-6989586621679325205"><span class="annot"><span class="annottext">resp Symbolic
</span><a href="#local-6989586621679325205"><span class="hs-identifier hs-var">resp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateMachine model cmd m resp
-&gt; model Symbolic -&gt; cmd Symbolic -&gt; GenSym (resp Symbolic)
forall (model :: (* -&gt; *) -&gt; *) (cmd :: (* -&gt; *) -&gt; *)
       (m :: * -&gt; *) (resp :: (* -&gt; *) -&gt; *).
StateMachine model cmd m resp
-&gt; model Symbolic -&gt; cmd Symbolic -&gt; GenSym (resp Symbolic)
</span><span class="hs-identifier hs-var hs-var">mock</span></span><span> </span><span class="annot"><span class="annottext">StateMachine model cmd m resp
</span><a href="#local-6989586621679325223"><span class="hs-identifier hs-var">sm</span></a></span><span> </span><span class="annot"><span class="annottext">model Symbolic
</span><a href="#local-6989586621679325214"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">cmd Symbolic
</span><a href="#local-6989586621679325213"><span class="hs-identifier hs-var">cmd</span></a></span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621679325203"><span class="hs-identifier hs-type">m'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679325227"><span class="hs-identifier hs-type">model</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbolic</span></span><span>
</span><span id="line-67"></span><span>                </span><span id="local-6989586621679325203"><span class="annot"><span class="annottext">m' :: model Symbolic
</span><a href="#local-6989586621679325203"><span class="hs-identifier hs-var hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateMachine model cmd m resp
-&gt; model Symbolic
-&gt; cmd Symbolic
-&gt; resp Symbolic
-&gt; model Symbolic
forall (model :: (* -&gt; *) -&gt; *) (cmd :: (* -&gt; *) -&gt; *)
       (m :: * -&gt; *) (resp :: (* -&gt; *) -&gt; *).
StateMachine model cmd m resp
-&gt; forall (r :: * -&gt; *).
   (Show1 r, Ord1 r) =&gt;
   model r -&gt; cmd r -&gt; resp r -&gt; model r
</span><span class="hs-identifier hs-var hs-var">transition</span></span><span> </span><span class="annot"><span class="annottext">StateMachine model cmd m resp
</span><a href="#local-6989586621679325223"><span class="hs-identifier hs-var">sm</span></a></span><span> </span><span class="annot"><span class="annottext">model Symbolic
</span><a href="#local-6989586621679325214"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">cmd Symbolic
</span><a href="#local-6989586621679325213"><span class="hs-identifier hs-var">cmd</span></a></span><span> </span><span class="annot"><span class="annottext">resp Symbolic
</span><a href="#local-6989586621679325205"><span class="hs-identifier hs-var">resp</span></a></span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span>                </span><span class="annot"><a href="#local-6989586621679325201"><span class="hs-identifier hs-type">vars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Var</span></span><span class="hs-special">]</span><span>
</span><span id="line-70"></span><span>                </span><span id="local-6989586621679325201"><span class="annot"><span class="annottext">vars :: [Var]
</span><a href="#local-6989586621679325201"><span class="hs-identifier hs-var hs-var">vars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">resp Symbolic -&gt; [Var]
forall (f :: (* -&gt; *) -&gt; *). Foldable f =&gt; f Symbolic -&gt; [Var]
</span><span class="hs-identifier hs-var">getUsedVars</span></span><span> </span><span class="annot"><span class="annottext">resp Symbolic
</span><a href="#local-6989586621679325205"><span class="hs-identifier hs-var">resp</span></a></span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span>                </span><span class="annot"><a href="#local-6989586621679325199"><span class="hs-identifier hs-type">cmd'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Command</span></span><span> </span><span class="annot"><a href="#local-6989586621679325226"><span class="hs-identifier hs-type">cmd</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679325224"><span class="hs-identifier hs-type">resp</span></a></span><span>
</span><span id="line-73"></span><span>                </span><span id="local-6989586621679325199"><span class="annot"><span class="annottext">cmd' :: Command cmd resp
</span><a href="#local-6989586621679325199"><span class="hs-identifier hs-var hs-var">cmd'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">cmd Symbolic -&gt; resp Symbolic -&gt; [Var] -&gt; Command cmd resp
forall (cmd :: (* -&gt; *) -&gt; *) (resp :: (* -&gt; *) -&gt; *).
cmd Symbolic -&gt; resp Symbolic -&gt; [Var] -&gt; Command cmd resp
</span><span class="hs-identifier hs-var">Command</span></span><span> </span><span class="annot"><span class="annottext">cmd Symbolic
</span><a href="#local-6989586621679325213"><span class="hs-identifier hs-var">cmd</span></a></span><span> </span><span class="annot"><span class="annottext">resp Symbolic
</span><a href="#local-6989586621679325205"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621679325201"><span class="hs-identifier hs-var">vars</span></a></span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Command cmd resp
</span><a href="#local-6989586621679325199"><span class="hs-identifier hs-var">cmd'</span></a></span><span> </span><span class="annot"><span class="annottext">Command cmd resp -&gt; [Command cmd resp] -&gt; [Command cmd resp]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-var">:</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Command cmd resp] -&gt; [Command cmd resp])
-&gt; GenSym [Command cmd resp] -&gt; GenSym [Command cmd resp]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">model Symbolic -&gt; Example cmd () -&gt; GenSym [Command cmd resp]
</span><a href="#local-6989586621679325218"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">model Symbolic
</span><a href="#local-6989586621679325203"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Var] -&gt; Example cmd ()
</span><a href="#local-6989586621679325212"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621679325201"><span class="hs-identifier hs-var">vars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-76"></span></pre></body></html>