<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Ouroboros.Network.Protocol.TxSubmission2.Server</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">ouroboros-network-protocols-0.3.0.0: Ouroboros Network Protocols</span><ul class="links" id="page-menu"><li><a href="src/Ouroboros.Network.Protocol.TxSubmission2.Server.html">Source</a></li><li><a href="&quot;../index.html&quot;">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Ouroboros.Network.Protocol.TxSubmission2.Server</p></div><div id="table-of-contents"><div id="contents-list"><p class="caption" onclick="window.scrollTo(0,0)">Contents</p><ul><li><a href="#g:1">Protocol type for the server</a></li><li><a href="#g:2">Execution as a typed protocol</a></li></ul></div></div><div id="description"><p class="caption">Description</p><div class="doc"><p>A view of the transaction submission protocol from the point of view of
 the server.</p><p>This provides a view that uses less complex types and should be easier to
 use than the underlying typed protocol itself.</p><p>For execution, a conversion into the typed protocol is provided.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><span class="keyword">data</span> <a href="#t:TxSubmissionServerPipelined">TxSubmissionServerPipelined</a> txid tx m a <span class="keyword">where</span><ul class="subs"><li><a href="#v:TxSubmissionServerPipelined">TxSubmissionServerPipelined</a> &#8759; m (<a href="Ouroboros-Network-Protocol-TxSubmission2-Server.html#t:ServerStIdle" title="Ouroboros.Network.Protocol.TxSubmission2.Server">ServerStIdle</a> Z txid tx m a) &#8594; <a href="Ouroboros-Network-Protocol-TxSubmission2-Server.html#t:TxSubmissionServerPipelined" title="Ouroboros.Network.Protocol.TxSubmission2.Server">TxSubmissionServerPipelined</a> txid tx m a</li></ul></li><li class="src short"><span class="keyword">data</span> <a href="#t:ServerStIdle">ServerStIdle</a> (n &#8759; N) txid tx m a <span class="keyword">where</span><ul class="subs"><li><a href="#v:SendMsgRequestTxIdsBlocking">SendMsgRequestTxIdsBlocking</a> &#8759; <a href="file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/Data-Word.html#t:Word16" title="Data.Word">Word16</a> &#8594; <a href="file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/Data-Word.html#t:Word16" title="Data.Word">Word16</a> &#8594; m a &#8594; (<a href="file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/Data-List-NonEmpty.html#t:NonEmpty" title="Data.List.NonEmpty">NonEmpty</a> (txid, <a href="Ouroboros-Network-Protocol-TxSubmission2-Server.html#t:TxSizeInBytes" title="Ouroboros.Network.Protocol.TxSubmission2.Server">TxSizeInBytes</a>) &#8594; m (<a href="Ouroboros-Network-Protocol-TxSubmission2-Server.html#t:ServerStIdle" title="Ouroboros.Network.Protocol.TxSubmission2.Server">ServerStIdle</a> Z txid tx m a)) &#8594; <a href="Ouroboros-Network-Protocol-TxSubmission2-Server.html#t:ServerStIdle" title="Ouroboros.Network.Protocol.TxSubmission2.Server">ServerStIdle</a> Z txid tx m a</li><li><a href="#v:SendMsgRequestTxIdsPipelined">SendMsgRequestTxIdsPipelined</a> &#8759; <a href="file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/Data-Word.html#t:Word16" title="Data.Word">Word16</a> &#8594; <a href="file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/Data-Word.html#t:Word16" title="Data.Word">Word16</a> &#8594; m (<a href="Ouroboros-Network-Protocol-TxSubmission2-Server.html#t:ServerStIdle" title="Ouroboros.Network.Protocol.TxSubmission2.Server">ServerStIdle</a> (S n) txid tx m a) &#8594; <a href="Ouroboros-Network-Protocol-TxSubmission2-Server.html#t:ServerStIdle" title="Ouroboros.Network.Protocol.TxSubmission2.Server">ServerStIdle</a> n txid tx m a</li><li><a href="#v:SendMsgRequestTxsPipelined">SendMsgRequestTxsPipelined</a> &#8759; [txid] &#8594; m (<a href="Ouroboros-Network-Protocol-TxSubmission2-Server.html#t:ServerStIdle" title="Ouroboros.Network.Protocol.TxSubmission2.Server">ServerStIdle</a> (S n) txid tx m a) &#8594; <a href="Ouroboros-Network-Protocol-TxSubmission2-Server.html#t:ServerStIdle" title="Ouroboros.Network.Protocol.TxSubmission2.Server">ServerStIdle</a> n txid tx m a</li><li><a href="#v:CollectPipelined">CollectPipelined</a> &#8759; <a href="file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> (<a href="Ouroboros-Network-Protocol-TxSubmission2-Server.html#t:ServerStIdle" title="Ouroboros.Network.Protocol.TxSubmission2.Server">ServerStIdle</a> (S n) txid tx m a) &#8594; (<a href="Ouroboros-Network-Protocol-TxSubmission2-Server.html#t:Collect" title="Ouroboros.Network.Protocol.TxSubmission2.Server">Collect</a> txid tx &#8594; m (<a href="Ouroboros-Network-Protocol-TxSubmission2-Server.html#t:ServerStIdle" title="Ouroboros.Network.Protocol.TxSubmission2.Server">ServerStIdle</a> n txid tx m a)) &#8594; <a href="Ouroboros-Network-Protocol-TxSubmission2-Server.html#t:ServerStIdle" title="Ouroboros.Network.Protocol.TxSubmission2.Server">ServerStIdle</a> (S n) txid tx m a</li></ul></li><li class="src short"><span class="keyword">data</span> <a href="#t:Collect">Collect</a> txid tx<ul class="subs"><li>= <a href="#v:CollectTxIds">CollectTxIds</a> <a href="file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/Data-Word.html#t:Word16" title="Data.Word">Word16</a> [(txid, <a href="Ouroboros-Network-Protocol-TxSubmission2-Server.html#t:TxSizeInBytes" title="Ouroboros.Network.Protocol.TxSubmission2.Server">TxSizeInBytes</a>)]</li><li>| <a href="#v:CollectTxs">CollectTxs</a> [txid] [tx]</li></ul></li><li class="src short"><span class="keyword">type</span> <a href="#t:TxSizeInBytes">TxSizeInBytes</a> = <a href="file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/Data-Word.html#t:Word32" title="Data.Word">Word32</a></li><li class="src short"><a href="#v:txSubmissionServerPeerPipelined">txSubmissionServerPeerPipelined</a> &#8759; &#8704; txid tx m a. <a href="file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/Data-Functor.html#t:Functor" title="Data.Functor">Functor</a> m &#8658; <a href="Ouroboros-Network-Protocol-TxSubmission2-Server.html#t:TxSubmissionServerPipelined" title="Ouroboros.Network.Protocol.TxSubmission2.Server">TxSubmissionServerPipelined</a> txid tx m a &#8594; PeerPipelined (<a href="Ouroboros-Network-Protocol-TxSubmission2-Type.html#t:TxSubmission2" title="Ouroboros.Network.Protocol.TxSubmission2.Type">TxSubmission2</a> txid tx) AsServer <a href="Ouroboros-Network-Protocol-TxSubmission2-Type.html#v:StInit" title="Ouroboros.Network.Protocol.TxSubmission2.Type">StInit</a> m a</li></ul></details></div><div id="interface"><a href="#g:1" id="g:1"><h1>Protocol type for the server</h1></a><div class="doc"><p>The protocol states from the point of view of the server.</p></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:TxSubmissionServerPipelined" class="def">TxSubmissionServerPipelined</a> txid tx m a <span class="keyword">where</span> <a href="src/Ouroboros.Network.Protocol.TxSubmission2.Server.html#TxSubmissionServerPipelined" class="link">Source</a> <a href="#t:TxSubmissionServerPipelined" class="selflink">#</a></p><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:TxSubmissionServerPipelined" class="def">TxSubmissionServerPipelined</a> &#8759; m (<a href="Ouroboros-Network-Protocol-TxSubmission2-Server.html#t:ServerStIdle" title="Ouroboros.Network.Protocol.TxSubmission2.Server">ServerStIdle</a> Z txid tx m a) &#8594; <a href="Ouroboros-Network-Protocol-TxSubmission2-Server.html#t:TxSubmissionServerPipelined" title="Ouroboros.Network.Protocol.TxSubmission2.Server">TxSubmissionServerPipelined</a> txid tx m a</td><td class="doc empty">&nbsp;</td></tr></table></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:ServerStIdle" class="def">ServerStIdle</a> (n &#8759; N) txid tx m a <span class="keyword">where</span> <a href="src/Ouroboros.Network.Protocol.TxSubmission2.Server.html#ServerStIdle" class="link">Source</a> <a href="#t:ServerStIdle" class="selflink">#</a></p><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:SendMsgRequestTxIdsBlocking" class="def">SendMsgRequestTxIdsBlocking</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src">&#8759; <a href="file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/Data-Word.html#t:Word16" title="Data.Word">Word16</a></dfn><div class="doc"><p>number of txids to acknowledge</p></div></li><li><dfn class="src">&#8594; <a href="file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/Data-Word.html#t:Word16" title="Data.Word">Word16</a></dfn><div class="doc"><p>number of txids to request</p></div></li><li><dfn class="src">&#8594; m a</dfn><div class="doc"><p>Result if done</p></div></li><li><dfn class="src">&#8594; (<a href="file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/Data-List-NonEmpty.html#t:NonEmpty" title="Data.List.NonEmpty">NonEmpty</a> (txid, <a href="Ouroboros-Network-Protocol-TxSubmission2-Server.html#t:TxSizeInBytes" title="Ouroboros.Network.Protocol.TxSubmission2.Server">TxSizeInBytes</a>) &#8594; m (<a href="Ouroboros-Network-Protocol-TxSubmission2-Server.html#t:ServerStIdle" title="Ouroboros.Network.Protocol.TxSubmission2.Server">ServerStIdle</a> Z txid tx m a))</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src">&#8594; <a href="Ouroboros-Network-Protocol-TxSubmission2-Server.html#t:ServerStIdle" title="Ouroboros.Network.Protocol.TxSubmission2.Server">ServerStIdle</a> Z txid tx m a</dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr><tr><td class="src"><a id="v:SendMsgRequestTxIdsPipelined" class="def">SendMsgRequestTxIdsPipelined</a> &#8759; <a href="file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/Data-Word.html#t:Word16" title="Data.Word">Word16</a> &#8594; <a href="file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/Data-Word.html#t:Word16" title="Data.Word">Word16</a> &#8594; m (<a href="Ouroboros-Network-Protocol-TxSubmission2-Server.html#t:ServerStIdle" title="Ouroboros.Network.Protocol.TxSubmission2.Server">ServerStIdle</a> (S n) txid tx m a) &#8594; <a href="Ouroboros-Network-Protocol-TxSubmission2-Server.html#t:ServerStIdle" title="Ouroboros.Network.Protocol.TxSubmission2.Server">ServerStIdle</a> n txid tx m a</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:SendMsgRequestTxsPipelined" class="def">SendMsgRequestTxsPipelined</a> &#8759; [txid] &#8594; m (<a href="Ouroboros-Network-Protocol-TxSubmission2-Server.html#t:ServerStIdle" title="Ouroboros.Network.Protocol.TxSubmission2.Server">ServerStIdle</a> (S n) txid tx m a) &#8594; <a href="Ouroboros-Network-Protocol-TxSubmission2-Server.html#t:ServerStIdle" title="Ouroboros.Network.Protocol.TxSubmission2.Server">ServerStIdle</a> n txid tx m a</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:CollectPipelined" class="def">CollectPipelined</a> &#8759; <a href="file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> (<a href="Ouroboros-Network-Protocol-TxSubmission2-Server.html#t:ServerStIdle" title="Ouroboros.Network.Protocol.TxSubmission2.Server">ServerStIdle</a> (S n) txid tx m a) &#8594; (<a href="Ouroboros-Network-Protocol-TxSubmission2-Server.html#t:Collect" title="Ouroboros.Network.Protocol.TxSubmission2.Server">Collect</a> txid tx &#8594; m (<a href="Ouroboros-Network-Protocol-TxSubmission2-Server.html#t:ServerStIdle" title="Ouroboros.Network.Protocol.TxSubmission2.Server">ServerStIdle</a> n txid tx m a)) &#8594; <a href="Ouroboros-Network-Protocol-TxSubmission2-Server.html#t:ServerStIdle" title="Ouroboros.Network.Protocol.TxSubmission2.Server">ServerStIdle</a> (S n) txid tx m a</td><td class="doc"><p>Collect a pipelined result.</p></td></tr></table></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:Collect" class="def">Collect</a> txid tx <a href="src/Ouroboros.Network.Protocol.TxSubmission2.Server.html#Collect" class="link">Source</a> <a href="#t:Collect" class="selflink">#</a></p><div class="doc"><p>This is the type of the pipelined results, collected by <code><a href="Ouroboros-Network-Protocol-TxSubmission2-Server.html#v:CollectPipelined" title="Ouroboros.Network.Protocol.TxSubmission2.Server">CollectPipelined</a></code>.
 This protocol can pipeline requests for transaction ids and transactions,
 so we use a sum of either for collecting the responses.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:CollectTxIds" class="def">CollectTxIds</a> <a href="file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/Data-Word.html#t:Word16" title="Data.Word">Word16</a> [(txid, <a href="Ouroboros-Network-Protocol-TxSubmission2-Server.html#t:TxSizeInBytes" title="Ouroboros.Network.Protocol.TxSubmission2.Server">TxSizeInBytes</a>)]</td><td class="doc"><p>The result of <code><a href="Ouroboros-Network-Protocol-TxSubmission2-Server.html#v:SendMsgRequestTxIdsPipelined" title="Ouroboros.Network.Protocol.TxSubmission2.Server">SendMsgRequestTxIdsPipelined</a></code>. It also carries
 the number of txids originally requested.</p></td></tr><tr><td class="src"><a id="v:CollectTxs" class="def">CollectTxs</a> [txid] [tx]</td><td class="doc"><p>The result of <code><a href="Ouroboros-Network-Protocol-TxSubmission2-Server.html#v:SendMsgRequestTxsPipelined" title="Ouroboros.Network.Protocol.TxSubmission2.Server">SendMsgRequestTxsPipelined</a></code>. The actual reply only
 contains the transactions sent, but this pairs them up with the
 transactions requested. This is because the peer can determine that
 some transactions are no longer needed.</p></td></tr></table></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:TxSizeInBytes" class="def">TxSizeInBytes</a> = <a href="file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/Data-Word.html#t:Word32" title="Data.Word">Word32</a> <a href="src/Ouroboros.Network.Protocol.TxSubmission2.Type.html#TxSizeInBytes" class="link">Source</a> <a href="#t:TxSizeInBytes" class="selflink">#</a></p><div class="doc"><p>Transactions are typically not big, but in principle in future we could
 have ones over 64k large.</p></div></div><a href="#g:2" id="g:2"><h1>Execution as a typed protocol</h1></a><div class="top"><p class="src"><a id="v:txSubmissionServerPeerPipelined" class="def">txSubmissionServerPeerPipelined</a> &#8759; &#8704; txid tx m a. <a href="file:///usr/local/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/Data-Functor.html#t:Functor" title="Data.Functor">Functor</a> m &#8658; <a href="Ouroboros-Network-Protocol-TxSubmission2-Server.html#t:TxSubmissionServerPipelined" title="Ouroboros.Network.Protocol.TxSubmission2.Server">TxSubmissionServerPipelined</a> txid tx m a &#8594; PeerPipelined (<a href="Ouroboros-Network-Protocol-TxSubmission2-Type.html#t:TxSubmission2" title="Ouroboros.Network.Protocol.TxSubmission2.Type">TxSubmission2</a> txid tx) AsServer <a href="Ouroboros-Network-Protocol-TxSubmission2-Type.html#v:StInit" title="Ouroboros.Network.Protocol.TxSubmission2.Type">StInit</a> m a <a href="src/Ouroboros.Network.Protocol.TxSubmission2.Server.html#txSubmissionServerPeerPipelined" class="link">Source</a> <a href="#v:txSubmissionServerPeerPipelined" class="selflink">#</a></p><div class="doc"><p>Transform a <code><a href="Ouroboros-Network-Protocol-TxSubmission2-Server.html#t:TxSubmissionServerPipelined" title="Ouroboros.Network.Protocol.TxSubmission2.Server">TxSubmissionServerPipelined</a></code> into a <code>PeerPipelined</code>.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.24.2</p></div></body></html>